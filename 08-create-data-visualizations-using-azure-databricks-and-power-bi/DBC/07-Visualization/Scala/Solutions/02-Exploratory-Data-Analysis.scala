{"version":"NotebookV1","origId":1745794912682538,"name":"02-Exploratory-Data-Analysis","language":"scala","commands":[{"version":"CommandV1","origId":974699126453878,"guid":"c4158b1f-7f3a-43c9-a1ad-d6541e157305","subtype":"command","commandType":"auto","position":53.0,"command":"%md\n## Next Steps\n\nStart the next lesson, [Power BI]($./03-Power-BI).","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8f799a8e-784f-421c-ba0c-6ee4188398d9"},{"version":"CommandV1","origId":1745794912682539,"guid":"fc14cbb5-5ce4-403d-927c-c6291fc522ee","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Project: Exploratory Data Analysis\nPerform exploratory data analysis (EDA) to gain insights from a data lake.\n\n## Instructions\n\nIn `dbfs:/mnt/training/crime-data-2016`, there are a number of Parquet files containing 2016 crime data from seven United States cities:\n\n* New York\n* Los Angeles\n* Chicago\n* Philadelphia\n* Dallas\n* Boston\n\n\nThe data is cleaned up a little, but has not been normalized. Each city reports crime data slightly differently, so\nexamine the data for each city to determine how to query it properly.\n\nYour job is to use some of this data to gain insights about certain kinds of crimes.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"baa5e57c-038b-43e7-84f8-4f9d8b727f88"},{"version":"CommandV1","origId":1745794912682540,"guid":"1ff4a2b0-1334-4118-aa45-07d978dc854c","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n### Getting Started\n\nRun the following cell to configure our \"classroom.\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e4c28b74-c6b4-4746-b987-a0c078c251c9"},{"version":"CommandV1","origId":1745794912682541,"guid":"af2c93d7-3973-4cc3-8b05-c01c4fb8889b","subtype":"command","commandType":"auto","position":4.0,"command":"%run ./Includes/Classroom-Setup","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d8404429-d377-401f-99d7-4452ecc536fa"},{"version":"CommandV1","origId":1745794912682542,"guid":"3470e7e4-006d-4778-9165-7329638c22e5","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Step 1\n\nStart by creating DataFrames for Los Angeles, Philadelphia, and Dallas data.\n\nUse `spark.read.parquet` to create named DataFrames for the files you choose. \n\nTo read in the parquet file, use `val crimeDataNewYorkDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-New-York-2016.parquet\")`\n\nUse the following view names:\n\n| City          | DataFrame Name            | Path to DBFS file\n| ------------- | ------------------------- | -----------------\n| Los Angeles   | `crimeDataLosAngelesDF`   | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Los-Angeles-2016.parquet`\n| Philadelphia  | `crimeDataPhiladelphiaDF` | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Philadelphia-2016.parquet`\n| Dallas        | `crimeDataDallasDF`       | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Dallas-2016.parquet`","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"396ae985-731b-45fb-8c2f-593f40a7fd69"},{"version":"CommandV1","origId":1745794912682543,"guid":"a2888113-d825-4292-833c-db52c57ff820","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"720e635c-d822-4659-a661-9c92b3f199dc"},{"version":"CommandV1","origId":1745794912682544,"guid":"1b4c19fb-4647-437c-89d8-c6274d240c76","subtype":"command","commandType":"auto","position":7.0,"command":"// ANSWER\nval crimeDataLosAngelesDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-Los-Angeles-2016.parquet\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8294b54c-1ba3-41d7-bac8-33f51578ceee"},{"version":"CommandV1","origId":1745794912682545,"guid":"5f96a48c-9551-4f49-ab7f-d60088a1657e","subtype":"command","commandType":"auto","position":8.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val rowsLosAngeles  = crimeDataLosAngelesDF.count()\ndbTest(\"DF-L7-crimeDataLA-count\", rowsLosAngeles, 217945)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ca13e9d7-90a1-41bb-a794-d9cec432bdbf"},{"version":"CommandV1","origId":1745794912682546,"guid":"5ccc3a15-9e9d-46b0-9755-58d5e890b010","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"19b1aa63-c90f-4075-8bcc-a6f111c3716e"},{"version":"CommandV1","origId":1745794912682547,"guid":"bdbd58a1-6707-46ce-a546-82db9030c6ee","subtype":"command","commandType":"auto","position":10.0,"command":"// ANSWER\n\nval crimeDataPhiladelphiaDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-Philadelphia-2016.parquet\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"00c3c11a-0256-4288-887a-b0e5ebcf1917"},{"version":"CommandV1","origId":1745794912682548,"guid":"597ababa-7013-442b-9318-be00a2068d98","subtype":"command","commandType":"auto","position":11.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val rowsPhiladelphia  = crimeDataPhiladelphiaDF.count()\ndbTest(\"DF-L7-crimeDataPA-count\", rowsPhiladelphia, 168664)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"90f3af8f-fe38-4041-b1e3-b73e1b8bc01c"},{"version":"CommandV1","origId":1745794912682549,"guid":"42cdb0a3-0780-49da-a134-dbd058a60819","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"466f9402-9d1e-4215-83af-7564a455b207"},{"version":"CommandV1","origId":1745794912682550,"guid":"6e053711-17b8-481c-8e18-dd985f06369e","subtype":"command","commandType":"auto","position":13.0,"command":"// ANSWER\n\nval crimeDataDallasDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-Dallas-2016.parquet\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fd1a7d97-e42d-40bf-b558-2b4abb731f6d"},{"version":"CommandV1","origId":1745794912682551,"guid":"8087c249-d317-49ec-883f-fff12b85889e","subtype":"command","commandType":"auto","position":14.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val rowsDallas  = crimeDataDallasDF.count()\ndbTest(\"DF-L7-crimeDataDAL-count\", 99642, rowsDallas)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4e7de051-d624-43b3-9eb2-6514d64857ac"},{"version":"CommandV1","origId":1745794912682552,"guid":"46fd509f-7032-43ff-a30c-ddfe5d6cbe5d","subtype":"command","commandType":"auto","position":15.0,"command":"%md-sandbox\n## Step 2\n\nFor each table, examine the data to figure out how to extract _robbery_ statistics.\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> Each city uses different values to indicate robbery. Commonly used terminology is \"larceny\", \"burglary\" or \"robbery.\"  These challenges are common in Data Lakes.  Restrict yourself to only robberies.\n\nExplore the data for the three cities until you understand how each city records robbery information. If you don't want to worry about upper- or lower-case, \nremember to use the DataFrame `lower()` method to converts column values to lowercase.\n\nCreate a DataFrame containing only the robbery-related rows, as shown in the table below.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** For each table, focus your efforts on the column listed below.\n\nFocus on the following columns for each table:\n\n| DataFrame Name            | Robbery DataFrame Name  | Column\n| ------------------------- | ----------------------- | -------------------------------\n| `crimeDataLosAngelesDF`   | `robberyLosAngelesDF`   | `crimeCodeDescription`\n| `crimeDataPhiladelphiaDF` | `robberyPhiladelphiaDF` | `ucr_general_description`\n| `crimeDataDallasDF`       | `robberyDallasDF`       | `typeOfIncident`","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d144839d-84e5-4345-9e3a-85ed589c743e"},{"version":"CommandV1","origId":1745794912682553,"guid":"07791225-76c1-4549-8ece-d82323de8812","subtype":"command","commandType":"auto","position":16.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"02b8cb9c-f952-4c08-933d-58d4a97b9c11"},{"version":"CommandV1","origId":1745794912682554,"guid":"544fbf56-b375-4bd2-a70f-f9447a0bfe4b","subtype":"command","commandType":"auto","position":17.0,"command":"// ANSWER\nimport org.apache.spark.sql.functions.lower\nval robberyLosAngelesDF = crimeDataLosAngelesDF.filter(lower($\"crimeCodeDescription\") === \"robbery\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fc3bf32f-5a75-42e7-bfbb-5e95492b3199"},{"version":"CommandV1","origId":1745794912682555,"guid":"a3a0b228-0f75-4eee-9b2d-703f64d335db","subtype":"command","commandType":"auto","position":18.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val totalLosAngeles  = robberyLosAngelesDF.count()\ndbTest(\"DF-L7-robberyDataLA-count\", 9048, totalLosAngeles)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"654adf8e-93e9-4736-b07f-1ba8be03e0d7"},{"version":"CommandV1","origId":1745794912682556,"guid":"7d5d891f-d223-45ef-a6f9-b9da27f413c3","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"57550b08-4067-4ff9-bacc-a7ade0f43399"},{"version":"CommandV1","origId":1745794912682557,"guid":"048f83d3-7249-4afc-a839-668f9dce817c","subtype":"command","commandType":"auto","position":20.0,"command":"// ANSWER\n\nval robberyPhiladelphiaDF = crimeDataPhiladelphiaDF.filter(lower($\"ucr_general_description\") === \"robbery\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2c529fe2-b7f4-4c7d-a4b1-951c7af63279"},{"version":"CommandV1","origId":1745794912682558,"guid":"d20169c8-deab-4ec0-87c7-7c47fad6cfd7","subtype":"command","commandType":"auto","position":21.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val totalPhiladelphia  = robberyPhiladelphiaDF.count()\ndbTest(\"DF-L7-robberyDataPA-count\", 6149, totalPhiladelphia)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"abdf37e5-9e2b-44d8-b2c4-5cdca7228dcc"},{"version":"CommandV1","origId":1745794912682559,"guid":"0a97e024-77cf-4713-acae-115d9865e585","subtype":"command","commandType":"auto","position":22.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"02320962-9ab8-4361-8647-81b4ff7bbf54"},{"version":"CommandV1","origId":1745794912682560,"guid":"7ef13d23-0890-467c-b8d9-9b521eb31456","subtype":"command","commandType":"auto","position":23.0,"command":"// ANSWER\nval robberyDallasDF = crimeDataDallasDF.filter(lower($\"typeOfIncident\").startsWith(\"robbery\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"925111b7-a57c-4f12-9d74-a7c6199b20c5"},{"version":"CommandV1","origId":1745794912682561,"guid":"b7b56b4c-b80f-44d7-845f-a5c653aead4d","subtype":"command","commandType":"auto","position":24.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val totalDallas = robberyDallasDF.count()\ndbTest(\"DF-L7-robberyDataDAL-count\", 6824, totalDallas)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"762674a7-49dc-47c5-864d-e5d4a405b60b"},{"version":"CommandV1","origId":1745794912682562,"guid":"fb3fba97-2fda-4c5c-9034-041aadd9ed6b","subtype":"command","commandType":"auto","position":25.0,"command":"%md-sandbox\n## Step 3\n\nNow that you have DataFrames of only the robberies in each city, create DataFrames for each city summarizing the number of robberies in each month.\n\nYour DataFrames must contain two columns:\n* `month`: The month number (e.g., 1 for January, 2 for February, etc.).\n* `robberies`: The total number of robberies in the month.\n\nUse the following DataFrame names and date columns:\n\n\n| City          | DataFrame Name     | Date Column \n| ------------- | ------------- | -------------\n| Los Angeles   | `robberiesByMonthLosAngelesDF` | `timeOccurred`\n| Philadelphia  | `robberiesByMonthPhiladelphiaDF` | `dispatch_date_time`\n| Dallas        | `robberiesByMonthDallasDF` | `startingDateTime`\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> For each city, figure out which column contains the date of the incident. Then, extract the month from that date.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"781a8de6-7c43-4a48-92fd-29cbdd0aba23"},{"version":"CommandV1","origId":1745794912682563,"guid":"2fd68a0a-1869-444f-b27e-8eee0c2ad62b","subtype":"command","commandType":"auto","position":26.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dfa24e38-0b31-4774-a908-519a7ee6bbd4"},{"version":"CommandV1","origId":1745794912682564,"guid":"58b43a2d-97a6-4182-a92e-e547c6d5d501","subtype":"command","commandType":"auto","position":27.0,"command":"// ANSWER\nimport org.apache.spark.sql.functions.{month,count}\nval robberiesByMonthLosAngelesDF = robberyLosAngelesDF\n  .select(month($\"timeOccurred\") as \"month\")\n  .groupBy($\"month\")  \n  .agg(count(\"*\") as \"robberies\")\n  .orderBy($\"month\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"315b9abb-93d2-4e14-a585-8efa2aa07e6b"},{"version":"CommandV1","origId":1745794912682565,"guid":"3d865fa5-be6e-41e1-adf1-bccb56915d56","subtype":"command","commandType":"auto","position":28.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val la = robberiesByMonthLosAngelesDF.collect().toList\ndbTest(\"DF-L7-robberyByMonthLA-counts\", List(Row(1,719), Row(2,675), Row(3,709), Row(4,713), Row(5,790), Row(6,698), Row(7,826), Row(8,765), Row(9,722), Row(10,814), Row(11,764), Row(12,853)), la)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"14b1c6e0-d96c-40f0-9460-74d1a412c31f"},{"version":"CommandV1","origId":1745794912682566,"guid":"91c715e9-63b2-4af0-a0dd-6796ae11b44a","subtype":"command","commandType":"auto","position":29.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"549c10bb-0490-427b-ab6c-7e3c6a1a45bc"},{"version":"CommandV1","origId":1745794912682567,"guid":"e6f21de1-a948-48ed-bbd4-34103a50ff76","subtype":"command","commandType":"auto","position":30.0,"command":"// ANSWER\nimport org.apache.spark.sql.functions._\n\nval robberiesByMonthPhiladelphiaDF = robberyPhiladelphiaDF\n  .select(month($\"dispatch_date_time\") as \"month\")\n  .groupBy($\"month\")  \n  .agg(count(\"*\") as \"robberies\")\n  .orderBy($\"month\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"64e3889a-3b40-4ed3-ad6f-c6fdc732c8fb"},{"version":"CommandV1","origId":1745794912682568,"guid":"eb1e5597-e7a6-427b-b026-1d8b506c1006","subtype":"command","commandType":"auto","position":31.0,"command":"// TEST - Run this cell to test your solution.\n// convert to list so that we get deep compare (Array would be a shallow compare)\nlazy val philadelphia  = robberiesByMonthPhiladelphiaDF.collect().toList\ndbTest(\"DF-L7-robberyByMonthPA-counts\", List(Row(1,520), Row(2,416), Row(3,432), Row(4,466), Row(5,533), Row(6,509), Row(7,537), Row(8,561), Row(9,514), Row(10,572), Row(11,545), Row(12,544)), philadelphia)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d1c274d9-087e-45de-938d-371532d93ab2"},{"version":"CommandV1","origId":1745794912682569,"guid":"7864e316-9419-4d4b-bd25-3ad474359336","subtype":"command","commandType":"auto","position":32.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dcb25b38-89e7-4494-9888-dc7b69fb64bc"},{"version":"CommandV1","origId":1745794912682570,"guid":"d7391e25-f585-4145-9fc3-40ff94a74a66","subtype":"command","commandType":"auto","position":33.0,"command":"// ANSWER\nimport org.apache.spark.sql.functions._\n\nval robberiesByMonthDallasDF = robberyDallasDF\n  .select(month($\"startingDateTime\") as \"month\")\n  .groupBy($\"month\")  \n  .agg(count(\"*\") as \"robberies\")\n  .orderBy($\"month\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4bdafbb0-48f4-4348-9930-70bcccbc1bdf"},{"version":"CommandV1","origId":1745794912682571,"guid":"d04d2123-1aad-4d22-bea3-2f56ac2ff998","subtype":"command","commandType":"auto","position":34.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val dallas  = robberiesByMonthDallasDF.collect().toList\ndbTest(\"DF-L7-robberyByMonthDAL-counts\", List(Row(1, 743), Row(2, 435), Row(3,412), Row(4,594), Row(5,615), Row(6,495), Row(7,535), Row(8,627), Row(9,512), Row(10,603), Row(11,589), Row(12,664)), dallas)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"808ae622-59fb-46bb-9d4c-79a1b6682722"},{"version":"CommandV1","origId":1745794912682572,"guid":"a0394919-75f4-4bf4-8eb1-e688f2cb2a8d","subtype":"command","commandType":"auto","position":35.0,"command":"%md-sandbox\n\n## Step 4\n\nPlot the robberies per month for each of the three cities, producing a plot similar to the following:\n\n<img src=\"https://files.training.databricks.com/images/eLearning/robberies-by-month.png\" style=\"max-width: 700px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\nWhen you first run the cell, you'll get an HTML table as the result. To configure the plot:\n\n1. Click the graph button.\n2. If the plot doesn't look correct, click the **Plot Options** button.\n3. Configure the plot similar to the following example.\n\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-1.png\" style=\"width: 440px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-2.png\" style=\"width: 268px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-3.png\" style=\"width: 362px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b869ba58-9010-4e12-9325-48feb97a2f5d"},{"version":"CommandV1","origId":1745794912682573,"guid":"30c16c83-5ce0-4c54-b81c-5fa32bd92f54","subtype":"command","commandType":"auto","position":36.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9a201023-25ea-437d-bb9e-cb0be8a240fd"},{"version":"CommandV1","origId":1745794912682574,"guid":"4e3d686f-8604-4951-91fe-6048b53d558a","subtype":"command","commandType":"auto","position":37.0,"command":"// ANSWER\ndisplay(robberiesByMonthLosAngelesDF.orderBy($\"month\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"22eb4f7f-67ee-494d-8a74-fff5d0db5406"},{"version":"CommandV1","origId":1745794912682575,"guid":"910633de-fc24-4f17-8a21-b8a6fb966704","subtype":"command","commandType":"auto","position":38.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1ff4d9cc-bf28-4a91-af03-e6ded08613bc"},{"version":"CommandV1","origId":1745794912682576,"guid":"7f7e99b6-7431-4c8b-a02d-b97517bc7ddd","subtype":"command","commandType":"auto","position":39.0,"command":"// ANSWER\ndisplay(robberiesByMonthPhiladelphiaDF.orderBy($\"month\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bbc6df87-2840-45f1-8e12-402aab469e75"},{"version":"CommandV1","origId":1745794912682577,"guid":"c6f9c3f2-70ab-4c7e-8a40-cbd9570d2658","subtype":"command","commandType":"auto","position":40.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"816e32d7-51ce-4be6-b7c9-ac30cc79f9da"},{"version":"CommandV1","origId":1745794912682578,"guid":"9d86029d-f0c4-4430-98b8-163267ee32dc","subtype":"command","commandType":"auto","position":41.0,"command":"// ANSWER\ndisplay(robberiesByMonthDallasDF.orderBy($\"month\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bf2111ba-67f8-4fd8-a95c-1d60d841905e"},{"version":"CommandV1","origId":1745794912682579,"guid":"31df503a-92f7-4cc8-8519-168bf0c91688","subtype":"command","commandType":"auto","position":42.0,"command":"%md-sandbox\n## Step 5\n\nCreate another DataFrame called `combinedRobberiesByMonthDF`, that combines all three robberies-per-month views into one.\nIn creating this view, add a new column called `city`, that identifies the city associated with each row.\nThe final view will have the following columns:\n\n* `city`: The name of the city associated with the row. (Use the strings \"Los Angeles\", \"Philadelphia\", and \"Dallas\".)\n* `month`: The month number associated with the row.\n* `robbery`: The number of robbery in that month (for that city).\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** You may want to apply the `union()` method in this example to combine the three datasets.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** It's easy to add new columns in DataFrames. For example, add a new column called `newColumn` to `originalDF` use `withColumn()` method as follows:\n\n```originalDF.withColumn(\"newColumn\")``` ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"757bad25-b3f9-4e91-aead-eb33f267574f"},{"version":"CommandV1","origId":1745794912682580,"guid":"8b72bda2-8e8a-4b0f-9228-20a219951f35","subtype":"command","commandType":"auto","position":43.0,"command":"// ANSWER\n\nval combinedRobberiesByMonthDF = robberiesByMonthLosAngelesDF.select(lit(\"Los Angeles\").as(\"city\"), $\"*\")\n  .union(robberiesByMonthPhiladelphiaDF.select(lit(\"Philadelphia\").as(\"city\"), $\"*\"))\n  .union(robberiesByMonthDallasDF.select(lit(\"Dallas\").as(\"city\"), $\"*\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"54be5e5a-9bab-4a83-a97c-f26eb46cd4ed"},{"version":"CommandV1","origId":1745794912682581,"guid":"c74fa1ec-3e1c-4d4a-bfc8-19c95df426fa","subtype":"command","commandType":"auto","position":44.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val results = combinedRobberiesByMonthDF.collect().toSet\n           \ndbTest(\"DF-L7-combinedRobberiesByMonth-counts\", Set(Row(\"Dallas\",11,589), Row(\"Los Angeles\",2,675), Row(\"Dallas\",8,627), Row(\"Los Angeles\",9,722), Row(\"Los Angeles\",1,719), Row(\"Philadelphia\",12,544), Row(\"Dallas\",1,743), Row(\"Dallas\",10,603), Row(\"Dallas\",6,495), Row(\"Los Angeles\",4,713), Row(\"Philadelphia\",2,416), Row(\"Dallas\",4,594), Row(\"Los Angeles\",12,853), Row(\"Dallas\",12,664), Row(\"Dallas\",9,512), Row(\"Los Angeles\",3,709), Row(\"Dallas\",2,435), Row(\"Los Angeles\",7,826), Row(\"Philadelphia\",1,520), Row(\"Los Angeles\",5,790), Row(\"Philadelphia\",7,537), Row(\"Dallas\",5,615), Row(\"Philadelphia\",9,514), Row(\"Los Angeles\",6,698), Row(\"Philadelphia\",8,561), Row(\"Los Angeles\",11,764), Row(\"Philadelphia\",6,509), Row(\"Dallas\",3,412), Row(\"Philadelphia\",5,533), Row(\"Philadelphia\",10,572), Row(\"Los Angeles\",10,814), Row(\"Los Angeles\",8,765), Row(\"Philadelphia\",11,545), Row(\"Dallas\",7,535), Row(\"Philadelphia\",3,432), Row(\"Philadelphia\",4,466)), results)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7fb92833-38cb-4c06-9d06-a94dcb523bae"},{"version":"CommandV1","origId":1745794912682582,"guid":"c19c3413-30e9-41b0-ae7f-9714c5ecb7f8","subtype":"command","commandType":"auto","position":45.0,"command":"combinedRobberiesByMonthDF.select($\"city\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"87997c58-12bf-4171-af8d-59c322a49a82"},{"version":"CommandV1","origId":1745794912682583,"guid":"27e4be46-c33b-4fa3-b32f-570f0331716d","subtype":"command","commandType":"auto","position":46.0,"command":"%md-sandbox\n## Step 6\n\nGraph the contents of `combinedRobberiesByMonthDF`, producing a graph similar to the following. (The diagram below deliberately\nuses different data.)\n\n<img src=\"https://files.training.databricks.com/images/eLearning/combined-homicides.png\" style=\"width: 800px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\nAdjust the plot options to configure the plot properly, as shown below:\n\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-4.png\" style=\"width: 362px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** Order your results by `month`, then `city`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"44785aa9-8f2f-4c96-9947-89f5a11d11f9"},{"version":"CommandV1","origId":1745794912682584,"guid":"ac36bbc0-2379-4d7a-ac2a-eb393358fa22","subtype":"command","commandType":"auto","position":47.0,"command":"// ANSWER\n\ndisplay(combinedRobberiesByMonthDF.orderBy($\"month\", $\"city\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d02c98d4-e7b2-4d8e-b831-a9da9115cfc9"},{"version":"CommandV1","origId":1745794912682585,"guid":"f5663683-d4a7-4140-b77d-4edd6c8df97a","subtype":"command","commandType":"auto","position":48.0,"command":"%md\n## Step 7\n\nWhile the above graph is interesting, it's flawed: it's comparing the raw numbers of robberies, not the per capita robbery rates.\n\nThe DataFrame (already created) called `cityDataDF`  contains, among other data, estimated 2016 population values for all United States cities\nwith populations of at least 100,000. (The data is from [Wikipedia](https://en.wikipedia.org/wiki/List_of_United_States_cities_by_population).)\n\n* Use the population values in that table to normalize the robberies so they represent per-capita values (total robberies divided by population).\n* Save your results in a DataFrame called `robberyRatesByCityDF`.\n* The robbery rate value must be stored in a new column, `robberyRate`.\n\nNext, graph the results, as above.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b39f96ca-1afc-4fec-a667-bcac1e01b110"},{"version":"CommandV1","origId":1745794912682586,"guid":"3fa37d3c-b17b-45d2-a288-3378c98536ea","subtype":"command","commandType":"auto","position":49.0,"command":"// ANSWER\n\n// rename \"city\" column to \"cities\" to avoid having two similarly named cols; also columns are case-blind\nval cityDataDF = spark.read.parquet(\"dbfs:/mnt/training/City-Data.parquet\").withColumnRenamed(\"city\", \"cities\")\n\nval robberyRatesByCityDF = combinedRobberiesByMonthDF\n  .select($\"month\", $\"robberies\", $\"city\")\n  .join(cityDataDF, combinedRobberiesByMonthDF(\"city\") === cityDataDF(\"cities\"))\n  .withColumn(\"robberyRate\", format_number($\"robberies\"/$\"estPopulation2016\",6))\n  .drop($\"robberies\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"091c095e-a73d-4b91-a40e-306449f1f427"},{"version":"CommandV1","origId":1745794912682587,"guid":"b5f816c9-9707-458f-b38e-6416d852c0ab","subtype":"command","commandType":"auto","position":50.0,"command":"// TEST - Run this cell to test your solution.\nlazy val results = robberyRatesByCityDF.select($\"city\", $\"month\", $\"robberyRate\").orderBy($\"city\", $\"month\").collect.toList\nlazy val expectedResults = List(\n  Row(\"Dallas\",  1, \"0.000564\"),\n  Row(\"Dallas\",  2, \"0.000330\"),\n  Row(\"Dallas\",  3, \"0.000313\"),\n  Row(\"Dallas\",  4, \"0.000451\"), \n  Row(\"Dallas\",  5, \"0.000467\"),\n  Row(\"Dallas\",  6, \"0.000376\"),\n  Row(\"Dallas\",  7, \"0.000406\"),\n  Row(\"Dallas\",  8, \"0.000476\"),\n  Row(\"Dallas\",  9, \"0.000388\"),\n  Row(\"Dallas\", 10, \"0.000458\"), \n  Row(\"Dallas\", 11, \"0.000447\"),\n  Row(\"Dallas\", 12, \"0.000504\"), \n  Row(\"Los Angeles\",  1, \"0.000181\"),\n  Row(\"Los Angeles\",  2, \"0.000170\"),\n  Row(\"Los Angeles\",  3, \"0.000178\"), \n  Row(\"Los Angeles\",  4, \"0.000179\"), \n  Row(\"Los Angeles\",  5, \"0.000199\"),\n  Row(\"Los Angeles\",  6, \"0.000176\"),\n  Row(\"Los Angeles\",  7, \"0.000208\"),\n  Row(\"Los Angeles\",  8, \"0.000192\"), \n  Row(\"Los Angeles\",  9, \"0.000182\"), \n  Row(\"Los Angeles\", 10, \"0.000205\"),\n  Row(\"Los Angeles\", 11, \"0.000192\"), \n  Row(\"Los Angeles\", 12, \"0.000215\"),\n  Row(\"Philadelphia\",  1, \"0.000332\"),\n  Row(\"Philadelphia\",  2, \"0.000265\"), \n  Row(\"Philadelphia\",  3, \"0.000276\"),\n  Row(\"Philadelphia\",  4, \"0.000297\"), \n  Row(\"Philadelphia\",  5, \"0.000340\"),\n  Row(\"Philadelphia\",  6, \"0.000325\"),\n  Row(\"Philadelphia\",  7, \"0.000343\"),\n  Row(\"Philadelphia\",  8, \"0.000358\"),\n  Row(\"Philadelphia\",  9, \"0.000328\"),\n  Row(\"Philadelphia\", 10, \"0.000365\"),\n  Row(\"Philadelphia\", 11, \"0.000348\"), \n  Row(\"Philadelphia\", 12, \"0.000347\"))\ndbTest(\"DF-L7-roberryRatesByCity-counts\", expectedResults, results)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7f9ad20c-9d4d-42d8-8d85-8a73e352b98f"},{"version":"CommandV1","origId":1745794912682588,"guid":"76ebbd71-d0e3-4a9d-b7fa-caa6171dd717","subtype":"command","commandType":"auto","position":52.0,"command":"%md\n## References\n\nThe crime data used in this notebook comes from the following locations:\n\n| City          | Original Data \n| ------------- | -------------\n| Boston        | <a href=\"https://data.boston.gov/group/public-safety\" target=\"_blank\">https&#58;//data.boston.gov/group/public-safety</a>\n| Chicago       | <a href=\"https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2\" target=\"_blank\">https&#58;//data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2</a>\n| Dallas        | <a href=\"https://www.dallasopendata.com/Public-Safety/Police-Incidents/tbnj-w5hb/data\" target=\"_blank\">https&#58;//www.dallasopendata.com/Public-Safety/Police-Incidents/tbnj-w5hb/data</a>\n| Los Angeles   | <a href=\"https://data.lacity.org/A-Safe-City/Crime-Data-From-2010-to-Present/y8tr-7khq\" target=\"_blank\">https&#58;//data.lacity.org/A-Safe-City/Crime-Data-From-2010-to-Present/y8tr-7khq</a>\n| New Orleans   | <a href=\"https://data.nola.gov/Public-Safety-and-Preparedness/Electronic-Police-Report-2016/4gc2-25he/data\" target=\"_blank\">https&#58;//data.nola.gov/Public-Safety-and-Preparedness/Electronic-Police-Report-2016/4gc2-25he/data</a>\n| New York      | <a href=\"https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i\" target=\"_blank\">https&#58;//data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i</a>\n| Philadelphia  | <a href=\"https://www.opendataphilly.org/dataset/crime-incidents\" target=\"_blank\">https&#58;//www.opendataphilly.org/dataset/crime-incidents</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e28ed457-6ac1-4299-8221-50486cbbfa9e"}],"dashboards":[],"guid":"ee1a6fda-5187-463f-a2db-e6f022dd6856","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}