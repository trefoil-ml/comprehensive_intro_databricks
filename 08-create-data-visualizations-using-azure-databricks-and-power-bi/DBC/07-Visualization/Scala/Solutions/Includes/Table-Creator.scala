{"version":"NotebookV1","origId":1745794912682479,"name":"Table-Creator","language":"scala","commands":[{"version":"CommandV1","origId":1745794912682480,"guid":"9460f99d-53c6-4c86-92b1-29e1cda510eb","subtype":"command","commandType":"auto","position":1.0,"command":"%python\n# Create Tables\n# This notebook creates tables in Databricks from external files, primarily to make SQL access easier. \n# You can run this notebook yourself, but if you follow the lessons in order, one of the other notebooks will run this notebook for you.\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"98098e5a-f3e8-45ef-a42e-4cd1bdd6a19e"},{"version":"CommandV1","origId":1745794912682481,"guid":"92f0b85c-b14a-4f67-884c-736d57b5ac66","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n\nfrom pathlib2 import Path\n\nfilePeople = \"/mnt/training/dataframes/people-10m.parquet\"\nfileNames = \"dbfs:/mnt/training/ssn/names.parquet\"\nfileBlog = \"dbfs:/mnt/training/databricks-blog.json\"\nfileCity = \"dbfs:/mnt/training/City-Data.parquet\"\nfilePlane = \"dbfs:/mnt/training/asa/planes/plane-data.csv\"\nfileSmall = \"dbfs:/mnt/training/asa/flights/small.csv\"\nfileGeo = \"dbfs:/mnt/training/ip-geocode.parquet\"\nfileBikes = \"dbfs:/mnt/training/bikeSharing/data-001/day.csv\"\n\ndbutils.fs.ls(filePeople)\ndbutils.fs.ls(fileNames)\ndbutils.fs.ls(fileBlog)\ndbutils.fs.ls(fileCity)\ndbutils.fs.ls(filePlane)\ndbutils.fs.ls(fileSmall)\ndbutils.fs.ls(fileGeo)\ndbutils.fs.ls(fileBikes)\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"54546c26-e5d5-49d9-af53-cd7ac6f1662d"},{"version":"CommandV1","origId":1745794912682482,"guid":"65e4e7a3-788a-4372-9dad-a9a2d1a53b65","subtype":"command","commandType":"auto","position":3.0,"command":"%python\n\ndef deleteTables() :\n  try:\n    tables=spark.catalog.listTables(\"Databricks\")\n  except:\n    return\n  for table in tables:\n      spark.sql(\"DROP TABLE {}.{}\".format(\"Databricks\", table.name))\n      \n# deleteTables()\n      \nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7b1f565e-3bf7-44e0-9c7a-0c9d38e5e649"},{"version":"CommandV1","origId":1745794912682483,"guid":"5ba30d94-85e6-4175-8e26-9f5921daa8a1","subtype":"command","commandType":"auto","position":4.0,"command":"%python\n\nspark.sql(\"CREATE DATABASE IF NOT EXISTS Databricks\")\nspark.sql(\"USE Databricks\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5f9a00eb-a2d3-45bf-bc6d-4cde7f16e18e"},{"version":"CommandV1","origId":1745794912682484,"guid":"92dc0e1d-c33f-459b-8681-2d251fad1964","subtype":"command","commandType":"auto","position":5.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS People10M\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(filePeople));\n\nspark.sql(\"uncache TABLE People10M\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1486265d-69c1-4ea9-895c-fdb4858fb162"},{"version":"CommandV1","origId":1745794912682485,"guid":"cb58312c-a1c4-4e56-a9ff-3dd9c3b6a372","subtype":"command","commandType":"auto","position":6.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS SSANames\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileNames))\n\nspark.sql(\"uncache TABLE SSANames\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1e80ee03-499f-41a0-8464-9fb2958cea14"},{"version":"CommandV1","origId":1745794912682486,"guid":"fef52e86-bf1b-40e1-9c4d-7d4fda787bcd","subtype":"command","commandType":"auto","position":7.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS DatabricksBlog\nUSING json\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\"\n)\"\"\".format(fileBlog))\n\nspark.sql(\"uncache TABLE DatabricksBlog\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e790f465-b98e-4fc6-884f-6edf440619f2"},{"version":"CommandV1","origId":1745794912682487,"guid":"b0c245a3-1081-4d48-9dbb-d0b9b83021fc","subtype":"command","commandType":"auto","position":8.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS CityData\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileCity))\n\nspark.sql(\"uncache TABLE CityData\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"88725075-22bc-4e2f-93e3-0b05deac73bd"},{"version":"CommandV1","origId":1745794912682488,"guid":"8105edf5-59ac-4e8a-b1d8-a350802270de","subtype":"command","commandType":"auto","position":9.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlinePlane (`tailnum` STRING, `type` STRING, `manufacturer` STRING, `issue_date` STRING, `model` STRING, `status` STRING, `aircraft_type` STRING, `engine_type` STRING, `year` STRING)\nUSING csv \nOPTIONS (\n  header \"true\",\n  delimiter \",\",\n  inferSchema \"false\",\n  path \"{}\"\n)\"\"\".format(filePlane))\n\nspark.sql(\"uncache TABLE AirlinePlane\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"371378ba-b7a3-44e9-8335-0acd2fa54ed9"},{"version":"CommandV1","origId":1745794912682489,"guid":"4ce6d5a7-4379-41e7-a53f-f9c4cd214339","subtype":"command","commandType":"auto","position":10.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlineFlight (`Year` INT, `Month` INT, `DayofMonth` INT, `DayOfWeek` INT, `DepTime` STRING, `CRSDepTime` INT, `ArrTime` STRING, `CRSArrTime` INT, `UniqueCarrier` STRING, `FlightNum` INT, `TailNum` STRING, `ActualElapsedTime` STRING, `CRSElapsedTime` INT, `AirTime` STRING, `ArrDelay` STRING, `DepDelay` STRING, `Origin` STRING, `Dest` STRING, `Distance` INT, `TaxiIn` INT, `TaxiOut` INT, `Cancelled` INT, `CancellationCode` STRING, `Diverted` INT, `CarrierDelay` STRING, `WeatherDelay` STRING, `NASDelay` STRING, `SecurityDelay` STRING, `LateAircraftDelay` STRING)\nUSING CSV OPTIONS (\n  header=\"true\", \n  delimiter=\",\", \n  inferSchema=\"true\", \n  path=\"{}\")\n\"\"\".format(fileSmall))\n\nspark.sql(\"uncache TABLE AirlineFlight\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cd94f3bb-5742-4a5b-9dbc-addb816c4c69"},{"version":"CommandV1","origId":1745794912682490,"guid":"f39ae219-101b-4456-befd-9b7c034aa80e","subtype":"command","commandType":"auto","position":11.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS IPGeocode (`startingIP` DECIMAL(38,0), `endingIP` DECIMAL(38,0), `countryCode2` STRING, `countryCode3` STRING, `country` STRING, `stateProvince` STRING, `city` STRING, `latitude` DOUBLE, `longitude` DOUBLE)\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\n\"\"\".format(fileGeo))\n\nspark.sql(\"uncache TABLE IPGeocode\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3244257c-be65-4843-8b89-f1651adad9ff"},{"version":"CommandV1","origId":1745794912682491,"guid":"5cd465ad-ba1c-4783-a685-c242e536156f","subtype":"command","commandType":"auto","position":12.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS BikeSharingDay\nUSING csv\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\",\n  header \"true\"\n)\"\"\".format(fileBikes))\n\nspark.sql(\"uncache TABLE BikeSharingDay\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fb38cdee-9b5b-4218-99d8-4519a11b5b40"},{"version":"CommandV1","origId":1745794912682492,"guid":"162e7c3c-a158-4996-8f7c-7198b618c6c0","subtype":"command","commandType":"auto","position":13.0,"command":"%python\n\ndisplayHTML(\"Created Database and Tables...\") # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cc09ca8b-e6c4-438f-acca-367de43510bd"}],"dashboards":[],"guid":"26a6ab68-320c-4766-9f5a-fe1f17510e21","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}