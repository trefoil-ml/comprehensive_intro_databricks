{"version":"NotebookV1","origId":1745794912682206,"name":"Table-Creator","language":"python","commands":[{"version":"CommandV1","origId":1745794912682207,"guid":"f01341ce-703f-456d-94b2-40707f914fac","subtype":"command","commandType":"auto","position":1.0,"command":"%python\n# Create Tables\n# This notebook creates tables in Databricks from external files, primarily to make SQL access easier. \n# You can run this notebook yourself, but if you follow the lessons in order, one of the other notebooks will run this notebook for you.\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d2b7a6c3-3119-40c4-b0c2-2b5c0104047b"},{"version":"CommandV1","origId":1745794912682208,"guid":"00546bdb-a39e-480b-9664-1b15b502844c","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n\nfrom pathlib2 import Path\n\nfilePeople = \"/mnt/training/dataframes/people-10m.parquet\"\nfileNames = \"dbfs:/mnt/training/ssn/names.parquet\"\nfileBlog = \"dbfs:/mnt/training/databricks-blog.json\"\nfileCity = \"dbfs:/mnt/training/City-Data.parquet\"\nfilePlane = \"dbfs:/mnt/training/asa/planes/plane-data.csv\"\nfileSmall = \"dbfs:/mnt/training/asa/flights/small.csv\"\nfileGeo = \"dbfs:/mnt/training/ip-geocode.parquet\"\nfileBikes = \"dbfs:/mnt/training/bikeSharing/data-001/day.csv\"\n\ndbutils.fs.ls(filePeople)\ndbutils.fs.ls(fileNames)\ndbutils.fs.ls(fileBlog)\ndbutils.fs.ls(fileCity)\ndbutils.fs.ls(filePlane)\ndbutils.fs.ls(fileSmall)\ndbutils.fs.ls(fileGeo)\ndbutils.fs.ls(fileBikes)\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d6a531f1-75a4-4dd7-bcb5-051e2c4b2a18"},{"version":"CommandV1","origId":1745794912682209,"guid":"87254d1d-aa28-4052-b6ad-29edb16678c3","subtype":"command","commandType":"auto","position":3.0,"command":"%python\n\ndef deleteTables() :\n  try:\n    tables=spark.catalog.listTables(\"Databricks\")\n  except:\n    return\n  for table in tables:\n      spark.sql(\"DROP TABLE {}.{}\".format(\"Databricks\", table.name))\n      \n# deleteTables()\n      \nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d60ad0ca-3c3d-499f-9eae-1d9989d75e70"},{"version":"CommandV1","origId":1745794912682210,"guid":"6bed92f8-ebbc-49a3-bca0-2b13fb93ef1c","subtype":"command","commandType":"auto","position":4.0,"command":"%python\n\nspark.sql(\"CREATE DATABASE IF NOT EXISTS Databricks\")\nspark.sql(\"USE Databricks\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fdcb15bb-57c2-4aa2-9011-e8db516301df"},{"version":"CommandV1","origId":1745794912682211,"guid":"fee4cb8f-5e25-4d5d-961b-1b62eb3d7520","subtype":"command","commandType":"auto","position":5.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS People10M\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(filePeople));\n\nspark.sql(\"uncache TABLE People10M\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"18911fd2-9f23-4e92-8191-c339466ae3c3"},{"version":"CommandV1","origId":1745794912682212,"guid":"b37ac673-8d5d-439b-b934-6fa969b2827f","subtype":"command","commandType":"auto","position":6.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS SSANames\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileNames))\n\nspark.sql(\"uncache TABLE SSANames\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9a71781c-52a8-4f26-9393-68878856c79e"},{"version":"CommandV1","origId":1745794912682213,"guid":"75f9f7af-d3d3-447f-aec0-fe5b97cde197","subtype":"command","commandType":"auto","position":7.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS DatabricksBlog\nUSING json\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\"\n)\"\"\".format(fileBlog))\n\nspark.sql(\"uncache TABLE DatabricksBlog\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"79eea790-a7c8-4a68-9a74-43e6a72486c8"},{"version":"CommandV1","origId":1745794912682214,"guid":"a25392f2-18b6-4cfe-b010-bb3e575942e0","subtype":"command","commandType":"auto","position":8.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS CityData\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileCity))\n\nspark.sql(\"uncache TABLE CityData\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"84215142-f84d-49ca-b5a7-3a307a94ae97"},{"version":"CommandV1","origId":1745794912682215,"guid":"fa017784-f819-4908-bf19-2042cc02982b","subtype":"command","commandType":"auto","position":9.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlinePlane (`tailnum` STRING, `type` STRING, `manufacturer` STRING, `issue_date` STRING, `model` STRING, `status` STRING, `aircraft_type` STRING, `engine_type` STRING, `year` STRING)\nUSING csv \nOPTIONS (\n  header \"true\",\n  delimiter \",\",\n  inferSchema \"false\",\n  path \"{}\"\n)\"\"\".format(filePlane))\n\nspark.sql(\"uncache TABLE AirlinePlane\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"100a21c5-7a32-4a1d-b095-a8de5553eca7"},{"version":"CommandV1","origId":1745794912682216,"guid":"25384ac2-d268-4f2e-83b3-8c3116634af5","subtype":"command","commandType":"auto","position":10.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlineFlight (`Year` INT, `Month` INT, `DayofMonth` INT, `DayOfWeek` INT, `DepTime` STRING, `CRSDepTime` INT, `ArrTime` STRING, `CRSArrTime` INT, `UniqueCarrier` STRING, `FlightNum` INT, `TailNum` STRING, `ActualElapsedTime` STRING, `CRSElapsedTime` INT, `AirTime` STRING, `ArrDelay` STRING, `DepDelay` STRING, `Origin` STRING, `Dest` STRING, `Distance` INT, `TaxiIn` INT, `TaxiOut` INT, `Cancelled` INT, `CancellationCode` STRING, `Diverted` INT, `CarrierDelay` STRING, `WeatherDelay` STRING, `NASDelay` STRING, `SecurityDelay` STRING, `LateAircraftDelay` STRING)\nUSING CSV OPTIONS (\n  header=\"true\", \n  delimiter=\",\", \n  inferSchema=\"true\", \n  path=\"{}\")\n\"\"\".format(fileSmall))\n\nspark.sql(\"uncache TABLE AirlineFlight\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ce3904ad-1272-41de-8dbd-6d951eb7f64a"},{"version":"CommandV1","origId":1745794912682217,"guid":"7b6faee3-d26c-4d6f-bcf7-d4563cf02c3d","subtype":"command","commandType":"auto","position":11.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS IPGeocode (`startingIP` DECIMAL(38,0), `endingIP` DECIMAL(38,0), `countryCode2` STRING, `countryCode3` STRING, `country` STRING, `stateProvince` STRING, `city` STRING, `latitude` DOUBLE, `longitude` DOUBLE)\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\n\"\"\".format(fileGeo))\n\nspark.sql(\"uncache TABLE IPGeocode\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"31df6042-3104-4bb0-8609-4c56cb0fbae3"},{"version":"CommandV1","origId":1745794912682218,"guid":"510bad96-b66f-4ccd-aad7-9b43d29e32a9","subtype":"command","commandType":"auto","position":12.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS BikeSharingDay\nUSING csv\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\",\n  header \"true\"\n)\"\"\".format(fileBikes))\n\nspark.sql(\"uncache TABLE BikeSharingDay\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"570738a2-7827-4d89-a487-2feb319ed3f1"},{"version":"CommandV1","origId":1745794912682219,"guid":"c1231ede-eaf4-47f4-a8ce-45ce0ad7901a","subtype":"command","commandType":"auto","position":13.0,"command":"%python\n\ndisplayHTML(\"Created Database and Tables...\") # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"22d1f7f0-7bac-437d-8ba6-43230431258a"}],"dashboards":[],"guid":"4c33d893-f9f3-4f21-a3b6-12caa3720d87","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}