{"version":"NotebookV1","origId":1852162959320246,"name":"Table-Creator","language":"python","commands":[{"version":"CommandV1","origId":1852162959320247,"guid":"db9cf93f-570a-4e58-bbd5-0996e0282345","subtype":"command","commandType":"auto","position":1.0,"command":"%python\n# Create Tables\n# This notebook creates tables in Databricks from external files, primarily to make SQL access easier. \n# You can run this notebook yourself, but if you follow the lessons in order, one of the other notebooks will run this notebook for you.\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d2b7a6c3-3119-40c4-b0c2-2b5c0104047b"},{"version":"CommandV1","origId":1852162959320248,"guid":"6900b067-bdc8-41d0-b622-87b3d58c61c3","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n\nfrom pathlib2 import Path\n\nfilePeople = \"/mnt/training/dataframes/people-10m.parquet\"\nfileNames = \"dbfs:/mnt/training/ssn/names.parquet\"\nfileBlog = \"dbfs:/mnt/training/databricks-blog.json\"\nfileCity = \"dbfs:/mnt/training/City-Data.parquet\"\nfilePlane = \"dbfs:/mnt/training/asa/planes/plane-data.csv\"\nfileSmall = \"dbfs:/mnt/training/asa/flights/small.csv\"\nfileGeo = \"dbfs:/mnt/training/ip-geocode.parquet\"\nfileBikes = \"dbfs:/mnt/training/bikeSharing/data-001/day.csv\"\n\ndbutils.fs.ls(filePeople)\ndbutils.fs.ls(fileNames)\ndbutils.fs.ls(fileBlog)\ndbutils.fs.ls(fileCity)\ndbutils.fs.ls(filePlane)\ndbutils.fs.ls(fileSmall)\ndbutils.fs.ls(fileGeo)\ndbutils.fs.ls(fileBikes)\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d6a531f1-75a4-4dd7-bcb5-051e2c4b2a18"},{"version":"CommandV1","origId":1852162959320249,"guid":"c74d776d-adb3-47d1-a796-cd0fb7ef64a1","subtype":"command","commandType":"auto","position":3.0,"command":"%python\n\ndef deleteTables() :\n  try:\n    tables=spark.catalog.listTables(\"Databricks\")\n  except:\n    return\n  for table in tables:\n      spark.sql(\"DROP TABLE {}.{}\".format(\"Databricks\", table.name))\n      \n# deleteTables()\n      \nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d60ad0ca-3c3d-499f-9eae-1d9989d75e70"},{"version":"CommandV1","origId":1852162959320250,"guid":"52e45b8b-915b-4ee2-bbbf-8b4339004112","subtype":"command","commandType":"auto","position":4.0,"command":"%python\n\nspark.sql(\"CREATE DATABASE IF NOT EXISTS Databricks\")\nspark.sql(\"USE Databricks\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fdcb15bb-57c2-4aa2-9011-e8db516301df"},{"version":"CommandV1","origId":1852162959320251,"guid":"ec0488ce-a06a-4b16-9f0e-24362ab953d9","subtype":"command","commandType":"auto","position":5.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS People10M\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(filePeople));\n\nspark.sql(\"uncache TABLE People10M\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"18911fd2-9f23-4e92-8191-c339466ae3c3"},{"version":"CommandV1","origId":1852162959320252,"guid":"9b5be850-6fdd-4291-8ea0-8de2c11084d3","subtype":"command","commandType":"auto","position":6.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS SSANames\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileNames))\n\nspark.sql(\"uncache TABLE SSANames\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9a71781c-52a8-4f26-9393-68878856c79e"},{"version":"CommandV1","origId":1852162959320253,"guid":"32dac096-94be-4e0c-80ee-ccd6d8bafb06","subtype":"command","commandType":"auto","position":7.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS DatabricksBlog\nUSING json\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\"\n)\"\"\".format(fileBlog))\n\nspark.sql(\"uncache TABLE DatabricksBlog\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"79eea790-a7c8-4a68-9a74-43e6a72486c8"},{"version":"CommandV1","origId":1852162959320254,"guid":"2334fd42-3dd1-4fa0-8b04-75ad6cd39531","subtype":"command","commandType":"auto","position":8.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS CityData\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileCity))\n\nspark.sql(\"uncache TABLE CityData\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"84215142-f84d-49ca-b5a7-3a307a94ae97"},{"version":"CommandV1","origId":1852162959320255,"guid":"25134355-80ba-4096-a770-5f2cde201e7a","subtype":"command","commandType":"auto","position":9.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlinePlane (`tailnum` STRING, `type` STRING, `manufacturer` STRING, `issue_date` STRING, `model` STRING, `status` STRING, `aircraft_type` STRING, `engine_type` STRING, `year` STRING)\nUSING csv \nOPTIONS (\n  header \"true\",\n  delimiter \",\",\n  inferSchema \"false\",\n  path \"{}\"\n)\"\"\".format(filePlane))\n\nspark.sql(\"uncache TABLE AirlinePlane\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"100a21c5-7a32-4a1d-b095-a8de5553eca7"},{"version":"CommandV1","origId":1852162959320256,"guid":"35848cee-8572-42a5-bc09-87b903cbdbb7","subtype":"command","commandType":"auto","position":10.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlineFlight (`Year` INT, `Month` INT, `DayofMonth` INT, `DayOfWeek` INT, `DepTime` STRING, `CRSDepTime` INT, `ArrTime` STRING, `CRSArrTime` INT, `UniqueCarrier` STRING, `FlightNum` INT, `TailNum` STRING, `ActualElapsedTime` STRING, `CRSElapsedTime` INT, `AirTime` STRING, `ArrDelay` STRING, `DepDelay` STRING, `Origin` STRING, `Dest` STRING, `Distance` INT, `TaxiIn` INT, `TaxiOut` INT, `Cancelled` INT, `CancellationCode` STRING, `Diverted` INT, `CarrierDelay` STRING, `WeatherDelay` STRING, `NASDelay` STRING, `SecurityDelay` STRING, `LateAircraftDelay` STRING)\nUSING CSV OPTIONS (\n  header=\"true\", \n  delimiter=\",\", \n  inferSchema=\"true\", \n  path=\"{}\")\n\"\"\".format(fileSmall))\n\nspark.sql(\"uncache TABLE AirlineFlight\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ce3904ad-1272-41de-8dbd-6d951eb7f64a"},{"version":"CommandV1","origId":1852162959320257,"guid":"937a668f-1bda-4ad8-90f3-8d31fc87ee0b","subtype":"command","commandType":"auto","position":11.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS IPGeocode (`startingIP` DECIMAL(38,0), `endingIP` DECIMAL(38,0), `countryCode2` STRING, `countryCode3` STRING, `country` STRING, `stateProvince` STRING, `city` STRING, `latitude` DOUBLE, `longitude` DOUBLE)\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\n\"\"\".format(fileGeo))\n\nspark.sql(\"uncache TABLE IPGeocode\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"31df6042-3104-4bb0-8609-4c56cb0fbae3"},{"version":"CommandV1","origId":1852162959320258,"guid":"061deed2-a45c-4cf0-a173-87f897687073","subtype":"command","commandType":"auto","position":12.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS BikeSharingDay\nUSING csv\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\",\n  header \"true\"\n)\"\"\".format(fileBikes))\n\nspark.sql(\"uncache TABLE BikeSharingDay\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"570738a2-7827-4d89-a487-2feb319ed3f1"},{"version":"CommandV1","origId":1852162959320259,"guid":"8a105b2f-49df-47a4-be9c-33203cc35f1a","subtype":"command","commandType":"auto","position":13.0,"command":"%python\n\ndisplayHTML(\"Created Database and Tables...\") # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"22d1f7f0-7bac-437d-8ba6-43230431258a"}],"dashboards":[],"guid":"63b98533-aa9d-4e49-9a14-717377afb7fd","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}