{"version":"NotebookV1","origId":1745794912675231,"name":"05-Querying-JSON","language":"scala","commands":[{"version":"CommandV1","origId":1745794912675232,"guid":"c765b3b7-352e-4685-a7ad-25191121b383","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Querying JSON & Hierarchical Data with DataFrames\n\nApache Spark&trade; and Azure Databricks&reg; make it easy to work with hierarchical data, such as nested JSON records.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bd6e18cc-cbef-4d76-9942-0a19273ecb43"},{"version":"CommandV1","origId":1745794912675233,"guid":"4a22529e-3247-4697-a8d6-6f1ede053c65","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n### Getting Started\n\nRun the following cell to configure our \"classroom.\"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"183836fe-0f3f-4e0b-a49d-164a729b5887"},{"version":"CommandV1","origId":1745794912675234,"guid":"51fa7790-3fb1-4652-a0b9-7aaf8a54c113","subtype":"command","commandType":"auto","position":4.0,"command":"%run \"./Includes/Classroom-Setup\"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c975c94f-1990-4f84-9a8f-850a83fb67f6"},{"version":"CommandV1","origId":1745794912675235,"guid":"946bc4a4-c708-4c74-b1ca-73aef7465393","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n## Examining the Contents of a JSON file\n\nJSON is a common file format used in big data applications and in data lakes (or large stores of diverse data).  File formats such as JSON arise out of a number of data needs.  For instance, what if:\n<br>\n* Your schema, or the structure of your data, changes over time?\n* You need nested fields like an array with many values or an array of arrays?\n* You don't know how you're going use your data yet, so you don't want to spend time creating relational tables?\n\nThe popularity of JSON is largely due to the fact that JSON allows for nested, flexible schemas.\n\nThis lesson uses the `DatabricksBlog` table, which is backed by JSON file `dbfs:/mnt/training/databricks-blog.json`. If you examine the raw file, notice it contains compact JSON data. There's a single JSON object on each line of the file; each object corresponds to a row in the table. Each row represents a blog post on the <a href=\"https://databricks.com/blog\" target=\"_blank\">Databricks blog</a>, and the table contains all blog posts through August 9, 2017.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"03be8244-f1db-41e3-aa8f-c25624fd158a"},{"version":"CommandV1","origId":1745794912675236,"guid":"2490ed95-04af-4297-aa5f-9b7174edccff","subtype":"command","commandType":"auto","position":8.0,"command":"%fs head dbfs:/mnt/training/databricks-blog.json","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e73af0fe-e530-4d8f-a673-d69245c05537"},{"version":"CommandV1","origId":1745794912675237,"guid":"c9a403c4-1580-4165-9c38-a45019fe2db9","subtype":"command","commandType":"auto","position":9.0,"command":"%md\nCreate a DataFrame out of the syntax introduced in the previous lesson:","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f615a763-f89b-400b-9e4a-3b600bac3b60"},{"version":"CommandV1","origId":1745794912675238,"guid":"73cf0a53-e0b7-4096-a0af-a39f423ad73a","subtype":"command","commandType":"auto","position":10.0,"command":"val databricksBlogDF = spark.read.option(\"inferSchema\",\"true\").option(\"header\",\"true\").json(\"/mnt/training/databricks-blog.json\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d39761dd-4f79-4534-b906-71acb1d6410a"},{"version":"CommandV1","origId":1745794912675239,"guid":"6fd122a3-fd36-4dc9-a2e5-1408acd89b00","subtype":"command","commandType":"auto","position":11.0,"command":"%md\nTake a look at the schema by invoking `printSchema` method.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"814e409d-90b7-4de8-bae0-c0c759260cd6"},{"version":"CommandV1","origId":1745794912675240,"guid":"564ea70e-0327-40ad-871b-ded4c9101132","subtype":"command","commandType":"auto","position":12.0,"command":"databricksBlogDF.printSchema","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4695add9-a828-49e2-aa04-3759c08c5128"},{"version":"CommandV1","origId":1745794912675241,"guid":"8981f721-3862-43a1-9ad1-acd975a40629","subtype":"command","commandType":"auto","position":13.0,"command":"%md\nRun a query to view the contents of the table.\n\nNotice:\n* The `authors` column is an array containing one or more author names.\n* The `categories` column is an array of one or more blog post category names.\n* The `dates` column contains nested fields `createdOn`, `publishedOn` and `tz`.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b4ec700b-4521-49a5-9fd8-e6c25d5337b9"},{"version":"CommandV1","origId":1745794912675242,"guid":"8c217156-c7fd-400c-b2cb-ee5cb02f8b0e","subtype":"command","commandType":"auto","position":14.0,"command":"display(databricksBlogDF.select($\"authors\",$\"categories\",$\"dates\",$\"content\"))","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b07c5b59-fc0e-4e2a-bfd8-78023dce2696"},{"version":"CommandV1","origId":1745794912675243,"guid":"a8eda855-3250-41ad-8192-edbc9a817914","subtype":"command","commandType":"auto","position":15.0,"command":"%md\n## Nested Data\n\nThink of nested data as columns within columns. \n\nFor instance, look at the `dates` column.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ce1d7897-d9ac-4fa8-acbe-5ad19753a706"},{"version":"CommandV1","origId":1745794912675244,"guid":"f317d0ff-66d5-4c4d-a563-791d20c6a25e","subtype":"command","commandType":"auto","position":17.0,"command":"val datesDF = databricksBlogDF.select($\"dates\")\ndisplay(datesDF)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"78e8366c-ad12-427f-b449-eac7a219e3e3"},{"version":"CommandV1","origId":1745794912675245,"guid":"b659f987-5e13-42fb-8221-d654430c30b5","subtype":"command","commandType":"auto","position":18.0,"command":"%md\nPull out a specific subfield with `.` (object) notation.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b39cc2ef-4c67-4293-805a-2968f9ba2b9e"},{"version":"CommandV1","origId":1745794912675246,"guid":"2649334b-bf7f-4d01-ac8a-a5eb78ccf03b","subtype":"command","commandType":"auto","position":19.0,"command":"display(databricksBlogDF.select($\"dates.createdOn\", $\"dates.publishedOn\"))","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6c96875f-d7e4-4a25-8875-d326038c4c46"},{"version":"CommandV1","origId":1745794912675247,"guid":"07a65ab3-240c-48de-8f3f-27f520b4cc1c","subtype":"command","commandType":"auto","position":20.0,"command":"%md\nCreate a DataFrame, `databricksBlog2DF` that contains the original columns plus the new `publishedOn` column obtained\nfrom flattening the dates column.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"625f9472-d27a-4d80-ab78-dac1b66b362b"},{"version":"CommandV1","origId":1745794912675248,"guid":"491d1ad7-376c-47b8-bc3f-f3fb35c88c8b","subtype":"command","commandType":"auto","position":21.0,"command":"val databricksBlog2DF = databricksBlogDF.withColumn(\"publishedOn\",$\"dates.publishedOn\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e0721840-057f-4a78-b70b-316f2004b9d9"},{"version":"CommandV1","origId":1745794912675249,"guid":"309efd95-9ccb-4a56-9e22-dfe627e2651c","subtype":"command","commandType":"auto","position":22.0,"command":"%md\nWith this temporary view, apply the `printSchema` method to check its schema and confirm the timestamp conversion.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"11edb401-f836-4dce-9d5d-c0b5b1d3cffb"},{"version":"CommandV1","origId":1745794912675250,"guid":"caaf387e-24c7-4341-9a44-8dd87bca85e4","subtype":"command","commandType":"auto","position":23.0,"command":"databricksBlog2DF.printSchema","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d6d907ca-3e8a-4666-9948-0d3fce40d146"},{"version":"CommandV1","origId":1745794912675251,"guid":"40be9122-d6ed-492e-acc6-a78544014184","subtype":"command","commandType":"auto","position":24.0,"command":"%md\nBoth `createdOn` and `publishedOn` are stored as strings.\n\nCast those values to SQL timestamps:\n\nIn this case, use a single `select` method to:\n0. Cast `dates.publishedOn` to a `timestamp` data type\n0. \"Flatten\" the `dates.publishedOn` column to just `publishedOn`","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"368d5023-6c96-4fbe-9c12-36aee608b61a"},{"version":"CommandV1","origId":1745794912675252,"guid":"67eaabdc-e67a-465e-bb69-99628e263558","subtype":"command","commandType":"auto","position":25.0,"command":"import org.apache.spark.sql.functions.to_timestamp\ndisplay(databricksBlogDF.select($\"title\",to_timestamp($\"dates.publishedOn\",\"yyyy-MM-dd\") as \"publishedOn\"))","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"be7d0604-dfaf-4f2d-b145-853e41c6b821"},{"version":"CommandV1","origId":1745794912675253,"guid":"d0bac582-3e94-424a-9f35-a0a05f8ec003","subtype":"command","commandType":"auto","position":26.0,"command":"%md\nCreate another DataFrame, `databricksBlog2DF` that contains the original columns plus the new `publishedOn` column obtained\nfrom flattening the dates column.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"449f9e74-9405-45c6-917c-6642928bf1f0"},{"version":"CommandV1","origId":1745794912675254,"guid":"9fc3bb92-5fd6-4ea8-bc75-234d6c22b752","subtype":"command","commandType":"auto","position":27.0,"command":"val databricksBlog2DF = databricksBlogDF.withColumn(\"publishedOn\", to_timestamp($\"dates.publishedOn\",\"yyyy-MM-dd\")) \ndisplay(databricksBlog2DF)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a07d95b0-c24d-415d-aa97-f85fa5f5c82a"},{"version":"CommandV1","origId":1745794912675255,"guid":"2b6ca64a-20e1-47a1-90ff-be36f91f2ff4","subtype":"command","commandType":"auto","position":28.0,"command":"%md\nWith this temporary view, apply the `printSchema` method to check its schema and confirm the timestamp conversion.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"862d7a66-977b-4531-b255-451d7213a450"},{"version":"CommandV1","origId":1745794912675256,"guid":"497898d8-670d-406e-ae46-e09a4df21a84","subtype":"command","commandType":"auto","position":29.0,"command":"databricksBlog2DF.printSchema","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cdfb79dc-697b-42f8-99cb-fe3436fa685e"},{"version":"CommandV1","origId":1745794912675257,"guid":"74cbed30-1063-4774-8725-c30b4d54fad8","subtype":"command","commandType":"auto","position":30.0,"command":"%md-sandbox\nSince the dates are represented by a `timestamp` data type, we need to convert to a data type that allows `<` and `>`-type comparison operations in order to query for articles within certain date ranges (such as a list of all articles published in 2013). This is accopmplished by using the `to_date` function in Scala or Python.\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> See the Spark documentation on <a href=\"https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$\" target=\"_blank\">built-in functions</a>, for a long list of date-specific functions.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"768604b2-370b-42e2-ae31-49f40fca52f2"},{"version":"CommandV1","origId":1745794912675258,"guid":"e4882385-3615-4077-81f7-89213eb90ab5","subtype":"command","commandType":"auto","position":31.0,"command":"import org.apache.spark.sql.functions.{to_date, year}\nval resultDF = databricksBlog2DF\n  .select($\"title\",to_date($\"publishedOn\",\"MMM dd, yyyy\") as \"date\",$\"link\")\n  .filter(year($\"publishedOn\") === \"2013\")\n  .orderBy($\"publishedOn\")\n\ndisplay(resultDF)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"93f4c023-19a5-4b1d-9c4b-e3cffb35b7ca"},{"version":"CommandV1","origId":1745794912675259,"guid":"e7d2b1a2-dea8-406c-adb0-ecb7d8115c64","subtype":"command","commandType":"auto","position":32.0,"command":"%md\n## Array Data\n\nThe DataFrame also contains array columns. \n\nEasily determine the size of each array using the built-in `size(..)` function with array columns.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e18044fe-8d65-492c-a4bb-166c1d0d4c9e"},{"version":"CommandV1","origId":1745794912675260,"guid":"3ea20ce6-a457-4f7d-8e1f-599e1d710de4","subtype":"command","commandType":"auto","position":34.0,"command":"import org.apache.spark.sql.functions.size\ndisplay(databricksBlogDF.select(size($\"authors\"),$\"authors\"))","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"60eea435-3de2-465b-a1ed-7dd777d839d8"},{"version":"CommandV1","origId":1745794912675261,"guid":"ec59393c-02ca-4e61-8ba1-dbbcffd3b70b","subtype":"command","commandType":"auto","position":35.0,"command":"%md\nPull the first element from the array `authors` using an array subscript operator.\n\nFor example, in Scala, the 0th element of array `authors` is `authors(0)`\nwhereas, in Python, the 0th element of `authors` is `authors[0]`.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"83637f36-bb9c-4c92-a406-442d6dc10cdb"},{"version":"CommandV1","origId":1745794912675262,"guid":"04b9c66b-7bf5-46e9-b7c7-62e2d511a018","subtype":"command","commandType":"auto","position":36.0,"command":"display(databricksBlogDF.select($\"authors\"(0) as \"primaryAuthor\"))","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7b529eed-ceb0-41b1-8cbd-439264df17d2"},{"version":"CommandV1","origId":1745794912675263,"guid":"478bbd0a-4a35-49fd-82df-d8972283672a","subtype":"command","commandType":"auto","position":37.0,"command":"%md\n### Explode\n\nThe `explode` method allows you to split an array column into multiple rows, copying all the other columns into each new row. \n\nFor example, split the column `authors` into the column `author`, with one author per row.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9c7d472f-4aeb-477b-bbb7-028764bb287d"},{"version":"CommandV1","origId":1745794912675264,"guid":"33a7e1ed-21e8-45ce-939b-10e726f2cdc4","subtype":"command","commandType":"auto","position":39.0,"command":"import org.apache.spark.sql.functions.explode\ndisplay(databricksBlogDF.select($\"title\",$\"authors\",explode($\"authors\") as \"author\", $\"link\"))","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8fc2cd89-f170-4d8d-85b0-5614393fef9f"},{"version":"CommandV1","origId":1745794912675265,"guid":"4dac3bc0-b48c-419e-8eb3-f5c42d6db388","subtype":"command","commandType":"auto","position":40.0,"command":"%md\nIt's more obvious to restrict the output to articles that have multiple authors, and then sort by the title.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a9ae2189-5d49-4ac8-99ec-076bc6e6e0c9"},{"version":"CommandV1","origId":1745794912675266,"guid":"b797ef54-52b6-45af-93d1-9c74ed69994d","subtype":"command","commandType":"auto","position":41.0,"command":"val databricksBlog2DF = databricksBlogDF\n  .select($\"title\",$\"authors\",explode($\"authors\") as \"author\", $\"link\")\n  .filter(size($\"authors\") > 1)\n  .orderBy($\"title\")\n  \ndisplay(databricksBlogDF)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c253964f-6761-4121-bb3c-1e7d778ef351"},{"version":"CommandV1","origId":1745794912675267,"guid":"ea541450-f925-4b81-9e91-db4a04715556","subtype":"command","commandType":"auto","position":42.0,"command":"%md\n## Exercise 1\n\nIdentify all the articles written or co-written by Michael Armbrust.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ecbb1aec-f26d-4841-b82a-5eddc25a59e6"},{"version":"CommandV1","origId":1745794912675268,"guid":"847dcd1c-2ca6-40de-b009-9d7d6d8e3a00","subtype":"command","commandType":"auto","position":43.0,"command":"%md-sandbox\n### Step 1\n\nStarting with the `databricksBlogDF` DataFrame, create a DataFrame called `articlesByMichaelDF` where:\n0. Michael Armbrust is the author.\n0. The data set contains the column `title` (it may contain others).\n0. It contains only one record per article.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** See the Spark documentation on <a href=\"https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.functions$\" target=\"_blank\">built-in functions</a>.  \n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** Include the column `authors` in your view to help you debug your solution.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"53e49b1f-1cab-452e-a769-0b536b58bc31"},{"version":"CommandV1","origId":1745794912675269,"guid":"899b3ea7-f0ef-4466-abd2-72425ed7f5e5","subtype":"command","commandType":"auto","position":44.0,"command":"// TODO\nimport org.apache.spark.sql.functions.array_contains\nval articlesByMichaelDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b91e0884-c3ad-4487-a4c7-acdef8680dd7"},{"version":"CommandV1","origId":1745794912675270,"guid":"aed02958-f083-4e19-8930-77013cae507f","subtype":"command","commandType":"auto","position":45.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val resultsCount = articlesByMichaelDF.count()\ndbTest(\"DF-L5-articlesByMichael-count\", 3, resultsCount)  \n\nlazy val results = articlesByMichaelDF.collect()\n\ndbTest(\"DF-L5-articlesByMichael-0\", Row(\"Spark SQL: Manipulating Structured Data Using Apache Spark\"), results(0))\ndbTest(\"DF-L5-articlesByMichael-1\", Row(\"Exciting Performance Improvements on the Horizon for Spark SQL\"), results(1))\ndbTest(\"DF-L5-articlesByMichael-2\", Row(\"Spark SQL Data Sources API: Unified Data Access for the Apache Spark Platform\"), results(2))\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"851cb825-006c-4948-a598-01de102caae2"},{"version":"CommandV1","origId":1745794912675271,"guid":"52d520ec-f836-4e43-8c14-c340468762e0","subtype":"command","commandType":"auto","position":46.0,"command":"%md\n### Step 2\nShow the list of Michael Armbrust's articles in HTML format.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"94c27718-f7b5-427c-ae3b-b500176b563d"},{"version":"CommandV1","origId":1745794912675272,"guid":"e49267d6-94e7-4a77-9115-df71918c5d7c","subtype":"command","commandType":"auto","position":47.0,"command":"%md\n## Exercise 2\n\nIdentify the complete set of categories used in the Databricks blog articles.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"63ed615c-1c9f-447f-a2c7-7b3fc2de686e"},{"version":"CommandV1","origId":1745794912675273,"guid":"ac5b710d-ae27-4f68-a1f0-0322387111f7","subtype":"command","commandType":"auto","position":48.0,"command":"%md\n### Step 1\n\nStarting with the `databricksBlogDF` DataFrame, create another DataFrame called `uniqueCategoriesDF` where:\n0. The data set contains the one column `category` (and no others).\n0. This list of categories should be unique.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8736c1f6-f2b9-499d-8c86-97d3271580dd"},{"version":"CommandV1","origId":1745794912675274,"guid":"4c30c09c-5138-4cf9-a10b-d457013a9760","subtype":"command","commandType":"auto","position":49.0,"command":"// TODO\nval uniqueCategoriesDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9fb937c8-15ac-486d-b41b-3dd56d1b0c72"},{"version":"CommandV1","origId":1745794912675275,"guid":"c122d411-d933-4c39-a36b-a4a23e3cc040","subtype":"command","commandType":"auto","position":50.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val resultsCount =  uniqueCategoriesDF.count()\n\ndbTest(\"DF-L5-uniqueCategories-count\", 12, resultsCount)\n\nlazy val results = uniqueCategoriesDF.collect()\ndbTest(\"DF-L5-uniqueCategories-0\", Row(\"Announcements\"), results(0) )\ndbTest(\"DF-L5-uniqueCategories-1\", Row(\"Apache Spark\"), results(1))\ndbTest(\"DF-L5-uniqueCategories-2\", Row(\"Company Blog\"), results(2))\n\ndbTest(\"DF-L5-uniqueCategories-9\", Row(\"Platform\"), results(9))\ndbTest(\"DF-L5-uniqueCategories-10\", Row(\"Product\"), results(10))\ndbTest(\"DF-L5-uniqueCategories-11\", Row(\"Streaming\"), results(11))\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7b9f3169-d4bf-4498-a74e-005d1052ccdd"},{"version":"CommandV1","origId":1745794912675276,"guid":"5b09ef5d-94a4-4838-bc02-677f2ff57eae","subtype":"command","commandType":"auto","position":51.0,"command":"%md\n### Step 2\nShow the complete list of categories.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"270eea65-9b9f-4795-b0e8-5df92fc11fce"},{"version":"CommandV1","origId":1745794912675277,"guid":"d4190adc-3d0c-4b23-b938-5b98845a05c4","subtype":"command","commandType":"auto","position":52.0,"command":"// TODO\n\nFILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3ff8880d-51b1-4229-b0b1-a34723718ca1"},{"version":"CommandV1","origId":1745794912675278,"guid":"9b25ddc2-b881-4a53-be15-625987d781ba","subtype":"command","commandType":"auto","position":53.0,"command":"%md\n## Exercise 3\n\nCount how many times each category is referenced in the Databricks blog.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fc4ac561-6146-4a38-95ee-4121d7f743bf"},{"version":"CommandV1","origId":1745794912675279,"guid":"5b07066d-2b27-42bc-b31c-73966e440bf3","subtype":"command","commandType":"auto","position":54.0,"command":"%md-sandbox\n### Step 1\n\nStarting with the `databricksBlogDF` DataFrame, create another DataFrame called `totalArticlesByCategoryDF` where:\n0. The new DataFrame contains two columns, `category` and `total`.\n0. The `category` column is a single, distinct category (similar to the last exercise).\n0. The `total` column is the total number of articles in that category.\n0. Order by `category`.\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> Because articles can be tagged with multiple categories, the sum of the totals adds up to more than the total number of articles.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7d899952-92c3-43c3-9bfb-13f8440d7b1f"},{"version":"CommandV1","origId":1745794912675280,"guid":"96e1f0b4-af69-4aa2-a625-fdf5566d55ac","subtype":"command","commandType":"auto","position":55.0,"command":"// TODO\n\nimport org.apache.spark.sql.functions.count\nval totalArticlesByCategoryDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"36915483-221c-4d4e-9964-5567ac053e56"},{"version":"CommandV1","origId":1745794912675281,"guid":"c8862ed4-a34c-4126-8804-211bfc53c84d","subtype":"command","commandType":"auto","position":56.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val results = totalArticlesByCategoryDF.count()\ndbTest(\"DF-L5-articlesByCategory-count\", 12, results)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3bc38504-0132-49a6-bf3a-f93357c1c095"},{"version":"CommandV1","origId":1745794912675282,"guid":"1dbb9716-818f-448b-a469-0ff405cb56c9","subtype":"command","commandType":"auto","position":57.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val results = totalArticlesByCategoryDF.collect()\ndbTest(\"DF-L5-articlesByCategory-0\", Row(\"Announcements\",72), results(0))\ndbTest(\"DF-L5-articlesByCategory-1\", Row(\"Apache Spark\",132), results(1))\ndbTest(\"DF-L5-articlesByCategory-2\", Row(\"Company Blog\",224), results(2))\n\ndbTest(\"DF-L5-articlesByCategory-9\", Row(\"Platform\",4), results(9))\ndbTest(\"DF-L5-articlesByCategory-10\", Row(\"Product\",83), results(10))\ndbTest(\"DF-L5-articlesByCategory-11\", Row(\"Streaming\",21), results(11))\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"14e3b97e-aca4-4f11-a95e-a5212f201e82"},{"version":"CommandV1","origId":1745794912675283,"guid":"91f757fc-fa29-41d0-be32-8ee0d5586616","subtype":"command","commandType":"auto","position":58.0,"command":"%md\n### Step 2\nDisplay the totals of each category in html format (should be ordered by `category`).","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"204e7b0c-f398-42b7-95a2-4d2b84835a4d"},{"version":"CommandV1","origId":1745794912675284,"guid":"8b64c629-3607-4353-bf8b-196cfc89795c","subtype":"command","commandType":"auto","position":59.0,"command":"// TODO\n\nFILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1a7c45aa-5f81-4b2d-a167-27c99c782ffb"},{"version":"CommandV1","origId":1745794912675285,"guid":"988de259-6771-49e5-b138-faf9df49375c","subtype":"command","commandType":"auto","position":60.0,"command":"%md\n## Summary\n\n* Spark DataFrames allows you to query and manipulate structured and semi-structured data.\n* Spark DataFrames built-in functions provide powerful primitives for querying complex schemas.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a574009c-a506-4521-893d-7c7a2a27fad2"},{"version":"CommandV1","origId":1745794912675286,"guid":"e49988a4-a1ae-4262-a72e-e334967eaaef","subtype":"command","commandType":"auto","position":61.0,"command":"%md\n## Review Questions\n**Q:** What is the syntax for accessing nested columns?  \n**A:** Use the dot notation:`select($\"dates.publishedOn\")`\n\n**Q:** What is the syntax for accessing the first element in an array?  \n**A:** Use the [subscript] notation: `select($\"authors\"(0))`\n\n**Q:** What is the syntax for expanding an array into multiple rows?  \n**A:** Use the explode method:  `select(explode($\"authors\") as \"Author\")`","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"41b7e700-e73f-4d88-866f-8573d74fe2d6"},{"version":"CommandV1","origId":1745794912675287,"guid":"cfb8e1fe-1552-4e64-b550-54d1bc3d3678","subtype":"command","commandType":"auto","position":62.0,"command":"%md\n## Next Steps\n\nStart the next lesson, [Querying Data Lakes with DataFrames]($./06-Data-Lakes).","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8a34b5e0-9137-46d1-b505-95d682ac72e7"},{"version":"CommandV1","origId":1745794912675288,"guid":"aa81934e-ac3b-431d-91e2-fa9dfcf7ae24","subtype":"command","commandType":"auto","position":63.0,"command":"%md\n## Additional Topics & Resources\n\n* <a href=\"http://spark.apache.org/docs/latest/sql-programming-guide.html\" target=\"_blank\">Spark SQL, DataFrames and Datasets Guide</a>","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8a49b110-2ce8-4fbd-9f1a-2f3ec40ca24d"}],"dashboards":[],"guid":"ac7d5d55-c0f9-4d53-8116-aff571570b6b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}