{"version":"NotebookV1","origId":1745794912677522,"name":"Table-Creator","language":"python","commands":[{"version":"CommandV1","origId":1745794912677523,"guid":"e63d9a52-fc15-4c57-8368-3e9dbe254094","subtype":"command","commandType":"auto","position":1.0,"command":"%python\n# Create Tables\n# This notebook creates tables in Databricks from external files, primarily to make SQL access easier. \n# You can run this notebook yourself, but if you follow the lessons in order, one of the other notebooks will run this notebook for you.\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a5ed50ec-e68d-4ba7-b3d3-7f0d5ec6c386"},{"version":"CommandV1","origId":1745794912677524,"guid":"ce384135-30de-47de-94f0-6484d55a5c58","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n\nfrom pathlib2 import Path\n\nfilePeople = \"/mnt/training/dataframes/people-10m.parquet\"\nfileNames = \"dbfs:/mnt/training/ssn/names.parquet\"\nfileBlog = \"dbfs:/mnt/training/databricks-blog.json\"\nfileCity = \"dbfs:/mnt/training/City-Data.parquet\"\nfilePlane = \"dbfs:/mnt/training/asa/planes/plane-data.csv\"\nfileSmall = \"dbfs:/mnt/training/asa/flights/small.csv\"\nfileGeo = \"dbfs:/mnt/training/ip-geocode.parquet\"\nfileBikes = \"dbfs:/mnt/training/bikeSharing/data-001/day.csv\"\n\ndbutils.fs.ls(filePeople)\ndbutils.fs.ls(fileNames)\ndbutils.fs.ls(fileBlog)\ndbutils.fs.ls(fileCity)\ndbutils.fs.ls(filePlane)\ndbutils.fs.ls(fileSmall)\ndbutils.fs.ls(fileGeo)\ndbutils.fs.ls(fileBikes)\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d532bbc0-2c00-4e74-a652-c299d031dfcb"},{"version":"CommandV1","origId":1745794912677525,"guid":"6857823e-7f6f-4749-8108-88b4e0e1afe0","subtype":"command","commandType":"auto","position":3.0,"command":"%python\n\ndef deleteTables() :\n  try:\n    tables=spark.catalog.listTables(\"Databricks\")\n  except:\n    return\n  for table in tables:\n      spark.sql(\"DROP TABLE {}.{}\".format(\"Databricks\", table.name))\n      \n# deleteTables()\n      \nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d8a3997b-230b-4c45-abb8-f75c5d5061ea"},{"version":"CommandV1","origId":1745794912677526,"guid":"877645a9-7531-4b2a-84f3-1809aac4f8ce","subtype":"command","commandType":"auto","position":4.0,"command":"%python\n\nspark.sql(\"CREATE DATABASE IF NOT EXISTS Databricks\")\nspark.sql(\"USE Databricks\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"149f789d-eb1a-4b71-9cac-7aff32b3df2c"},{"version":"CommandV1","origId":1745794912677527,"guid":"88d12c18-777e-442d-b6ea-074cd1e2dc41","subtype":"command","commandType":"auto","position":5.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS People10M\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(filePeople));\n\nspark.sql(\"uncache TABLE People10M\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c2a6d050-54e4-491b-8577-0f9e9dcf05ce"},{"version":"CommandV1","origId":1745794912677528,"guid":"5b2926e9-3098-4385-a912-84c4ea6e3dd9","subtype":"command","commandType":"auto","position":6.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS SSANames\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileNames))\n\nspark.sql(\"uncache TABLE SSANames\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9c16322b-7930-4e77-b2a9-645cee0ad81a"},{"version":"CommandV1","origId":1745794912677529,"guid":"b0ec825c-0b3a-47f6-80c1-ea7d0971a47e","subtype":"command","commandType":"auto","position":7.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS DatabricksBlog\nUSING json\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\"\n)\"\"\".format(fileBlog))\n\nspark.sql(\"uncache TABLE DatabricksBlog\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9794c77e-ad49-4ac1-a542-783826f7e330"},{"version":"CommandV1","origId":1745794912677530,"guid":"22e119dd-6ec5-4433-8078-ff54e86570c2","subtype":"command","commandType":"auto","position":8.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS CityData\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileCity))\n\nspark.sql(\"uncache TABLE CityData\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f4e748fe-94bc-4287-9dbe-e7c479532f40"},{"version":"CommandV1","origId":1745794912677531,"guid":"3a1b1e49-29d9-488f-ae90-abd811be42e9","subtype":"command","commandType":"auto","position":9.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlinePlane (`tailnum` STRING, `type` STRING, `manufacturer` STRING, `issue_date` STRING, `model` STRING, `status` STRING, `aircraft_type` STRING, `engine_type` STRING, `year` STRING)\nUSING csv \nOPTIONS (\n  header \"true\",\n  delimiter \",\",\n  inferSchema \"false\",\n  path \"{}\"\n)\"\"\".format(filePlane))\n\nspark.sql(\"uncache TABLE AirlinePlane\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ef9c1281-485f-4f34-a1d1-b5e1f30bdce4"},{"version":"CommandV1","origId":1745794912677532,"guid":"9f8d1bdf-738c-4c52-be5a-f6b631f31638","subtype":"command","commandType":"auto","position":10.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlineFlight (`Year` INT, `Month` INT, `DayofMonth` INT, `DayOfWeek` INT, `DepTime` STRING, `CRSDepTime` INT, `ArrTime` STRING, `CRSArrTime` INT, `UniqueCarrier` STRING, `FlightNum` INT, `TailNum` STRING, `ActualElapsedTime` STRING, `CRSElapsedTime` INT, `AirTime` STRING, `ArrDelay` STRING, `DepDelay` STRING, `Origin` STRING, `Dest` STRING, `Distance` INT, `TaxiIn` INT, `TaxiOut` INT, `Cancelled` INT, `CancellationCode` STRING, `Diverted` INT, `CarrierDelay` STRING, `WeatherDelay` STRING, `NASDelay` STRING, `SecurityDelay` STRING, `LateAircraftDelay` STRING)\nUSING CSV OPTIONS (\n  header=\"true\", \n  delimiter=\",\", \n  inferSchema=\"true\", \n  path=\"{}\")\n\"\"\".format(fileSmall))\n\nspark.sql(\"uncache TABLE AirlineFlight\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ede6f6bf-ea71-4e10-9679-93a5d5166822"},{"version":"CommandV1","origId":1745794912677533,"guid":"ff540db7-650a-416c-9787-ea6c2e0b84de","subtype":"command","commandType":"auto","position":11.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS IPGeocode (`startingIP` DECIMAL(38,0), `endingIP` DECIMAL(38,0), `countryCode2` STRING, `countryCode3` STRING, `country` STRING, `stateProvince` STRING, `city` STRING, `latitude` DOUBLE, `longitude` DOUBLE)\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\n\"\"\".format(fileGeo))\n\nspark.sql(\"uncache TABLE IPGeocode\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"32cd0ba1-31a9-4b0a-a00a-2a95bbb0c0a3"},{"version":"CommandV1","origId":1745794912677534,"guid":"13826faf-82c5-420c-b7f8-7c017e1c1d47","subtype":"command","commandType":"auto","position":12.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS BikeSharingDay\nUSING csv\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\",\n  header \"true\"\n)\"\"\".format(fileBikes))\n\nspark.sql(\"uncache TABLE BikeSharingDay\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"08b34821-ef9f-4294-8957-5e7c92dc53f4"},{"version":"CommandV1","origId":1745794912677535,"guid":"01edb50c-a172-4d0b-88cb-58737c618917","subtype":"command","commandType":"auto","position":13.0,"command":"%python\n\ndisplayHTML(\"Created Database and Tables...\") # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"55a875ac-5eb4-4681-baea-2c6d1e036ca9"}],"dashboards":[],"guid":"a82f2a19-ed5d-416b-90cd-bd25998f8975","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}