{"version":"NotebookV1","origId":1745794912682257,"name":"02-Exploratory-Data-Analysis","language":"python","commands":[{"version":"CommandV1","origId":974699126453872,"guid":"863aec30-3572-400b-8058-a6f7837f5c3e","subtype":"command","commandType":"auto","position":53.0,"command":"%md\n## Next Steps\n\nStart the next lesson, [Power BI]($./03-Power-BI).","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8cc52d46-15d0-46ce-bbcc-97c06185c022"},{"version":"CommandV1","origId":1745794912682258,"guid":"50946226-9ae0-4af2-8bea-fa1e04a275d3","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Project: Exploratory Data Analysis\nPerform exploratory data analysis (EDA) to gain insights from a data lake.\n\n## Instructions\n\nIn `dbfs:/mnt/training/crime-data-2016`, there are a number of Parquet files containing 2016 crime data from seven United States cities:\n\n* New York\n* Los Angeles\n* Chicago\n* Philadelphia\n* Dallas\n* Boston\n\n\nThe data is cleaned up a little, but has not been normalized. Each city reports crime data slightly differently, so\nexamine the data for each city to determine how to query it properly.\n\nYour job is to use some of this data to gain insights about certain kinds of crimes.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237950827,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fab05fa9-0f23-4c55-a1e6-5bf98823c701"},{"version":"CommandV1","origId":1745794912682259,"guid":"de6b94b9-f623-4d8f-9cd2-c8c7ec05649b","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n### Getting Started\n\nRun the following cell to configure our \"classroom.\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237950977,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e6b3ad57-b70f-408c-b625-67725deeeae5"},{"version":"CommandV1","origId":1745794912682260,"guid":"f03c24e9-b678-4970-a778-06a0aab7416a","subtype":"command","commandType":"auto","position":4.0,"command":"%run ./Includes/Classroom-Setup","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237951179,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d3843895-30a9-429b-b30c-681e5ac85bdc"},{"version":"CommandV1","origId":1745794912682261,"guid":"c8375989-93e3-4a64-939b-e960f06e754f","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Step 1\n\nStart by creating DataFrames for Los Angeles, Philadelphia, and Dallas data.\n\nUse `spark.read.parquet` to create named DataFrames for the files you choose. \n\nTo read in the parquet file, use `crimeDataNewYorkDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-New-York-2016.parquet\")`\n\n\nUse the following view names:\n\n| City          | DataFrame Name            | Path to DBFS file\n| ------------- | ------------------------- | -----------------\n| Los Angeles   | `crimeDataLosAngelesDF`   | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Los-Angeles-2016.parquet`\n| Philadelphia  | `crimeDataPhiladelphiaDF` | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Philadelphia-2016.parquet`\n| Dallas        | `crimeDataDallasDF`       | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Dallas-2016.parquet`","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237951356,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"585461fb-0210-4440-9c52-fa95059107f7"},{"version":"CommandV1","origId":1745794912682262,"guid":"77b80f99-d58f-4774-8d9e-9c5bd8290853","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237951533,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b3a98dab-7fd6-42d5-ba66-45e88ed9c6b8"},{"version":"CommandV1","origId":1745794912682263,"guid":"46ea67e0-6e75-4c6a-a52e-50ffc9129617","subtype":"command","commandType":"auto","position":7.0,"command":"# TODO\n\ncrimeDataLosAngelesDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237951735,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b3d6a4c0-5f58-4104-9067-1a401fb4e2b5"},{"version":"CommandV1","origId":1745794912682264,"guid":"52d01e0f-97d7-4c83-a99f-5ae3e26f2c1b","subtype":"command","commandType":"auto","position":8.0,"command":"# TEST - Run this cell to test your solution.\n\nrowsLosAngeles  = crimeDataLosAngelesDF.count()\ndbTest(\"DF-L7-crimeDataLA-count\", rowsLosAngeles, 217945)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237951905,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"53c3e7c5-1921-48ca-8cc6-58ca30065dfc"},{"version":"CommandV1","origId":1745794912682265,"guid":"d4343fc0-2ecb-452d-b8d8-35f4903d6c04","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237952071,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"411c61ca-a681-4613-9dcb-23a8369b5281"},{"version":"CommandV1","origId":1745794912682266,"guid":"00b4f607-1847-4607-8a01-7266f02ed6ca","subtype":"command","commandType":"auto","position":10.0,"command":"# TODO\n\ncrimeDataPhiladelphiaDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237952264,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e64623a8-b917-4166-a0bb-a73e0086e73f"},{"version":"CommandV1","origId":1745794912682267,"guid":"22729f00-2a3c-4573-8d72-353537b27a49","subtype":"command","commandType":"auto","position":11.0,"command":"# TEST - Run this cell to test your solution.\n\nrowsPhiladelphia  = crimeDataPhiladelphiaDF.count()\ndbTest(\"DF-L7-crimeDataPA-count\", rowsPhiladelphia, 168664)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237952417,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"869b7f2e-b724-4005-aa96-37d071299339"},{"version":"CommandV1","origId":1745794912682268,"guid":"1dd9c090-1797-4eb5-b19f-2afbe5ac9d33","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237952581,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bc3d501f-0503-4b14-a168-ffe38b64060c"},{"version":"CommandV1","origId":1745794912682269,"guid":"3681daad-267f-406e-89e7-dee91ddcd6bd","subtype":"command","commandType":"auto","position":13.0,"command":"# TODO\n\ncrimeDataDallasDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237952770,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c05db391-c66a-4fed-a926-c6d218852791"},{"version":"CommandV1","origId":1745794912682270,"guid":"0b3c051e-a938-48b7-a77a-140a42c386c6","subtype":"command","commandType":"auto","position":14.0,"command":"# TEST - Run this cell to test your solution.\n\nrowsDallas  = crimeDataDallasDF.count()\ndbTest(\"DF-L7-crimeDataDAL-count\", 99642, rowsDallas)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237952930,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3ff1b507-9c2a-47df-a638-60e612c2d81c"},{"version":"CommandV1","origId":1745794912682271,"guid":"44634665-0573-466d-a7e2-843d6bbb6563","subtype":"command","commandType":"auto","position":15.0,"command":"%md-sandbox\n## Step 2\n\nFor each table, examine the data to figure out how to extract _robbery_ statistics.\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> Each city uses different values to indicate robbery. Commonly used terminology is \"larceny\", \"burglary\" or \"robbery.\"  These challenges are common in Data Lakes.  Restrict yourself to only robberies.\n\nExplore the data for the three cities until you understand how each city records robbery information. If you don't want to worry about upper- or lower-case, \nremember to use the DataFrame `lower()` method to converts column values to lowercase.\n\nCreate a DataFrame containing only the robbery-related rows, as shown in the table below.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** For each table, focus your efforts on the column listed below.\n\nFocus on the following columns for each table:\n\n| DataFrame Name            | Robbery DataFrame Name  | Column\n| ------------------------- | ----------------------- | -------------------------------\n| `crimeDataLosAngelesDF`   | `robberyLosAngelesDF`   | `crimeCodeDescription`\n| `crimeDataPhiladelphiaDF` | `robberyPhiladelphiaDF` | `ucr_general_description`\n| `crimeDataDallasDF`       | `robberyDallasDF`       | `typeOfIncident`","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237953105,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4ecdcd44-c7df-4d33-9f33-825f6a647494"},{"version":"CommandV1","origId":1745794912682272,"guid":"b77ece05-22a5-48b0-81e5-5ea5ead428d1","subtype":"command","commandType":"auto","position":16.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237953282,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e10043d7-de6d-46be-94a1-60fd85d33279"},{"version":"CommandV1","origId":1745794912682273,"guid":"ee45647b-2269-4e2c-a758-55eaeed7dea3","subtype":"command","commandType":"auto","position":17.0,"command":"# TODO\nfrom pyspark.sql.functions import col, lower\nrobberyLosAngelesDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237953455,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"56b80fb8-57d9-4658-a356-a068d3ed9feb"},{"version":"CommandV1","origId":1745794912682274,"guid":"7541eaea-5583-47ee-a8b8-8b23a10373aa","subtype":"command","commandType":"auto","position":18.0,"command":"# TEST - Run this cell to test your solution.\n\ntotalLosAngeles  = robberyLosAngelesDF.count()\ndbTest(\"DF-L7-robberyDataLA-count\", 9048, totalLosAngeles)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237953624,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b6006a6f-fd84-418a-9f8d-af917f6597bd"},{"version":"CommandV1","origId":1745794912682275,"guid":"bdbf3cbc-90a6-4ce3-b6a2-ada93fa17da1","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237953792,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a2045b86-cacc-4a5f-907a-fd4f48e49759"},{"version":"CommandV1","origId":1745794912682276,"guid":"e210c273-6d43-4bb2-91c0-a2dc6073e859","subtype":"command","commandType":"auto","position":20.0,"command":"# TODO\n\nrobberyPhiladelphiaDF  = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237954012,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"85fc074d-2ca5-4653-9612-50498db0435f"},{"version":"CommandV1","origId":1745794912682277,"guid":"cb24ace2-407d-4633-b383-63c68de75d4d","subtype":"command","commandType":"auto","position":21.0,"command":"# TEST - Run this cell to test your solution.\n\ntotalPhiladelphia  = robberyPhiladelphiaDF.count()\ndbTest(\"DF-L7-robberyDataPA-count\", 6149, totalPhiladelphia)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237954235,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"038c9517-8081-49b3-b736-77e3da897bd1"},{"version":"CommandV1","origId":1745794912682278,"guid":"1bd361fc-999e-4a7b-9e0e-15a43eab8eb5","subtype":"command","commandType":"auto","position":22.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237954383,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9571752c-0fee-4e3c-b0a7-0141baa71787"},{"version":"CommandV1","origId":1745794912682279,"guid":"59ffb3a8-3523-45ab-959b-a94394c5a84f","subtype":"command","commandType":"auto","position":23.0,"command":"# TODO\n\nrobberyDallasDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237954574,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7148485a-36a2-48fa-ae6c-0ca835bbed1b"},{"version":"CommandV1","origId":1745794912682280,"guid":"5d253ed5-c297-4283-8d26-bd533591c1a2","subtype":"command","commandType":"auto","position":24.0,"command":"# TEST - Run this cell to test your solution.\n\ntotalDallas = robberyDallasDF.count()\ndbTest(\"DF-L7-robberyDataDAL-count\", 6824, totalDallas)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237954790,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"66850e26-a151-4735-84da-02f4a07d8fbb"},{"version":"CommandV1","origId":1745794912682281,"guid":"a99144a5-80fb-44c8-9206-7f3e45bfca50","subtype":"command","commandType":"auto","position":25.0,"command":"%md-sandbox\n## Step 3\n\nNow that you have DataFrames of only the robberies in each city, create DataFrames for each city summarizing the number of robberies in each month.\n\nYour DataFrames must contain two columns:\n* `month`: The month number (e.g., 1 for January, 2 for February, etc.).\n* `robberies`: The total number of robberies in the month.\n\nUse the following DataFrame names and date columns:\n\n\n| City          | DataFrame Name     | Date Column \n| ------------- | ------------- | -------------\n| Los Angeles   | `robberiesByMonthLosAngelesDF` | `timeOccurred`\n| Philadelphia  | `robberiesByMonthPhiladelphiaDF` | `dispatch_date_time`\n| Dallas        | `robberiesByMonthDallasDF` | `startingDateTime`\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> For each city, figure out which column contains the date of the incident. Then, extract the month from that date.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237954955,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1662837f-6e4c-46d7-9f87-ceb524331739"},{"version":"CommandV1","origId":1745794912682282,"guid":"5547d70b-1f73-4984-bee3-0a02827af1c7","subtype":"command","commandType":"auto","position":26.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237955181,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"97eea7ba-2756-4bb2-a6fa-ca5395f82422"},{"version":"CommandV1","origId":1745794912682283,"guid":"041862f3-e3af-4602-907b-cbdd27b3cbdb","subtype":"command","commandType":"auto","position":27.0,"command":"# TODO\n\nfrom pyspark.sql.functions import month, col\nrobberiesByMonthLosAngelesDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237955345,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3802fda3-2683-4829-8cb0-e06844fe75a7"},{"version":"CommandV1","origId":1745794912682284,"guid":"6b8f837c-f64f-4e0f-8f20-68e0f56098ac","subtype":"command","commandType":"auto","position":28.0,"command":"# TEST - Run this cell to test your solution.\nfrom pyspark.sql import Row\nla = list(robberiesByMonthLosAngelesDF.collect())\n\ndbTest(\"DF-L7-robberyByMonthLA-counts\", [Row(month=1, robberies=719), Row(month=2, robberies=675), Row(month=3, robberies=709), Row(month=4, robberies=713), Row(month=5, robberies=790), Row(month=6, robberies=698), Row(month=7, robberies=826), Row(month=8, robberies=765), Row(month=9, robberies=722), Row(month=10, robberies=814), Row(month=11, robberies=764), Row(month=12, robberies=853)], la)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237955500,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"68014103-a63d-4096-a71e-4dcbdd21c600"},{"version":"CommandV1","origId":1745794912682285,"guid":"44d71797-cddf-4317-b5b8-fdb78b5824a1","subtype":"command","commandType":"auto","position":29.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237955642,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fe83dda3-5c45-4ca7-91e7-6f3b8d6400fe"},{"version":"CommandV1","origId":1745794912682286,"guid":"9077c632-e7c7-4076-9bf9-356e9eac7e66","subtype":"command","commandType":"auto","position":30.0,"command":"# TODO\n\nrobberiesByMonthPhiladelphiaDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237955813,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b1fda941-ef8c-4724-94e6-05f23ff7c7a1"},{"version":"CommandV1","origId":1745794912682287,"guid":"9bbdb41c-8810-44b0-a959-4ea1877721d3","subtype":"command","commandType":"auto","position":31.0,"command":"# TEST - Run this cell to test your solution.\n# convert to list so that we get deep compare (Array would be a shallow compare)\nphiladelphia  = list(robberiesByMonthPhiladelphiaDF.collect())\n\ndbTest(\"DF-L7-robberyByMonthPA-counts\", [Row(month=1, robberies=520), Row(month=2, robberies=416), Row(month=3, robberies=432), Row(month=4, robberies=466), Row(month=5, robberies=533), Row(month=6, robberies=509), Row(month=7, robberies=537), Row(month=8, robberies=561), Row(month=9, robberies=514), Row(month=10, robberies=572), Row(month=11, robberies=545), Row(month=12, robberies=544)], philadelphia )\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237955978,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"decbf249-9769-4640-974f-15b424b57490"},{"version":"CommandV1","origId":1745794912682288,"guid":"f06e812e-fb53-4ffa-bda4-ccf23752c2f3","subtype":"command","commandType":"auto","position":32.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237956189,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"292c3b31-defb-420c-9002-459c32c9bddb"},{"version":"CommandV1","origId":1745794912682289,"guid":"a89129b8-7b84-4481-824b-86e5761b9773","subtype":"command","commandType":"auto","position":33.0,"command":"# TODO\n\nrobberiesByMonthDallasDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237956357,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"517f9f8a-801d-40a9-b07a-037005ed5cbc"},{"version":"CommandV1","origId":1745794912682290,"guid":"8f2b4259-a747-485e-9e5b-3778bcdee768","subtype":"command","commandType":"auto","position":34.0,"command":"# TEST - Run this cell to test your solution.\n\ndallas  = list(robberiesByMonthDallasDF.collect())\ndbTest(\"DF-L7-robberyByMonthDAL-counts\", [Row(month=1, robberies=743), Row(month=2, robberies=435), Row(month=3, robberies=412), Row(month=4, robberies=594), Row(month=5, robberies=615), Row(month=6, robberies=495), Row(month=7, robberies=535), Row(month=8, robberies=627), Row(month=9, robberies=512), Row(month=10, robberies=603), Row(month=11, robberies=589), Row(month=12, robberies=664)], dallas)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237956540,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"67a24821-3f33-4803-9944-baee63a971a0"},{"version":"CommandV1","origId":1745794912682291,"guid":"a17d38c9-9819-4f5b-84fd-e34e98564948","subtype":"command","commandType":"auto","position":35.0,"command":"%md-sandbox\n\n## Step 4\n\nPlot the robberies per month for each of the three cities, producing a plot similar to the following:\n\n<img src=\"https://files.training.databricks.com/images/eLearning/robberies-by-month.png\" style=\"max-width: 700px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\nWhen you first run the cell, you'll get an HTML table as the result. To configure the plot:\n\n1. Click the graph button.\n2. If the plot doesn't look correct, click the **Plot Options** button.\n3. Configure the plot similar to the following example.\n\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-1.png\" style=\"width: 440px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-2.png\" style=\"width: 268px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-3.png\" style=\"width: 362px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237956756,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"649ac43c-36d6-4cd9-92dd-3b855ec0a5db"},{"version":"CommandV1","origId":1745794912682292,"guid":"b6d3d993-6268-4afd-9cc2-f141f42e469d","subtype":"command","commandType":"auto","position":36.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237956916,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c641dc83-471f-41c5-a3c8-26457c6b5584"},{"version":"CommandV1","origId":1745794912682293,"guid":"be1d61b8-05fb-448b-9c74-77ce0b99d153","subtype":"command","commandType":"auto","position":37.0,"command":"# TODO\n\nFILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237957081,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ec16e794-4808-4568-9a58-514fb9e6c371"},{"version":"CommandV1","origId":1745794912682294,"guid":"b6499210-198f-4bbf-9ca1-4125774334a4","subtype":"command","commandType":"auto","position":38.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237957250,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"433252ea-9052-40d5-ac09-7d340b4ece28"},{"version":"CommandV1","origId":1745794912682295,"guid":"3c789383-b69f-4279-9836-39c39a404f20","subtype":"command","commandType":"auto","position":39.0,"command":"# TODO\n\nFILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237957421,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"863871c2-6729-4767-874c-8a870264608e"},{"version":"CommandV1","origId":1745794912682296,"guid":"dc60ae44-3c6d-41e6-a775-fe1c4a0b8b6e","subtype":"command","commandType":"auto","position":40.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237957573,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"42f8bc6c-592e-444b-8f45-7e92cad97348"},{"version":"CommandV1","origId":1745794912682297,"guid":"352298ac-6aa9-41d8-a6b2-e51b32d40500","subtype":"command","commandType":"auto","position":41.0,"command":"# TODO\n\nFILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237957820,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"885f723f-bf8b-4de6-b25a-1b2b7be1f348"},{"version":"CommandV1","origId":1745794912682298,"guid":"8f7aeeb8-a9e5-4121-b25c-6d46c6fe1b14","subtype":"command","commandType":"auto","position":42.0,"command":"%md-sandbox\n## Step 5\n\nCreate another DataFrame called `combinedRobberiesByMonthDF`, that combines all three robberies-per-month views into one.\nIn creating this view, add a new column called `city`, that identifies the city associated with each row.\nThe final view will have the following columns:\n\n* `city`: The name of the city associated with the row. (Use the strings \"Los Angeles\", \"Philadelphia\", and \"Dallas\".)\n* `month`: The month number associated with the row.\n* `robbery`: The number of robbery in that month (for that city).\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** You may want to apply the `union()` method in this example to combine the three datasets.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** It's easy to add new columns in DataFrames. For example, add a new column called `newColumn` to `originalDF` use `withColumn()` method as follows:\n\n```originalDF.withColumn(\"newColumn\")``` ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237957971,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f06a1f09-705f-4584-b848-32c7842bd490"},{"version":"CommandV1","origId":1745794912682299,"guid":"1c69213e-8b7b-48f1-9fbc-e060ea0b0ff8","subtype":"command","commandType":"auto","position":43.0,"command":"# TODO\n\nfrom pyspark.sql.functions import lit\n\ncombinedRobberiesByMonthDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237958155,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ea667d6c-5615-4e6c-a406-417358b4dbf8"},{"version":"CommandV1","origId":1745794912682300,"guid":"aa4b96f7-9d7f-475e-a81d-100e2e1beba1","subtype":"command","commandType":"auto","position":44.0,"command":"# TEST - Run this cell to test your solution.\n\nresults = [ (r.city, r.month, r.robberies) for r in combinedRobberiesByMonthDF.collect() ]\nexpectedResults =  [ \n(u'Los Angeles', 1, 719), \n(u'Los Angeles', 2, 675), \n(u'Los Angeles', 3, 709), \n(u'Los Angeles', 4, 713),   \n(u'Los Angeles', 5, 790), \n(u'Los Angeles', 6, 698), \n(u'Los Angeles', 7, 826), \n(u'Los Angeles', 8, 765), \n(u'Los Angeles', 9, 722), \n(u'Los Angeles', 10, 814), \n(u'Los Angeles', 11, 764), \n(u'Los Angeles', 12, 853), \n(u'Philadelphia', 1, 520), \n(u'Philadelphia', 2, 416), \n(u'Philadelphia', 3, 432), \n(u'Philadelphia', 4, 466),\n(u'Philadelphia', 5, 533), \n(u'Philadelphia', 6, 509), \n(u'Philadelphia', 7, 537), \n(u'Philadelphia', 8, 561), \n(u'Philadelphia', 9, 514), \n(u'Philadelphia', 10, 572), \n(u'Philadelphia', 11, 545), \n(u'Philadelphia', 12, 544), \n(u'Dallas', 1, 743),\n(u'Dallas', 2, 435), \n(u'Dallas', 3, 412), \n(u'Dallas', 4, 594), \n(u'Dallas', 5, 615), \n(u'Dallas', 6, 495), \n(u'Dallas', 7, 535), \n(u'Dallas', 8, 627), \n(u'Dallas', 9, 512), \n(u'Dallas', 10, 603), \n(u'Dallas', 11, 589), \n(u'Dallas', 12, 664)] \n\ndbTest(\"DF-L7-combinedRobberiesByMonth-counts\", expectedResults, results)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237958301,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5bee05f5-b32a-48ad-a2b5-ef84aae891d3"},{"version":"CommandV1","origId":1745794912682301,"guid":"4184d2ee-cbbc-48bd-9f1d-d6cf0e45bdb6","subtype":"command","commandType":"auto","position":45.0,"command":"combinedRobberiesByMonthDF.select(\"city\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237958475,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"abe15f7e-6557-4da1-b967-1fac99d64d48"},{"version":"CommandV1","origId":1745794912682302,"guid":"5f3de7fc-ac3b-4d52-9978-11e8e5adca92","subtype":"command","commandType":"auto","position":46.0,"command":"%md-sandbox\n## Step 6\n\nGraph the contents of `combinedRobberiesByMonthDF`, producing a graph similar to the following. (The diagram below deliberately\nuses different data.)\n\n<img src=\"https://files.training.databricks.com/images/eLearning/combined-homicides.png\" style=\"width: 800px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\nAdjust the plot options to configure the plot properly, as shown below:\n\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-4.png\" style=\"width: 362px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** Order your results by `month`, then `city`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237958657,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6256c017-24ad-4be2-9042-ed63c67bb9e2"},{"version":"CommandV1","origId":1745794912682303,"guid":"5b88ed9a-0cde-4e25-b607-17f0f8425806","subtype":"command","commandType":"auto","position":47.0,"command":"# TODO\n\nFILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237958815,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"617e10cb-55a4-410d-9a0b-8c83076012c3"},{"version":"CommandV1","origId":1745794912682304,"guid":"51dce87a-92b6-4529-b8b5-c6e45dab3eac","subtype":"command","commandType":"auto","position":48.0,"command":"%md\n## Step 7\n\nWhile the above graph is interesting, it's flawed: it's comparing the raw numbers of robberies, not the per capita robbery rates.\n\nThe DataFrame (already created) called `cityDataDF`  contains, among other data, estimated 2016 population values for all United States cities\nwith populations of at least 100,000. (The data is from [Wikipedia](https://en.wikipedia.org/wiki/List_of_United_States_cities_by_population).)\n\n* Use the population values in that table to normalize the robberies so they represent per-capita values (total robberies divided by population).\n* Save your results in a DataFrame called `robberyRatesByCityDF`.\n* The robbery rate value must be stored in a new column, `robberyRate`.\n\nNext, graph the results, as above.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237958965,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"78555a61-a91a-4aec-9cf2-8b6aa58a25cc"},{"version":"CommandV1","origId":1745794912682305,"guid":"7fb42919-afa1-4dd6-89de-c2499e86bc1b","subtype":"command","commandType":"auto","position":49.0,"command":"# TODO\n\n# rename \"city\" column to \"cities\" to avoid having two similarly named cols; also columns are case-blind\ncityDataDF = spark.read.parquet(\"dbfs:/mnt/training/City-Data.parquet\").withColumnRenamed(\"city\", \"cities\")\n\nrobberyRatesByCityDF = # FILL_IN","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237959154,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6a82ead8-7f16-4da2-9201-3a6cfaff007e"},{"version":"CommandV1","origId":1745794912682306,"guid":"a30b454f-1587-4c83-9997-47427729416c","subtype":"command","commandType":"auto","position":50.0,"command":"# TEST - Run this cell to test your solution.\nresults = [ (r.city, r.month, '{:6f}'.format(r.robberyRate)) for r in robberyRatesByCityDF.orderBy(\"city\", \"month\").collect() ]\nexpectedResults = [\n  (u'Dallas',  1, '0.000564'),\n  (u'Dallas',  2, '0.000330'),\n  (u'Dallas',  3, '0.000313'),\n  (u'Dallas',  4, '0.000451'),\n  (u'Dallas',  5, '0.000467'),\n  (u'Dallas',  6, '0.000376'),\n  (u'Dallas',  7, '0.000406'),\n  (u'Dallas',  8, '0.000476'),\n  (u'Dallas',  9, '0.000388'),\n  (u'Dallas', 10, '0.000458'),\n  (u'Dallas', 11, '0.000447'),\n  (u'Dallas', 12, '0.000504'),\n  (u'Los Angeles',  1, '0.000181'),\n  (u'Los Angeles',  2, '0.000170'),\n  (u'Los Angeles',  3, '0.000178'),\n  (u'Los Angeles',  4, '0.000179'),\n  (u'Los Angeles',  5, '0.000199'),\n  (u'Los Angeles',  6, '0.000176'),\n  (u'Los Angeles',  7, '0.000208'),\n  (u'Los Angeles',  8, '0.000192'),\n  (u'Los Angeles',  9, '0.000182'),\n  (u'Los Angeles', 10, '0.000205'),\n  (u'Los Angeles', 11, '0.000192'),\n  (u'Los Angeles', 12, '0.000215'),\n  (u'Philadelphia',  1, '0.000332'),\n  (u'Philadelphia',  2, '0.000265'),\n  (u'Philadelphia',  3, '0.000276'),\n  (u'Philadelphia',  4, '0.000297'),\n  (u'Philadelphia',  5, '0.000340'),\n  (u'Philadelphia',  6, '0.000325'),\n  (u'Philadelphia',  7, '0.000343'),\n  (u'Philadelphia',  8, '0.000358'),\n  (u'Philadelphia',  9, '0.000328'),\n  (u'Philadelphia', 10, '0.000365'),\n  (u'Philadelphia', 11, '0.000348'),\n  (u'Philadelphia', 12, '0.000347')]\ndbTest(\"DF-L7-roberryRatesByCity-counts\", expectedResults, results)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237959375,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7051f03f-7d14-4f93-8f8a-575278b548af"},{"version":"CommandV1","origId":1745794912682307,"guid":"3494d17e-cb89-4d8c-99a7-238b357b8dc0","subtype":"command","commandType":"auto","position":52.0,"command":"%md\n## References\n\nThe crime data used in this notebook comes from the following locations:\n\n| City          | Original Data \n| ------------- | -------------\n| Boston        | <a href=\"https://data.boston.gov/group/public-safety\" target=\"_blank\">https&#58;//data.boston.gov/group/public-safety</a>\n| Chicago       | <a href=\"https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2\" target=\"_blank\">https&#58;//data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2</a>\n| Dallas        | <a href=\"https://www.dallasopendata.com/Public-Safety/Police-Incidents/tbnj-w5hb/data\" target=\"_blank\">https&#58;//www.dallasopendata.com/Public-Safety/Police-Incidents/tbnj-w5hb/data</a>\n| Los Angeles   | <a href=\"https://data.lacity.org/A-Safe-City/Crime-Data-From-2010-to-Present/y8tr-7khq\" target=\"_blank\">https&#58;//data.lacity.org/A-Safe-City/Crime-Data-From-2010-to-Present/y8tr-7khq</a>\n| New Orleans   | <a href=\"https://data.nola.gov/Public-Safety-and-Preparedness/Electronic-Police-Report-2016/4gc2-25he/data\" target=\"_blank\">https&#58;//data.nola.gov/Public-Safety-and-Preparedness/Electronic-Police-Report-2016/4gc2-25he/data</a>\n| New York      | <a href=\"https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i\" target=\"_blank\">https&#58;//data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i</a>\n| Philadelphia  | <a href=\"https://www.opendataphilly.org/dataset/crime-incidents\" target=\"_blank\">https&#58;//www.opendataphilly.org/dataset/crime-incidents</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542237959549,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d381ec64-f9bb-455c-afa9-8069a3a69465"}],"dashboards":[],"guid":"855bb74d-fa27-43f7-aae9-c84919fe040d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}