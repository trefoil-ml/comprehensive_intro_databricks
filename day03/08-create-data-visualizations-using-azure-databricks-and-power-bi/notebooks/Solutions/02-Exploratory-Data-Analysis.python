{"version":"NotebookV1","origId":1745794912681962,"name":"02-Exploratory-Data-Analysis","language":"python","commands":[{"version":"CommandV1","origId":974699126453874,"guid":"8194df2f-8a05-4598-9e61-42285718484a","subtype":"command","commandType":"auto","position":53.0,"command":"%md\n## Next Steps\n\nStart the next lesson, [Power BI]($./03-Power-BI).","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5b1cd03c-07d8-4640-b7c0-5349772dffc5"},{"version":"CommandV1","origId":1745794912681963,"guid":"05a68a7c-0232-472d-8ec8-fe733ad446b9","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Project: Exploratory Data Analysis\nPerform exploratory data analysis (EDA) to gain insights from a data lake. Visualize the data using the built-in Databricks visualizations.\n\n## Instructions\n\nIn `dbfs:/mnt/training/crime-data-2016`, there are a number of Parquet files containing 2016 crime data from seven United States cities:\n\n* New York\n* Los Angeles\n* Chicago\n* Philadelphia\n* Dallas\n* Boston\n\n\nThe data is cleaned up a little, but has not been normalized. Each city reports crime data slightly differently, so\nexamine the data for each city to determine how to query it properly.\n\nYour job is to use some of this data to gain insights about certain kinds of crimes.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633148060,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dbf7bb2b-69cf-4b52-8988-e15ba877329e"},{"version":"CommandV1","origId":1745794912681964,"guid":"7fa70999-2f2b-41ff-b5b5-b7ba09ad5bf2","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n### Getting Started\n\nRun the following cell to configure our \"classroom.\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633148214,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b4d1f104-4cc2-4f41-901c-3b7cb8a9f765"},{"version":"CommandV1","origId":1745794912681965,"guid":"4d89409f-1cc2-434b-a936-c87e1e3791e5","subtype":"command","commandType":"auto","position":4.0,"command":"%run ./Includes/Classroom-Setup","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1542633148371,"submitTime":1542633148371,"finishTime":1542633176836,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"471fd40e-1cb6-442a-a7fe-adb00bbcbbd5"},{"version":"CommandV1","origId":1745794912681966,"guid":"0190f89e-b9ca-456d-b256-8b0315adacce","subtype":"script","commandType":"auto","position":4.05,"command":"","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"Initialized classroom variables & functions...","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633158421,"submitTime":0,"finishTime":1542633165015,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d27a6b86-bd22-4eb7-9c48-a902b762b171"},{"version":"CommandV1","origId":1745794912681967,"guid":"3d054af7-eb71-40ac-86f4-945fcf66bc2b","subtype":"script","commandType":"auto","position":4.1,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633165037,"submitTime":0,"finishTime":1542633165095,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cc8e19f5-dc8f-4ee0-93d0-80e521152916"},{"version":"CommandV1","origId":1745794912681968,"guid":"fe37abd0-9586-44d2-beb7-1dfd1c8c894f","subtype":"script","commandType":"auto","position":4.15,"command":"","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"Mounted data sets to '/mnt/training' ...","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633165101,"submitTime":0,"finishTime":1542633167881,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d2476e50-98da-4827-8042-c261371e60e4"},{"version":"CommandV1","origId":1745794912681969,"guid":"562cb581-206c-4845-9463-cfca226a55d4","subtype":"script","commandType":"auto","position":4.2,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633167885,"submitTime":0,"finishTime":1542633167896,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6d832717-ecc7-498e-aaf2-001873da3a1a"},{"version":"CommandV1","origId":1745794912681970,"guid":"4a32a7ab-f7ec-4239-b96e-6e6eb0b3d31a","subtype":"script","commandType":"auto","position":4.25,"command":"","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"Imported Test Library...","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633167900,"submitTime":0,"finishTime":1542633168120,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f777d9a9-0fdd-44aa-8ae8-0ca231b15e4b"},{"version":"CommandV1","origId":1745794912681971,"guid":"97ef02ea-fd97-4be3-995e-5d219c414f39","subtype":"script","commandType":"auto","position":4.3,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633168124,"submitTime":0,"finishTime":1542633168135,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a5ed50ec-e68d-4ba7-b3d3-7f0d5ec6c386"},{"version":"CommandV1","origId":1745794912681972,"guid":"e99e9135-a327-4c30-b78a-5f4e1b7e4482","subtype":"script","commandType":"auto","position":4.35,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633168139,"submitTime":0,"finishTime":1542633170359,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d532bbc0-2c00-4e74-a652-c299d031dfcb"},{"version":"CommandV1","origId":1745794912681973,"guid":"13a6c726-46f8-45cb-a6ab-44606827aa47","subtype":"script","commandType":"auto","position":4.4,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633170366,"submitTime":0,"finishTime":1542633170378,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d8a3997b-230b-4c45-abb8-f75c5d5061ea"},{"version":"CommandV1","origId":1745794912681974,"guid":"ba25660d-e5c5-42e2-a49c-f3fcc89391df","subtype":"script","commandType":"auto","position":4.45,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633170382,"submitTime":0,"finishTime":1542633170559,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"149f789d-eb1a-4b71-9cac-7aff32b3df2c"},{"version":"CommandV1","origId":1745794912681975,"guid":"62329861-50b1-4afa-b75e-6a95a85cc9e5","subtype":"script","commandType":"auto","position":4.5,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633170572,"submitTime":0,"finishTime":1542633172085,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c2a6d050-54e4-491b-8577-0f9e9dcf05ce"},{"version":"CommandV1","origId":1745794912681976,"guid":"aa215186-9489-4c5e-a02f-771920a2424f","subtype":"script","commandType":"auto","position":4.55,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633172091,"submitTime":0,"finishTime":1542633172971,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9c16322b-7930-4e77-b2a9-645cee0ad81a"},{"version":"CommandV1","origId":1745794912681977,"guid":"ba873c99-5fa9-4a34-8657-9c25dcc26269","subtype":"script","commandType":"auto","position":4.6,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633172975,"submitTime":0,"finishTime":1542633173432,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9794c77e-ad49-4ac1-a542-783826f7e330"},{"version":"CommandV1","origId":1745794912681978,"guid":"76375cbe-cf46-4b22-9402-9bc38421a023","subtype":"script","commandType":"auto","position":4.65,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633173437,"submitTime":0,"finishTime":1542633174393,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f4e748fe-94bc-4287-9dbe-e7c479532f40"},{"version":"CommandV1","origId":1745794912681979,"guid":"ed0e67fd-8ac6-4103-9957-13c8bbb46284","subtype":"script","commandType":"auto","position":4.7,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633174398,"submitTime":0,"finishTime":1542633174849,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ef9c1281-485f-4f34-a1d1-b5e1f30bdce4"},{"version":"CommandV1","origId":1745794912681980,"guid":"42a34309-cfe2-4be0-82ce-2803aa6a4d99","subtype":"script","commandType":"auto","position":4.75,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633174856,"submitTime":0,"finishTime":1542633175302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ede6f6bf-ea71-4e10-9679-93a5d5166822"},{"version":"CommandV1","origId":1745794912681981,"guid":"3765b5f4-4d69-41a9-b38c-a0eb0f2fbe88","subtype":"script","commandType":"auto","position":4.8,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633175308,"submitTime":0,"finishTime":1542633176258,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"32cd0ba1-31a9-4b0a-a00a-2a95bbb0c0a3"},{"version":"CommandV1","origId":1745794912681982,"guid":"a9329e0b-699b-47c6-a210-1500c24a1a33","subtype":"script","commandType":"auto","position":4.85,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633176263,"submitTime":0,"finishTime":1542633176717,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"08b34821-ef9f-4294-8957-5e7c92dc53f4"},{"version":"CommandV1","origId":1745794912681983,"guid":"4d07df93-4519-4a2b-a2b7-65ebf97ebb4b","subtype":"script","commandType":"auto","position":4.9,"command":"","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"Created Database and Tables...","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633176721,"submitTime":0,"finishTime":1542633176731,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"55a875ac-5eb4-4681-baea-2c6d1e036ca9"},{"version":"CommandV1","origId":1745794912681984,"guid":"1766e4b1-ac77-401c-bdf4-1111fd81e2cf","subtype":"script","commandType":"auto","position":4.95,"command":"","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"All done!","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633176734,"submitTime":0,"finishTime":1542633176749,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["4d89409f-1cc2-434b-a936-c87e1e3791e5"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"895d657c-0dfb-47bd-993b-7c2e0c29a26b"},{"version":"CommandV1","origId":1745794912681985,"guid":"18c1beba-9346-41a8-a6b7-e6991245fd82","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Step 1\n\nStart by creating DataFrames for Los Angeles, Philadelphia, and Dallas data.\n\nUse `spark.read.parquet` to create named DataFrames for the files you choose. \n\nTo read in the parquet file, use `crimeDataNewYorkDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-New-York-2016.parquet\")`\n\n\nUse the following view names:\n\n| City          | DataFrame Name            | Path to DBFS file\n| ------------- | ------------------------- | -----------------\n| Los Angeles   | `crimeDataLosAngelesDF`   | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Los-Angeles-2016.parquet`\n| Philadelphia  | `crimeDataPhiladelphiaDF` | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Philadelphia-2016.parquet`\n| Dallas        | `crimeDataDallasDF`       | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Dallas-2016.parquet`","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633148987,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e204d35c-b775-4f56-bf37-532a08343e34"},{"version":"CommandV1","origId":1745794912681986,"guid":"a66b12cc-bbf1-4e6a-8206-bf5a1315c7e7","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633149172,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c33db65f-f52a-4cfa-8862-d9d045c482cb"},{"version":"CommandV1","origId":1745794912681987,"guid":"77098163-428c-4687-b7bf-84473f1ea10f","subtype":"command","commandType":"auto","position":7.0,"command":"# ANSWER\ncrimeDataLosAngelesDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-Los-Angeles-2016.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"crimeDataLosAngelesDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"dateReported","nullable":true,"type":"timestamp"},{"metadata":{},"name":"dateOccurred","nullable":true,"type":"timestamp"},{"metadata":{},"name":"timeOccurred","nullable":true,"type":"timestamp"},{"metadata":{},"name":"areaID","nullable":true,"type":"integer"},{"metadata":{},"name":"areaName","nullable":true,"type":"string"},{"metadata":{},"name":"reportingDistrict","nullable":true,"type":"integer"},{"metadata":{},"name":"crimeCode","nullable":true,"type":"integer"},{"metadata":{},"name":"crimeCodeDescription","nullable":true,"type":"string"},{"metadata":{},"name":"victimAge","nullable":true,"type":"integer"},{"metadata":{},"name":"victimSex","nullable":true,"type":"string"},{"metadata":{},"name":"victimDescent","nullable":true,"type":"string"},{"metadata":{},"name":"premiseCode","nullable":true,"type":"integer"},{"metadata":{},"name":"premiseDescription","nullable":true,"type":"string"},{"metadata":{},"name":"weaponUsed","nullable":true,"type":"string"},{"metadata":{},"name":"status","nullable":true,"type":"string"},{"metadata":{},"name":"address","nullable":true,"type":"string"},{"metadata":{},"name":"locationLatitude","nullable":true,"type":"decimal(38,18)"},{"metadata":{},"name":"locationLongitude","nullable":true,"type":"decimal(38,18)"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633176754,"submitTime":1542633149338,"finishTime":1542633185543,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"46480c32-41cd-4930-8523-0fc0e294dc32"},{"version":"CommandV1","origId":1745794912681988,"guid":"046837b5-c3d5-4f84-9a6a-5a381f09436c","subtype":"command","commandType":"auto","position":8.0,"command":"# TEST - Run this cell to test your solution.\n\nrowsLosAngeles  = crimeDataLosAngelesDF.count()\ndbTest(\"DF-L7-crimeDataLA-count\", rowsLosAngeles, 217945)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633185560,"submitTime":1542633149553,"finishTime":1542633201990,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ebd02458-2122-4ead-9829-0f1a4f5b72af"},{"version":"CommandV1","origId":1745794912681989,"guid":"e93949e1-8b26-46dc-ae4f-a9702c42cf54","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633149699,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5e9b5163-0b93-4925-8385-d8eab86d6bfb"},{"version":"CommandV1","origId":1745794912681990,"guid":"50ee4fa2-b328-4e96-87cb-a27afadb2917","subtype":"command","commandType":"auto","position":10.0,"command":"# ANSWER\n\ncrimeDataPhiladelphiaDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-Philadelphia-2016.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"crimeDataPhiladelphiaDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"district","nullable":true,"type":"integer"},{"metadata":{},"name":"dispatch_date_time","nullable":true,"type":"timestamp"},{"metadata":{},"name":"dispatch_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"dispatch_time","nullable":true,"type":"string"},{"metadata":{},"name":"hour","nullable":true,"type":"integer"},{"metadata":{},"name":"unique_id","nullable":true,"type":"long"},{"metadata":{},"name":"location_block","nullable":true,"type":"string"},{"metadata":{},"name":"ucr_general","nullable":true,"type":"integer"},{"metadata":{},"name":"text_general_code","nullable":true,"type":"string"},{"metadata":{},"name":"point_x","nullable":true,"type":"double"},{"metadata":{},"name":"point_y","nullable":true,"type":"double"},{"metadata":{},"name":"lat","nullable":true,"type":"double"},{"metadata":{},"name":"lng","nullable":true,"type":"double"},{"metadata":{},"name":"ucr_general_description","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633201995,"submitTime":1542633149884,"finishTime":1542633205721,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fce4ae57-3164-4cb1-996a-33143f4be44e"},{"version":"CommandV1","origId":1745794912681991,"guid":"4b44cfa2-3e4b-4686-a200-8753bd7057ff","subtype":"command","commandType":"auto","position":11.0,"command":"# TEST - Run this cell to test your solution.\n\nrowsPhiladelphia  = crimeDataPhiladelphiaDF.count()\ndbTest(\"DF-L7-crimeDataPA-count\", rowsPhiladelphia, 168664)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633205725,"submitTime":1542633150039,"finishTime":1542633230409,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dfde8d5a-e588-4f9c-b20c-f08ddc71de4e"},{"version":"CommandV1","origId":1745794912681992,"guid":"86af7043-19e4-4845-81fd-8b850d7ad93e","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633150188,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"75055a9a-43ca-42ee-a698-d366c4520e7e"},{"version":"CommandV1","origId":1745794912681993,"guid":"f94e8c3f-52c4-4689-bd1e-fb96759761b5","subtype":"command","commandType":"auto","position":13.0,"command":"# ANSWER\n\ncrimeDataDallasDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-Dallas-2016.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"crimeDataDallasDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"incidentNumberWithYear","nullable":true,"type":"string"},{"metadata":{},"name":"incidentNumberWithoutYear","nullable":true,"type":"integer"},{"metadata":{},"name":"offenseServiceNumber","nullable":true,"type":"string"},{"metadata":{},"name":"serviceNumberID","nullable":true,"type":"string"},{"metadata":{},"name":"watch","nullable":true,"type":"string"},{"metadata":{},"name":"call911Problem","nullable":true,"type":"string"},{"metadata":{},"name":"typeOfIncident","nullable":true,"type":"string"},{"metadata":{},"name":"penaltyClass","nullable":true,"type":"string"},{"metadata":{},"name":"typeOfLocation","nullable":true,"type":"string"},{"metadata":{},"name":"typeOfProperty","nullable":true,"type":"string"},{"metadata":{},"name":"streetBlock","nullable":true,"type":"integer"},{"metadata":{},"name":"streetDirection","nullable":true,"type":"string"},{"metadata":{},"name":"streetName","nullable":true,"type":"string"},{"metadata":{},"name":"incidentAddress","nullable":true,"type":"string"},{"metadata":{},"name":"apartmentNumber","nullable":true,"type":"string"},{"metadata":{},"name":"zipCode","nullable":true,"type":"integer"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"state","nullable":true,"type":"string"},{"metadata":{},"name":"XCoordinate","nullable":true,"type":"double"},{"metadata":{},"name":"YCoordinate","nullable":true,"type":"double"},{"metadata":{},"name":"reportingArea","nullable":true,"type":"integer"},{"metadata":{},"name":"beat","nullable":true,"type":"integer"},{"metadata":{},"name":"division","nullable":true,"type":"string"},{"metadata":{},"name":"sector","nullable":true,"type":"integer"},{"metadata":{},"name":"councilDistrict","nullable":true,"type":"integer"},{"metadata":{},"name":"targetAreaActionGrids","nullable":true,"type":"string"},{"metadata":{},"name":"community","nullable":true,"type":"string"},{"metadata":{},"name":"callReceivedDateTime","nullable":true,"type":"string"},{"metadata":{},"name":"callDateTime","nullable":true,"type":"string"},{"metadata":{},"name":"personInvolvementType","nullable":true,"type":"string"},{"metadata":{},"name":"complainantName","nullable":true,"type":"string"},{"metadata":{},"name":"complainantRace","nullable":true,"type":"string"},{"metadata":{},"name":"complainantGender","nullable":true,"type":"string"},{"metadata":{},"name":"complainantAge","nullable":true,"type":"string"},{"metadata":{},"name":"complainantAgeAtOffense","nullable":true,"type":"integer"},{"metadata":{},"name":"complainantHomeAddress","nullable":true,"type":"string"},{"metadata":{},"name":"complainantApartment","nullable":true,"type":"string"},{"metadata":{},"name":"complainantZipCode","nullable":true,"type":"integer"},{"metadata":{},"name":"complainantCity","nullable":true,"type":"string"},{"metadata":{},"name":"complainantState","nullable":true,"type":"string"},{"metadata":{},"name":"complainantBusinessName","nullable":true,"type":"string"},{"metadata":{},"name":"complainantBusinessAddress","nullable":true,"type":"string"},{"metadata":{},"name":"yearAssignment","nullable":true,"type":"string"},{"metadata":{},"name":"weather","nullable":true,"type":"string"},{"metadata":{},"name":"respondingOfficer1BadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"respondingOfficer1Name","nullable":true,"type":"string"},{"metadata":{},"name":"respondingOfficer2BadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"respondingOfficer2Name","nullable":true,"type":"string"},{"metadata":{},"name":"reportingOfficerBadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"assistingOfficerBadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"reviewingOfficerBadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"elementNumberAssigned","nullable":true,"type":"string"},{"metadata":{},"name":"investigatingUnit1","nullable":true,"type":"string"},{"metadata":{},"name":"investigatingUnit2","nullable":true,"type":"string"},{"metadata":{},"name":"offenseStatus","nullable":true,"type":"string"},{"metadata":{},"name":"ucrDisposition","nullable":true,"type":"string"},{"metadata":{},"name":"victimInjuryDescription","nullable":true,"type":"string"},{"metadata":{},"name":"victimCondition","nullable":true,"type":"string"},{"metadata":{},"name":"ucr1","nullable":true,"type":"string"},{"metadata":{},"name":"finalUCR","nullable":true,"type":"integer"},{"metadata":{},"name":"rmsCode","nullable":true,"type":"string"},{"metadata":{},"name":"offenseCodeCC","nullable":true,"type":"string"},{"metadata":{},"name":"cjisCode","nullable":true,"type":"string"},{"metadata":{},"name":"penalCode","nullable":true,"type":"string"},{"metadata":{},"name":"ucrOffenseName","nullable":true,"type":"string"},{"metadata":{},"name":"ucrOffenseDescription","nullable":true,"type":"string"},{"metadata":{},"name":"offenseType","nullable":true,"type":"string"},{"metadata":{},"name":"modusOperandiMO","nullable":true,"type":"string"},{"metadata":{},"name":"familyOffense","nullable":true,"type":"string"},{"metadata":{},"name":"hateCrime","nullable":true,"type":"string"},{"metadata":{},"name":"gangRelatedOffense","nullable":true,"type":"string"},{"metadata":{},"name":"victimPackage","nullable":true,"type":"string"},{"metadata":{},"name":"drugRelatedIncident","nullable":true,"type":"string"},{"metadata":{},"name":"location1","nullable":true,"type":"string"},{"metadata":{},"name":"startingDateTime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"endingDateTime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"dateOfReport","nullable":true,"type":"timestamp"},{"metadata":{},"name":"callDispatchDateTime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"callClearedDateTime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"offenseEnteredDateTime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633230413,"submitTime":1542633150383,"finishTime":1542633232837,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ed35b7d8-e929-456e-8db5-a9ada3845a2d"},{"version":"CommandV1","origId":1745794912681994,"guid":"ea60eff0-c40c-4f51-ac00-6df4e5f4108e","subtype":"command","commandType":"auto","position":14.0,"command":"# TEST - Run this cell to test your solution.\n\nrowsDallas  = crimeDataDallasDF.count()\ndbTest(\"DF-L7-crimeDataDAL-count\", 99642, rowsDallas)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633232844,"submitTime":1542633150916,"finishTime":1542633234269,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5328f357-f467-4d8d-aa4f-dea55aa3d226"},{"version":"CommandV1","origId":1745794912681995,"guid":"97f9d6fa-ccf9-4323-a1df-e8f5f3c22084","subtype":"command","commandType":"auto","position":15.0,"command":"%md-sandbox\n## Step 2\n\nFor each table, examine the data to figure out how to extract _robbery_ statistics.\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> Each city uses different values to indicate robbery. Commonly used terminology is \"larceny\", \"burglary\" or \"robbery.\"  These challenges are common in Data Lakes.  Restrict yourself to only robberies.\n\nExplore the data for the three cities until you understand how each city records robbery information. If you don't want to worry about upper- or lower-case, \nremember to use the DataFrame `lower()` method to converts column values to lowercase.\n\nCreate a DataFrame containing only the robbery-related rows, as shown in the table below.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** For each table, focus your efforts on the column listed below.\n\nFocus on the following columns for each table:\n\n| DataFrame Name            | Robbery DataFrame Name  | Column\n| ------------------------- | ----------------------- | -------------------------------\n| `crimeDataLosAngelesDF`   | `robberyLosAngelesDF`   | `crimeCodeDescription`\n| `crimeDataPhiladelphiaDF` | `robberyPhiladelphiaDF` | `ucr_general_description`\n| `crimeDataDallasDF`       | `robberyDallasDF`       | `typeOfIncident`","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633151126,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6d0e56fd-09ee-4a85-b86a-23d8222d86c5"},{"version":"CommandV1","origId":1745794912681996,"guid":"82ca296f-fe31-41bd-8c81-e92c6d87bcac","subtype":"command","commandType":"auto","position":16.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633151280,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"265fedc5-c3c5-4549-8f3f-5367ba23435d"},{"version":"CommandV1","origId":1745794912681997,"guid":"233157b0-f41d-4888-97d0-0feebc9a8d14","subtype":"command","commandType":"auto","position":17.0,"command":"# ANSWER\nfrom pyspark.sql.functions import col, lower\nrobberyLosAngelesDF = crimeDataLosAngelesDF.filter(lower(col(\"crimeCodeDescription\")) == \"robbery\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"robberyLosAngelesDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"dateReported","nullable":true,"type":"timestamp"},{"metadata":{},"name":"dateOccurred","nullable":true,"type":"timestamp"},{"metadata":{},"name":"timeOccurred","nullable":true,"type":"timestamp"},{"metadata":{},"name":"areaID","nullable":true,"type":"integer"},{"metadata":{},"name":"areaName","nullable":true,"type":"string"},{"metadata":{},"name":"reportingDistrict","nullable":true,"type":"integer"},{"metadata":{},"name":"crimeCode","nullable":true,"type":"integer"},{"metadata":{},"name":"crimeCodeDescription","nullable":true,"type":"string"},{"metadata":{},"name":"victimAge","nullable":true,"type":"integer"},{"metadata":{},"name":"victimSex","nullable":true,"type":"string"},{"metadata":{},"name":"victimDescent","nullable":true,"type":"string"},{"metadata":{},"name":"premiseCode","nullable":true,"type":"integer"},{"metadata":{},"name":"premiseDescription","nullable":true,"type":"string"},{"metadata":{},"name":"weaponUsed","nullable":true,"type":"string"},{"metadata":{},"name":"status","nullable":true,"type":"string"},{"metadata":{},"name":"address","nullable":true,"type":"string"},{"metadata":{},"name":"locationLatitude","nullable":true,"type":"decimal(38,18)"},{"metadata":{},"name":"locationLongitude","nullable":true,"type":"decimal(38,18)"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633234274,"submitTime":1542633151553,"finishTime":1542633234617,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"02ef85b9-f369-4bda-ad99-4b6f2a7167d7"},{"version":"CommandV1","origId":1745794912681998,"guid":"f96057a9-cd20-42bf-ae5c-e32b54c30652","subtype":"command","commandType":"auto","position":18.0,"command":"# TEST - Run this cell to test your solution.\n\ntotalLosAngeles  = robberyLosAngelesDF.count()\ndbTest(\"DF-L7-robberyDataLA-count\", 9048, totalLosAngeles)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633234622,"submitTime":1542633151707,"finishTime":1542633236840,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c1aa20c1-7bc6-4db3-8f14-981e67d37d16"},{"version":"CommandV1","origId":1745794912681999,"guid":"a193a192-50ec-4f85-9d5f-647a6b6c0263","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633151854,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bc600847-d494-47e8-a0c7-17a80fc666ad"},{"version":"CommandV1","origId":1745794912682000,"guid":"eab50436-4d97-42b4-8f88-344f9d9fe66f","subtype":"command","commandType":"auto","position":20.0,"command":"# ANSWER\nrobberyPhiladelphiaDF  = crimeDataPhiladelphiaDF.filter(lower(col(\"ucr_general_description\")) == \"robbery\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"robberyPhiladelphiaDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"district","nullable":true,"type":"integer"},{"metadata":{},"name":"dispatch_date_time","nullable":true,"type":"timestamp"},{"metadata":{},"name":"dispatch_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"dispatch_time","nullable":true,"type":"string"},{"metadata":{},"name":"hour","nullable":true,"type":"integer"},{"metadata":{},"name":"unique_id","nullable":true,"type":"long"},{"metadata":{},"name":"location_block","nullable":true,"type":"string"},{"metadata":{},"name":"ucr_general","nullable":true,"type":"integer"},{"metadata":{},"name":"text_general_code","nullable":true,"type":"string"},{"metadata":{},"name":"point_x","nullable":true,"type":"double"},{"metadata":{},"name":"point_y","nullable":true,"type":"double"},{"metadata":{},"name":"lat","nullable":true,"type":"double"},{"metadata":{},"name":"lng","nullable":true,"type":"double"},{"metadata":{},"name":"ucr_general_description","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633236846,"submitTime":1542633152023,"finishTime":1542633236877,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e8be62d5-5d9f-4b98-bb69-f8281ff6cab0"},{"version":"CommandV1","origId":1745794912682001,"guid":"ec0f86f1-c2ce-4091-837c-11c6b70ce94f","subtype":"command","commandType":"auto","position":21.0,"command":"# TEST - Run this cell to test your solution.\n\ntotalPhiladelphia  = robberyPhiladelphiaDF.count()\ndbTest(\"DF-L7-robberyDataPA-count\", 6149, totalPhiladelphia)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633236883,"submitTime":1542633152180,"finishTime":1542633264166,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6fb8c029-599f-4762-b7f8-62f0c32a6af3"},{"version":"CommandV1","origId":1745794912682002,"guid":"3217cf80-dbd2-468d-806b-b69cb6923c42","subtype":"command","commandType":"auto","position":22.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633152328,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"85e53f3f-c7c6-47b9-9fed-eb4cd797af40"},{"version":"CommandV1","origId":1745794912682003,"guid":"4b5ed25f-2e90-4af3-b9a9-53baf817d72b","subtype":"command","commandType":"auto","position":23.0,"command":"# ANSWER\nrobberyDallasDF  = crimeDataDallasDF.filter(lower(col(\"typeOfIncident\")).startswith(\"robbery\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"robberyDallasDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"incidentNumberWithYear","nullable":true,"type":"string"},{"metadata":{},"name":"incidentNumberWithoutYear","nullable":true,"type":"integer"},{"metadata":{},"name":"offenseServiceNumber","nullable":true,"type":"string"},{"metadata":{},"name":"serviceNumberID","nullable":true,"type":"string"},{"metadata":{},"name":"watch","nullable":true,"type":"string"},{"metadata":{},"name":"call911Problem","nullable":true,"type":"string"},{"metadata":{},"name":"typeOfIncident","nullable":true,"type":"string"},{"metadata":{},"name":"penaltyClass","nullable":true,"type":"string"},{"metadata":{},"name":"typeOfLocation","nullable":true,"type":"string"},{"metadata":{},"name":"typeOfProperty","nullable":true,"type":"string"},{"metadata":{},"name":"streetBlock","nullable":true,"type":"integer"},{"metadata":{},"name":"streetDirection","nullable":true,"type":"string"},{"metadata":{},"name":"streetName","nullable":true,"type":"string"},{"metadata":{},"name":"incidentAddress","nullable":true,"type":"string"},{"metadata":{},"name":"apartmentNumber","nullable":true,"type":"string"},{"metadata":{},"name":"zipCode","nullable":true,"type":"integer"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"state","nullable":true,"type":"string"},{"metadata":{},"name":"XCoordinate","nullable":true,"type":"double"},{"metadata":{},"name":"YCoordinate","nullable":true,"type":"double"},{"metadata":{},"name":"reportingArea","nullable":true,"type":"integer"},{"metadata":{},"name":"beat","nullable":true,"type":"integer"},{"metadata":{},"name":"division","nullable":true,"type":"string"},{"metadata":{},"name":"sector","nullable":true,"type":"integer"},{"metadata":{},"name":"councilDistrict","nullable":true,"type":"integer"},{"metadata":{},"name":"targetAreaActionGrids","nullable":true,"type":"string"},{"metadata":{},"name":"community","nullable":true,"type":"string"},{"metadata":{},"name":"callReceivedDateTime","nullable":true,"type":"string"},{"metadata":{},"name":"callDateTime","nullable":true,"type":"string"},{"metadata":{},"name":"personInvolvementType","nullable":true,"type":"string"},{"metadata":{},"name":"complainantName","nullable":true,"type":"string"},{"metadata":{},"name":"complainantRace","nullable":true,"type":"string"},{"metadata":{},"name":"complainantGender","nullable":true,"type":"string"},{"metadata":{},"name":"complainantAge","nullable":true,"type":"string"},{"metadata":{},"name":"complainantAgeAtOffense","nullable":true,"type":"integer"},{"metadata":{},"name":"complainantHomeAddress","nullable":true,"type":"string"},{"metadata":{},"name":"complainantApartment","nullable":true,"type":"string"},{"metadata":{},"name":"complainantZipCode","nullable":true,"type":"integer"},{"metadata":{},"name":"complainantCity","nullable":true,"type":"string"},{"metadata":{},"name":"complainantState","nullable":true,"type":"string"},{"metadata":{},"name":"complainantBusinessName","nullable":true,"type":"string"},{"metadata":{},"name":"complainantBusinessAddress","nullable":true,"type":"string"},{"metadata":{},"name":"yearAssignment","nullable":true,"type":"string"},{"metadata":{},"name":"weather","nullable":true,"type":"string"},{"metadata":{},"name":"respondingOfficer1BadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"respondingOfficer1Name","nullable":true,"type":"string"},{"metadata":{},"name":"respondingOfficer2BadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"respondingOfficer2Name","nullable":true,"type":"string"},{"metadata":{},"name":"reportingOfficerBadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"assistingOfficerBadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"reviewingOfficerBadgeNo","nullable":true,"type":"string"},{"metadata":{},"name":"elementNumberAssigned","nullable":true,"type":"string"},{"metadata":{},"name":"investigatingUnit1","nullable":true,"type":"string"},{"metadata":{},"name":"investigatingUnit2","nullable":true,"type":"string"},{"metadata":{},"name":"offenseStatus","nullable":true,"type":"string"},{"metadata":{},"name":"ucrDisposition","nullable":true,"type":"string"},{"metadata":{},"name":"victimInjuryDescription","nullable":true,"type":"string"},{"metadata":{},"name":"victimCondition","nullable":true,"type":"string"},{"metadata":{},"name":"ucr1","nullable":true,"type":"string"},{"metadata":{},"name":"finalUCR","nullable":true,"type":"integer"},{"metadata":{},"name":"rmsCode","nullable":true,"type":"string"},{"metadata":{},"name":"offenseCodeCC","nullable":true,"type":"string"},{"metadata":{},"name":"cjisCode","nullable":true,"type":"string"},{"metadata":{},"name":"penalCode","nullable":true,"type":"string"},{"metadata":{},"name":"ucrOffenseName","nullable":true,"type":"string"},{"metadata":{},"name":"ucrOffenseDescription","nullable":true,"type":"string"},{"metadata":{},"name":"offenseType","nullable":true,"type":"string"},{"metadata":{},"name":"modusOperandiMO","nullable":true,"type":"string"},{"metadata":{},"name":"familyOffense","nullable":true,"type":"string"},{"metadata":{},"name":"hateCrime","nullable":true,"type":"string"},{"metadata":{},"name":"gangRelatedOffense","nullable":true,"type":"string"},{"metadata":{},"name":"victimPackage","nullable":true,"type":"string"},{"metadata":{},"name":"drugRelatedIncident","nullable":true,"type":"string"},{"metadata":{},"name":"location1","nullable":true,"type":"string"},{"metadata":{},"name":"startingDateTime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"endingDateTime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"dateOfReport","nullable":true,"type":"timestamp"},{"metadata":{},"name":"callDispatchDateTime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"callClearedDateTime","nullable":true,"type":"timestamp"},{"metadata":{},"name":"offenseEnteredDateTime","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633264170,"submitTime":1542633152485,"finishTime":1542633264310,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b16d3c5e-9a20-4edc-8ffb-f724440ae7b4"},{"version":"CommandV1","origId":1745794912682004,"guid":"7d2ab8d9-b30c-421a-a786-26265dc23684","subtype":"command","commandType":"auto","position":24.0,"command":"# TEST - Run this cell to test your solution.\n\ntotalDallas = robberyDallasDF.count()\ndbTest(\"DF-L7-robberyDataDAL-count\", 6824, totalDallas)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633264315,"submitTime":1542633152656,"finishTime":1542633266329,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"be8e608f-02d3-4c80-abba-0d0c2dfad22e"},{"version":"CommandV1","origId":1745794912682005,"guid":"5177cc33-df5b-4d12-8cfe-93a2faa5d205","subtype":"command","commandType":"auto","position":25.0,"command":"%md-sandbox\n## Step 3\n\nNow that you have DataFrames of only the robberies in each city, create DataFrames for each city summarizing the number of robberies in each month.\n\nYour DataFrames must contain two columns:\n* `month`: The month number (e.g., 1 for January, 2 for February, etc.).\n* `robberies`: The total number of robberies in the month.\n\nUse the following DataFrame names and date columns:\n\n\n| City          | DataFrame Name     | Date Column \n| ------------- | ------------- | -------------\n| Los Angeles   | `robberiesByMonthLosAngelesDF` | `timeOccurred`\n| Philadelphia  | `robberiesByMonthPhiladelphiaDF` | `dispatch_date_time`\n| Dallas        | `robberiesByMonthDallasDF` | `startingDateTime`\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> For each city, figure out which column contains the date of the incident. Then, extract the month from that date.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633152801,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"83f735b8-12c9-4edb-acde-ba7c1ec24650"},{"version":"CommandV1","origId":1745794912682006,"guid":"ca6e0aa6-7dad-45a6-9098-b8ddcffa21e7","subtype":"command","commandType":"auto","position":26.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633152970,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"772a8ea5-6f3f-41ff-8d48-9fd9fa5b16c2"},{"version":"CommandV1","origId":1745794912682007,"guid":"a0120379-d1b0-4a8d-a054-d958c6a11860","subtype":"command","commandType":"auto","position":27.0,"command":"# ANSWER\nfrom pyspark.sql.functions import month, col\nrobberiesByMonthLosAngelesDF = (robberyLosAngelesDF \n  .select(month(col(\"timeOccurred\")).alias(\"month\")) \n  .groupBy(\"month\") \n  .count().withColumnRenamed(\"count\", \"robberies\") \n  .orderBy(\"month\")\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"robberiesByMonthLosAngelesDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"month","nullable":true,"type":"integer"},{"metadata":{},"name":"robberies","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633266334,"submitTime":1542633153131,"finishTime":1542633266439,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1e03417b-e4f1-46a6-8ae3-acdedeb6f70d"},{"version":"CommandV1","origId":1745794912682008,"guid":"3c1b31a4-433e-40bd-9294-747f86e7a9e2","subtype":"command","commandType":"auto","position":28.0,"command":"# TEST - Run this cell to test your solution.\nfrom pyspark.sql import Row\nla = list(robberiesByMonthLosAngelesDF.collect())\n\ndbTest(\"DF-L7-robberyByMonthLA-counts\", [Row(month=1, robberies=719), Row(month=2, robberies=675), Row(month=3, robberies=709), Row(month=4, robberies=713), Row(month=5, robberies=790), Row(month=6, robberies=698), Row(month=7, robberies=826), Row(month=8, robberies=765), Row(month=9, robberies=722), Row(month=10, robberies=814), Row(month=11, robberies=764), Row(month=12, robberies=853)], la)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633266444,"submitTime":1542633153319,"finishTime":1542633274125,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f4274967-ec2c-4b4f-93d1-8896ab3dd990"},{"version":"CommandV1","origId":1745794912682009,"guid":"6c5319de-b3e3-4156-86d7-2d12ae8e7b56","subtype":"command","commandType":"auto","position":29.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633153613,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3b7db1f4-09ee-4777-ab9d-4cfe9cbac96f"},{"version":"CommandV1","origId":1745794912682010,"guid":"3e30c118-b9d9-4270-8b00-526beb10b6e9","subtype":"command","commandType":"auto","position":30.0,"command":"# ANSWER\nrobberiesByMonthPhiladelphiaDF = (robberyPhiladelphiaDF \n  .select(month(robberyPhiladelphiaDF[\"dispatch_date_time\"]).alias(\"month\")) \n  .groupBy(\"month\") \n  .count().withColumnRenamed(\"count\", \"robberies\") \n  .orderBy(\"month\")\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"robberiesByMonthPhiladelphiaDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"month","nullable":true,"type":"integer"},{"metadata":{},"name":"robberies","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633279608,"submitTime":1542633153771,"finishTime":1542633279655,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a5763e0b-61b2-4b93-ad28-d854c5316d9e"},{"version":"CommandV1","origId":1745794912682011,"guid":"1baa9615-a0e3-4706-b911-aa8bb5c40036","subtype":"command","commandType":"auto","position":31.0,"command":"# TEST - Run this cell to test your solution.\n# convert to list so that we get deep compare (Array would be a shallow compare)\nphiladelphia  = list(robberiesByMonthPhiladelphiaDF.collect())\n\ndbTest(\"DF-L7-robberyByMonthPA-counts\", [Row(month=1, robberies=520), Row(month=2, robberies=416), Row(month=3, robberies=432), Row(month=4, robberies=466), Row(month=5, robberies=533), Row(month=6, robberies=509), Row(month=7, robberies=537), Row(month=8, robberies=561), Row(month=9, robberies=514), Row(month=10, robberies=572), Row(month=11, robberies=545), Row(month=12, robberies=544)], philadelphia )\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633279661,"submitTime":1542633153948,"finishTime":1542633307692,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6888b921-6426-4317-9a20-e2244a8a3a96"},{"version":"CommandV1","origId":1745794912682012,"guid":"eb856ecb-187b-47e0-9f60-70bc216c6818","subtype":"command","commandType":"auto","position":32.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633154273,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b743d574-dd7d-4613-b8df-623a0e20db27"},{"version":"CommandV1","origId":1745794912682013,"guid":"25e7e585-557b-4ee5-96f0-e328efe4dd87","subtype":"command","commandType":"auto","position":33.0,"command":"# ANSWER\nrobberiesByMonthDallasDF = (robberyDallasDF \n  .select(month(robberyDallasDF[\"startingDateTime\"]).alias(\"month\")) \n  .groupBy(\"month\") \n  .count().withColumnRenamed(\"count\", \"robberies\") \n  .orderBy(\"month\")\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"robberiesByMonthDallasDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"month","nullable":true,"type":"integer"},{"metadata":{},"name":"robberies","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633337312,"submitTime":1542633154445,"finishTime":1542633337362,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9f49e201-b232-4049-8919-b7b7152629e6"},{"version":"CommandV1","origId":1745794912682014,"guid":"2f3e474a-7cd7-49ba-ba2b-676e4fb99ff5","subtype":"command","commandType":"auto","position":34.0,"command":"# TEST - Run this cell to test your solution.\n\ndallas  = list(robberiesByMonthDallasDF.collect())\ndbTest(\"DF-L7-robberyByMonthDAL-counts\", [Row(month=1, robberies=743), Row(month=2, robberies=435), Row(month=3, robberies=412), Row(month=4, robberies=594), Row(month=5, robberies=615), Row(month=6, robberies=495), Row(month=7, robberies=535), Row(month=8, robberies=627), Row(month=9, robberies=512), Row(month=10, robberies=603), Row(month=11, robberies=589), Row(month=12, robberies=664)], dallas)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633337367,"submitTime":1542633154594,"finishTime":1542633340288,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"acd0c0c3-5209-492b-80a4-acc377c60b4f"},{"version":"CommandV1","origId":1745794912682015,"guid":"cdeb7005-91db-44e7-a4c5-cd14faf99580","subtype":"command","commandType":"auto","position":35.0,"command":"%md-sandbox\n\n## Step 4\n\nPlot the robberies per month for each of the three cities, producing a plot similar to the following:\n\n<img src=\"https://files.training.databricks.com/images/eLearning/robberies-by-month.png\" style=\"max-width: 700px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\nWhen you first run the cell, you'll get an HTML table as the result. To configure the plot:\n\n1. Click the graph button.\n2. If the plot doesn't look correct, click the **Plot Options** button.\n3. Configure the plot similar to the following example.\n\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-1.png\" style=\"width: 440px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-2.png\" style=\"width: 268px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-3.png\" style=\"width: 362px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633154913,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c08baee3-c007-4e12-9a5d-1a51cf0ac0fd"},{"version":"CommandV1","origId":1745794912682016,"guid":"1d6bd3e1-24c5-4aaa-ac34-59ee19e3bf03","subtype":"command","commandType":"auto","position":36.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633155079,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"334ad130-3a6f-4907-bb25-afeade61dfde"},{"version":"CommandV1","origId":1745794912682017,"guid":"0f6a95c7-0f1d-4bf7-899a-c0708f84d6a1","subtype":"command","commandType":"auto","position":37.0,"command":"# ANSWER\ndisplay(robberiesByMonthLosAngelesDF.orderBy(\"month\"))","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633155244,"submitTime":1542633155244,"finishTime":1542633340642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e545cec4-2e32-4e85-a7b7-ce6551f1c063"},{"version":"CommandV1","origId":1745794912682018,"guid":"92a1c5f1-7e4d-439a-a913-5a4da7058e58","subtype":"command","commandType":"auto","position":38.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633155406,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"930ba70b-862c-409b-b542-f3a01be06eb8"},{"version":"CommandV1","origId":1745794912682019,"guid":"f71d578a-c2a6-4571-9c0e-85e2e61ff63a","subtype":"command","commandType":"auto","position":39.0,"command":"# ANSWER\ndisplay(robberiesByMonthPhiladelphiaDF.orderBy(\"month\"))","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633155561,"submitTime":1542633155561,"finishTime":1542633340645,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"af19caff-0a66-44cf-abcb-b0372123efb8"},{"version":"CommandV1","origId":1745794912682020,"guid":"12673b08-2e47-40f1-a5f4-ca2af5300999","subtype":"command","commandType":"auto","position":40.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633155736,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"54d30f61-107f-40d5-aff4-6b3efc69f219"},{"version":"CommandV1","origId":1745794912682021,"guid":"c43f15e8-1731-45f9-8437-8e387e756cdf","subtype":"command","commandType":"auto","position":41.0,"command":"# ANSWER\ndisplay(robberiesByMonthDallasDF.orderBy(\"month\"))","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633155897,"submitTime":1542633155897,"finishTime":1542633340647,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6981bbd9-b0c4-4c33-a6f8-2f36687e29fd"},{"version":"CommandV1","origId":1745794912682022,"guid":"1925c08c-aef6-4775-8229-ed2039ee9474","subtype":"command","commandType":"auto","position":42.0,"command":"%md-sandbox\n## Step 5\n\nCreate another DataFrame called `combinedRobberiesByMonthDF`, that combines all three robberies-per-month views into one.\nIn creating this view, add a new column called `city`, that identifies the city associated with each row.\nThe final view will have the following columns:\n\n* `city`: The name of the city associated with the row. (Use the strings \"Los Angeles\", \"Philadelphia\", and \"Dallas\".)\n* `month`: The month number associated with the row.\n* `robbery`: The number of robbery in that month (for that city).\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** You may want to apply the `union()` method in this example to combine the three datasets.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** It's easy to add new columns in DataFrames. For example, add a new column called `newColumn` to `originalDF` use `withColumn()` method as follows:\n\n```originalDF.withColumn(\"newColumn\")``` ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633156055,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7a822b62-7ce0-45c2-9b07-cd34bd97abda"},{"version":"CommandV1","origId":1745794912682023,"guid":"e06cbf41-f3a0-4eb1-964d-ce4bde8f8f83","subtype":"command","commandType":"auto","position":43.0,"command":"# ANSWER\n\nfrom pyspark.sql.functions import lit\n\ncombinedRobberiesByMonthDF = (robberiesByMonthLosAngelesDF.withColumn(\"city\", lit(\"Los Angeles\")).select(\"*\")\n  .union(robberiesByMonthPhiladelphiaDF.withColumn(\"city\", lit(\"Philadelphia\")).select(\"*\")) \n  .union(robberiesByMonthDallasDF.withColumn(\"city\", lit(\"Dallas\")).select(\"*\")) \n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"combinedRobberiesByMonthDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"month","nullable":true,"type":"integer"},{"metadata":{},"name":"robberies","nullable":false,"type":"long"},{"metadata":{},"name":"city","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633787333,"submitTime":1542633787304,"finishTime":1542633787524,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cdef23f2-bb88-4e47-997f-2c50e97717b5"},{"version":"CommandV1","origId":1745794912682024,"guid":"d447e2e8-60c2-4802-a1b8-ecb1c82693c6","subtype":"command","commandType":"auto","position":44.0,"command":"# TEST - Run this cell to test your solution.\n\nresults = [ (r.city, r.month, r.robberies) for r in combinedRobberiesByMonthDF.collect() ]\nexpectedResults =  [ \n(u'Los Angeles', 1, 719), \n(u'Los Angeles', 2, 675), \n(u'Los Angeles', 3, 709), \n(u'Los Angeles', 4, 713),   \n(u'Los Angeles', 5, 790), \n(u'Los Angeles', 6, 698), \n(u'Los Angeles', 7, 826), \n(u'Los Angeles', 8, 765), \n(u'Los Angeles', 9, 722), \n(u'Los Angeles', 10, 814), \n(u'Los Angeles', 11, 764), \n(u'Los Angeles', 12, 853), \n(u'Philadelphia', 1, 520), \n(u'Philadelphia', 2, 416), \n(u'Philadelphia', 3, 432), \n(u'Philadelphia', 4, 466),\n(u'Philadelphia', 5, 533), \n(u'Philadelphia', 6, 509), \n(u'Philadelphia', 7, 537), \n(u'Philadelphia', 8, 561), \n(u'Philadelphia', 9, 514), \n(u'Philadelphia', 10, 572), \n(u'Philadelphia', 11, 545), \n(u'Philadelphia', 12, 544), \n(u'Dallas', 1, 743),\n(u'Dallas', 2, 435), \n(u'Dallas', 3, 412), \n(u'Dallas', 4, 594), \n(u'Dallas', 5, 615), \n(u'Dallas', 6, 495), \n(u'Dallas', 7, 535), \n(u'Dallas', 8, 627), \n(u'Dallas', 9, 512), \n(u'Dallas', 10, 603), \n(u'Dallas', 11, 589), \n(u'Dallas', 12, 664)] \n\ndbTest(\"DF-L7-combinedRobberiesByMonth-counts\", expectedResults, results)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633156388,"submitTime":1542633156388,"finishTime":1542633340652,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"da4df744-c746-4e7d-b7d9-713c3db97f50"},{"version":"CommandV1","origId":1745794912682025,"guid":"8cfa0af1-51f3-46f5-b922-7f67e3e60d3d","subtype":"command","commandType":"auto","position":45.0,"command":"combinedRobberiesByMonthDF.select(\"city\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633156543,"submitTime":1542633156543,"finishTime":1542633340655,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2bc3da54-3c95-49fe-86ce-6a9c9e04a26d"},{"version":"CommandV1","origId":1745794912682026,"guid":"2872217b-f2df-4c1f-a718-fb78331ae0c9","subtype":"command","commandType":"auto","position":46.0,"command":"%md-sandbox\n## Step 6\n\nGraph the contents of `combinedRobberiesByMonthDF`, producing a graph similar to the following. (The diagram below deliberately\nuses different data.)\n\n<img src=\"https://files.training.databricks.com/images/eLearning/combined-homicides.png\" style=\"width: 800px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\nAdjust the plot options to configure the plot properly, as shown below:\n\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-4.png\" style=\"width: 362px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** Order your results by `month`, then `city`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633156694,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"99b679ce-53be-40f3-ab52-ac48250f401e"},{"version":"CommandV1","origId":1745794912682027,"guid":"c2d148d1-a5c3-4b21-828a-63816e73142f","subtype":"command","commandType":"auto","position":47.0,"command":"# ANSWER\n\ndisplay(combinedRobberiesByMonthDF.orderBy(\"month\", \"city\"))","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633156858,"submitTime":1542633156858,"finishTime":1542633340658,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c1f16d0d-c177-4df9-b064-369ef7c08429"},{"version":"CommandV1","origId":1745794912682028,"guid":"c1294c4e-8c0b-4fa7-bd77-b5d039085ef4","subtype":"command","commandType":"auto","position":48.0,"command":"%md\n## Step 7\n\nWhile the above graph is interesting, it's flawed: it's comparing the raw numbers of robberies, not the per capita robbery rates.\n\nThe DataFrame (already created) called `cityDataDF`  contains, among other data, estimated 2016 population values for all United States cities\nwith populations of at least 100,000. (The data is from [Wikipedia](https://en.wikipedia.org/wiki/List_of_United_States_cities_by_population).)\n\n* Use the population values in that table to normalize the robberies so they represent per-capita values (total robberies divided by population).\n* Save your results in a DataFrame called `robberyRatesByCityDF`.\n* The robbery rate value must be stored in a new column, `robberyRate`.\n\nNext, graph the results, as above.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633157018,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ce156dc3-0f2e-4a17-a890-fa81cdbc3b45"},{"version":"CommandV1","origId":1745794912682029,"guid":"87b78715-9493-42ad-85bb-f30ec43493e6","subtype":"command","commandType":"auto","position":49.0,"command":"# ANSWER\n\n# rename \"city\" column to \"cities\" to avoid having two similarly named cols; also columns are case-blind\ncityDataDF = spark.read.parquet(\"dbfs:/mnt/training/City-Data.parquet\").withColumnRenamed(\"city\", \"cities\")\n\nrobberyRatesByCityDF = (combinedRobberiesByMonthDF \n  .select(\"month\", \"robberies\", \"city\") \n  .join(cityDataDF, combinedRobberiesByMonthDF.city == cityDataDF.cities) \n  .withColumn(\"robberyRate\", col(\"robberies\")/col(\"estPopulation2016\"))\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"cityDataDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"rankIn2016","nullable":true,"type":"integer"},{"metadata":{},"name":"state","nullable":true,"type":"string"},{"metadata":{},"name":"stateAbbrev","nullable":true,"type":"string"},{"metadata":{},"name":"population2010","nullable":true,"type":"long"},{"metadata":{},"name":"estPopulation2016","nullable":true,"type":"long"},{"metadata":{},"name":"cities","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"robberyRatesByCityDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"month","nullable":true,"type":"integer"},{"metadata":{},"name":"robberies","nullable":false,"type":"long"},{"metadata":{},"name":"city","nullable":false,"type":"string"},{"metadata":{},"name":"rankIn2016","nullable":true,"type":"integer"},{"metadata":{},"name":"state","nullable":true,"type":"string"},{"metadata":{},"name":"stateAbbrev","nullable":true,"type":"string"},{"metadata":{},"name":"population2010","nullable":true,"type":"long"},{"metadata":{},"name":"estPopulation2016","nullable":true,"type":"long"},{"metadata":{},"name":"cities","nullable":true,"type":"string"},{"metadata":{},"name":"robberyRate","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633868010,"submitTime":1542633867971,"finishTime":1542633870635,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"967ec2d3-16ba-4b1f-9ebf-fc03369933e2"},{"version":"CommandV1","origId":1745794912682030,"guid":"d9408a4b-38cd-46c2-9b04-9dbca2944035","subtype":"command","commandType":"auto","position":49.5,"command":"display(robberyRatesByCityDF)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["1","719","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.8082036615746914E-4],["2","675","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.6975486391695643E-4],["3","709","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.7830547928462533E-4],["4","713","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.7931143403376285E-4],["5","790","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.986760629546601E-4],["6","698","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.7553910372449717E-4],["7","826","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",2.077296556968978E-4],["8","765","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.9238884577255062E-4],["9","722","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.8157483221932228E-4],["10","814","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",2.0471179144948524E-4],["11","764","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",1.9213735708526624E-4],["12","853","Los Angeles","2","California","CA","3792621","3976322","Los Angeles",2.1451985025357605E-4],["1","520","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.316597273246796E-4],["2","416","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",2.6532778185974366E-4],["3","432","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",2.755326965466569E-4],["4","466","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",2.9721814025634747E-4],["5","533","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.3995122050779655E-4],["6","509","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.246438484774267E-4],["7","537","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.4250244917952486E-4],["8","561","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.578098212098947E-4],["9","514","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.2783288431708713E-4],["10","572","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.648257000571475E-4],["11","545","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.4760490652298146E-4],["12","544","Philadelphia","6","Pennsylvania","PA","1526006","1567872","Philadelphia",3.469670993550494E-4],["1","743","Dallas","9","Texas","TX","1197816","1317929","Dallas",5.637632983263893E-4],["2","435","Dallas","9","Texas","TX","1197816","1317929","Dallas",3.3006330386538274E-4],["3","412","Dallas","9","Texas","TX","1197816","1317929","Dallas",3.126116809023855E-4],["4","594","Dallas","9","Texas","TX","1197816","1317929","Dallas",4.507071321747985E-4],["5","615","Dallas","9","Texas","TX","1197816","1317929","Dallas",4.6664122270623074E-4],["6","495","Dallas","9","Texas","TX","1197816","1317929","Dallas",3.755892768123321E-4],["7","535","Dallas","9","Texas","TX","1197816","1317929","Dallas",4.0593992544363163E-4],["8","627","Dallas","9","Texas","TX","1197816","1317929","Dallas",4.757464172956206E-4],["9","512","Dallas","9","Texas","TX","1197816","1317929","Dallas",3.884883024806344E-4],["10","603","Dallas","9","Texas","TX","1197816","1317929","Dallas",4.575360281168409E-4],["11","589","Dallas","9","Texas","TX","1197816","1317929","Dallas",4.46913301095886E-4],["12","664","Dallas","9","Texas","TX","1197816","1317929","Dallas",5.038207672795728E-4]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"month","type":"\"integer\"","metadata":"{}"},{"name":"robberies","type":"\"long\"","metadata":"{}"},{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"rankIn2016","type":"\"integer\"","metadata":"{}"},{"name":"state","type":"\"string\"","metadata":"{}"},{"name":"stateAbbrev","type":"\"string\"","metadata":"{}"},{"name":"population2010","type":"\"long\"","metadata":"{}"},{"name":"estPopulation2016","type":"\"long\"","metadata":"{}"},{"name":"cities","type":"\"string\"","metadata":"{}"},{"name":"robberyRate","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1542633887177,"submitTime":1542633887140,"finishTime":1542633926044,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"69f6ac6f-eea2-4f6d-89d2-574459942893"},{"version":"CommandV1","origId":1745794912682031,"guid":"258990be-5e8c-40d2-b62b-ffa6fa3a4323","subtype":"command","commandType":"auto","position":49.75,"command":"# Save to a new database table so the data can be used later.\nrobberyRatesByCityDF.write.saveAsTable(\"RobberyRatesByCity\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1542634006424,"submitTime":1542634006379,"finishTime":1542634042659,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"58a8152b-2266-421f-b434-9c75429100a2"},{"version":"CommandV1","origId":1745794912682032,"guid":"bfda3313-026e-4cba-be8d-69d17228db47","subtype":"command","commandType":"auto","position":50.0,"command":"# TEST - Run this cell to test your solution.\nresults = [ (r.city, r.month, '{:6f}'.format(r.robberyRate)) for r in robberyRatesByCityDF.orderBy(\"city\", \"month\").collect() ]\nexpectedResults = [\n  (u'Dallas',  1, '0.000564'),\n  (u'Dallas',  2, '0.000330'),\n  (u'Dallas',  3, '0.000313'),\n  (u'Dallas',  4, '0.000451'),\n  (u'Dallas',  5, '0.000467'),\n  (u'Dallas',  6, '0.000376'),\n  (u'Dallas',  7, '0.000406'),\n  (u'Dallas',  8, '0.000476'),\n  (u'Dallas',  9, '0.000388'),\n  (u'Dallas', 10, '0.000458'),\n  (u'Dallas', 11, '0.000447'),\n  (u'Dallas', 12, '0.000504'),\n  (u'Los Angeles',  1, '0.000181'),\n  (u'Los Angeles',  2, '0.000170'),\n  (u'Los Angeles',  3, '0.000178'),\n  (u'Los Angeles',  4, '0.000179'),\n  (u'Los Angeles',  5, '0.000199'),\n  (u'Los Angeles',  6, '0.000176'),\n  (u'Los Angeles',  7, '0.000208'),\n  (u'Los Angeles',  8, '0.000192'),\n  (u'Los Angeles',  9, '0.000182'),\n  (u'Los Angeles', 10, '0.000205'),\n  (u'Los Angeles', 11, '0.000192'),\n  (u'Los Angeles', 12, '0.000215'),\n  (u'Philadelphia',  1, '0.000332'),\n  (u'Philadelphia',  2, '0.000265'),\n  (u'Philadelphia',  3, '0.000276'),\n  (u'Philadelphia',  4, '0.000297'),\n  (u'Philadelphia',  5, '0.000340'),\n  (u'Philadelphia',  6, '0.000325'),\n  (u'Philadelphia',  7, '0.000343'),\n  (u'Philadelphia',  8, '0.000358'),\n  (u'Philadelphia',  9, '0.000328'),\n  (u'Philadelphia', 10, '0.000365'),\n  (u'Philadelphia', 11, '0.000348'),\n  (u'Philadelphia', 12, '0.000347')]\ndbTest(\"DF-L7-roberryRatesByCity-counts\", expectedResults, results)\n\nprint(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1542633157320,"submitTime":1542633157320,"finishTime":1542633340663,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1dfb3ace-fc6a-468e-ab77-934fd641a926"},{"version":"CommandV1","origId":1745794912682033,"guid":"fb8b2b9c-5f2f-42e1-af8b-fc7b53837670","subtype":"command","commandType":"auto","position":52.0,"command":"%md\n## References\n\nThe crime data used in this notebook comes from the following locations:\n\n| City          | Original Data \n| ------------- | -------------\n| Boston        | <a href=\"https://data.boston.gov/group/public-safety\" target=\"_blank\">https&#58;//data.boston.gov/group/public-safety</a>\n| Chicago       | <a href=\"https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2\" target=\"_blank\">https&#58;//data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2</a>\n| Dallas        | <a href=\"https://www.dallasopendata.com/Public-Safety/Police-Incidents/tbnj-w5hb/data\" target=\"_blank\">https&#58;//www.dallasopendata.com/Public-Safety/Police-Incidents/tbnj-w5hb/data</a>\n| Los Angeles   | <a href=\"https://data.lacity.org/A-Safe-City/Crime-Data-From-2010-to-Present/y8tr-7khq\" target=\"_blank\">https&#58;//data.lacity.org/A-Safe-City/Crime-Data-From-2010-to-Present/y8tr-7khq</a>\n| New Orleans   | <a href=\"https://data.nola.gov/Public-Safety-and-Preparedness/Electronic-Police-Report-2016/4gc2-25he/data\" target=\"_blank\">https&#58;//data.nola.gov/Public-Safety-and-Preparedness/Electronic-Police-Report-2016/4gc2-25he/data</a>\n| New York      | <a href=\"https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i\" target=\"_blank\">https&#58;//data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i</a>\n| Philadelphia  | <a href=\"https://www.opendataphilly.org/dataset/crime-incidents\" target=\"_blank\">https&#58;//www.opendataphilly.org/dataset/crime-incidents</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1542633157464,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joel@solliance.net","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"634bf921-3aa0-432a-8474-d86d500dd9a2"}],"dashboards":[],"guid":"af4f50d6-0571-4969-b641-55b0f6bd6948","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}