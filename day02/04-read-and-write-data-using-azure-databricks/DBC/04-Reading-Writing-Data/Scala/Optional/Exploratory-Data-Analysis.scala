{"version":"NotebookV1","origId":1745794912675670,"name":"Exploratory-Data-Analysis","language":"scala","commands":[{"version":"CommandV1","origId":1745794912675671,"guid":"3b8713ac-0c6f-4766-944f-cb5967237048","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Project: Exploratory Data Analysis\nPerform exploratory data analysis (EDA) to gain insights from a data lake.\n\n## Instructions\n\nIn `dbfs:/mnt/training/crime-data-2016`, there are a number of Parquet files containing 2016 crime data from seven United States cities:\n\n* New York\n* Los Angeles\n* Chicago\n* Philadelphia\n* Dallas\n* Boston\n\nThe data is cleaned up a little, but has not been normalized. Each city reports crime data slightly differently, so\nexamine the data for each city to determine how to query it properly.\n\nYour job is to use some of this data to gain insights about certain kinds of crimes.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6add78de-bf7b-44af-8146-c2436e490681"},{"version":"CommandV1","origId":1745794912675672,"guid":"acdf9418-6c7d-4a2d-ba5c-cb5bac42ccc9","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n### Getting Started\n\nRun the following cell to configure our \"classroom.\"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"37a2e753-b4b5-4d37-8722-c409ce3d2507"},{"version":"CommandV1","origId":1745794912675673,"guid":"30cf6292-4776-4040-aae0-e4f9e7b0b804","subtype":"command","commandType":"auto","position":4.0,"command":"%run ../Includes/Classroom-Setup","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"69ec2160-f132-4ffc-8d66-f0ead55052fc"},{"version":"CommandV1","origId":1745794912675674,"guid":"181f1415-bd5e-424c-a519-f615aae7eb59","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Step 1\n\nStart by creating DataFrames for Los Angeles, Philadelphia, and Dallas data.\n\nUse `spark.read.parquet` to create named DataFrames for the files you choose. \n\nTo read in the parquet file, use `val crimeDataNewYorkDF = spark.read.parquet(\"/mnt/training/crime-data-2016/Crime-Data-New-York-2016.parquet\")`\n\nUse the following view names:\n\n| City          | DataFrame Name            | Path to DBFS file\n| ------------- | ------------------------- | -----------------\n| Los Angeles   | `crimeDataLosAngelesDF`   | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Los-Angeles-2016.parquet`\n| Philadelphia  | `crimeDataPhiladelphiaDF` | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Philadelphia-2016.parquet`\n| Dallas        | `crimeDataDallasDF`       | `dbfs:/mnt/training/crime-data-2016/Crime-Data-Dallas-2016.parquet`","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b1e6119e-23f7-444a-aa18-0849ff97ff80"},{"version":"CommandV1","origId":1745794912675675,"guid":"a11ba1bf-2cea-4822-b5c6-adddd71d94ee","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b089ebea-7bed-4845-b601-980a0e0980f2"},{"version":"CommandV1","origId":1745794912675676,"guid":"ac04e381-adaf-4825-b7b9-699a4c800434","subtype":"command","commandType":"auto","position":7.0,"command":"// TODO\n\nval crimeDataLosAngelesDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3fb457e5-1420-4cc8-a35a-85673dc36fd1"},{"version":"CommandV1","origId":1745794912675677,"guid":"89affb8b-7392-4854-aa0f-35bd1480e7b6","subtype":"command","commandType":"auto","position":8.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val rowsLosAngeles  = crimeDataLosAngelesDF.count()\ndbTest(\"DF-L7-crimeDataLA-count\", rowsLosAngeles, 217945)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"17e2701e-1810-4fd2-a0d5-58d789bebf16"},{"version":"CommandV1","origId":1745794912675678,"guid":"feb9a6e6-4754-4037-b7cd-df77e017d960","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"12807280-29cf-451d-9b01-52a7e8d9d6b9"},{"version":"CommandV1","origId":1745794912675679,"guid":"bafd0a65-c17a-4c1e-9eef-96b11e6d0141","subtype":"command","commandType":"auto","position":10.0,"command":"// TODO\n\nval crimeDataPhiladelphiaDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"271183bf-7b44-4a74-b318-a49673648572"},{"version":"CommandV1","origId":1745794912675680,"guid":"1eb63745-0c4c-4da2-8b0f-590ee6c13b0f","subtype":"command","commandType":"auto","position":11.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val rowsPhiladelphia  = crimeDataPhiladelphiaDF.count()\ndbTest(\"DF-L7-crimeDataPA-count\", rowsPhiladelphia, 168664)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b3c4d599-be6b-4349-98c1-d6cd5ff2e85a"},{"version":"CommandV1","origId":1745794912675681,"guid":"aed235e0-7430-4866-91b1-c1ced29b426d","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"08594af0-665c-470a-a23b-7081a07600b2"},{"version":"CommandV1","origId":1745794912675682,"guid":"35f9e48e-83c0-4967-b6e9-6a2a30ed8a9b","subtype":"command","commandType":"auto","position":13.0,"command":"// TODO\n\nval crimeDataDallasDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a597973f-8f34-4eb4-a050-ce45f568db0a"},{"version":"CommandV1","origId":1745794912675683,"guid":"6e82c167-2254-40ca-80ab-ac23582d14e1","subtype":"command","commandType":"auto","position":14.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val rowsDallas  = crimeDataDallasDF.count()\ndbTest(\"DF-L7-crimeDataDAL-count\", 99642, rowsDallas)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"05167202-83f5-45c4-966a-3450e490cb31"},{"version":"CommandV1","origId":1745794912675684,"guid":"7b227d8f-f1b8-4915-82e4-70257241779c","subtype":"command","commandType":"auto","position":15.0,"command":"%md-sandbox\n## Step 2\n\nFor each table, examine the data to figure out how to extract _robbery_ statistics.\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> Each city uses different values to indicate robbery. Commonly used terminology is \"larceny\", \"burglary\" or \"robbery.\"  These challenges are common in Data Lakes.  Restrict yourself to only robberies.\n\nExplore the data for the three cities until you understand how each city records robbery information. If you don't want to worry about upper- or lower-case, \nremember to use the DataFrame `lower()` method to converts column values to lowercase.\n\nCreate a DataFrame containing only the robbery-related rows, as shown in the table below.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** For each table, focus your efforts on the column listed below.\n\nFocus on the following columns for each table:\n\n| DataFrame Name            | Robbery DataFrame Name  | Column\n| ------------------------- | ----------------------- | -------------------------------\n| `crimeDataLosAngelesDF`   | `robberyLosAngelesDF`   | `crimeCodeDescription`\n| `crimeDataPhiladelphiaDF` | `robberyPhiladelphiaDF` | `ucr_general_description`\n| `crimeDataDallasDF`       | `robberyDallasDF`       | `typeOfIncident`","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8c052fdd-89b3-4589-80a4-4c16d6ed79ba"},{"version":"CommandV1","origId":1745794912675685,"guid":"511bd3fc-c470-4499-9c50-2528c3f5bc6d","subtype":"command","commandType":"auto","position":16.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"66c69505-95f8-410a-bc81-99569560118f"},{"version":"CommandV1","origId":1745794912675686,"guid":"c7d606d9-1923-460b-9e6c-d2205461079f","subtype":"command","commandType":"auto","position":17.0,"command":"// TODO\nimport org.apache.spark.sql.functions.lower\nval robberyLosAngelesDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ff9aae16-30e6-47f2-a6fc-b5979c2bce5a"},{"version":"CommandV1","origId":1745794912675687,"guid":"b51f6609-a8f7-4c37-9b5d-92588e4b35bc","subtype":"command","commandType":"auto","position":18.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val totalLosAngeles  = robberyLosAngelesDF.count()\ndbTest(\"DF-L7-robberyDataLA-count\", 9048, totalLosAngeles)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"88b4e4c3-f897-4d91-819c-6d4f9471e10f"},{"version":"CommandV1","origId":1745794912675688,"guid":"4694f656-a50d-4f6c-a297-a33bd12ac629","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b5d84826-5f4f-4b75-aa5e-91583031daef"},{"version":"CommandV1","origId":1745794912675689,"guid":"1b4dbb95-988a-4fd5-88a4-f17131966012","subtype":"command","commandType":"auto","position":20.0,"command":"// TODO\n\nval robberyPhiladelphiaDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"78a0f6f5-0a5d-4f84-8153-4e2530ad3cb7"},{"version":"CommandV1","origId":1745794912675690,"guid":"21f0ba0a-2711-48a6-9116-56305579837c","subtype":"command","commandType":"auto","position":21.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val totalPhiladelphia  = robberyPhiladelphiaDF.count()\ndbTest(\"DF-L7-robberyDataPA-count\", 6149, totalPhiladelphia)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1a9c1b85-e725-45a5-8071-f772097853cf"},{"version":"CommandV1","origId":1745794912675691,"guid":"837051b8-778b-48fd-a2ec-7cabcdf68d4d","subtype":"command","commandType":"auto","position":22.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f7fae67c-5ad3-4ec4-94fe-ef62764657d2"},{"version":"CommandV1","origId":1745794912675692,"guid":"640a43ac-ae6a-4f73-a163-9c210b3f6346","subtype":"command","commandType":"auto","position":23.0,"command":"// TODO\n\nval robberyDallasDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"028a4ab5-e076-40d1-a3d8-27ff1f443ffd"},{"version":"CommandV1","origId":1745794912675693,"guid":"45769c9a-31c9-4bfc-ac66-6c726a7fe42e","subtype":"command","commandType":"auto","position":24.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val totalDallas = robberyDallasDF.count()\ndbTest(\"DF-L7-robberyDataDAL-count\", 6824, totalDallas)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"61f1c6db-063f-4102-b9de-f5dedc2bcc1b"},{"version":"CommandV1","origId":1745794912675694,"guid":"8359fb04-cdeb-4cc2-9292-d98d3b93392b","subtype":"command","commandType":"auto","position":25.0,"command":"%md-sandbox\n## Step 3\n\nNow that you have DataFrames of only the robberies in each city, create DataFrames for each city summarizing the number of robberies in each month.\n\nYour DataFrames must contain two columns:\n* `month`: The month number (e.g., 1 for January, 2 for February, etc.).\n* `robberies`: The total number of robberies in the month.\n\nUse the following DataFrame names and date columns:\n\n\n| City          | DataFrame Name     | Date Column \n| ------------- | ------------- | -------------\n| Los Angeles   | `robberiesByMonthLosAngelesDF` | `timeOccurred`\n| Philadelphia  | `robberiesByMonthPhiladelphiaDF` | `dispatch_date_time`\n| Dallas        | `robberiesByMonthDallasDF` | `startingDateTime`\n\n<img alt=\"Side Note\" title=\"Side Note\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.05em; transform:rotate(15deg)\" src=\"https://files.training.databricks.com/static/images/icon-note.webp\"/> For each city, figure out which column contains the date of the incident. Then, extract the month from that date.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"342ee405-5b7e-4d87-9df2-85a7b2d3f380"},{"version":"CommandV1","origId":1745794912675695,"guid":"11aeaf89-083e-4ec7-9a26-5787e2cc660f","subtype":"command","commandType":"auto","position":26.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"524c2d18-700e-4e6d-b202-10a9b6b17e5c"},{"version":"CommandV1","origId":1745794912675696,"guid":"a5c90b72-d5f1-4042-9f88-424a59f70956","subtype":"command","commandType":"auto","position":27.0,"command":"// TODO\n\nimport org.apache.spark.sql.functions.{month,count}\nval robberiesByMonthLosAngelesDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7e304217-ce70-4b30-badf-4c7f96e146be"},{"version":"CommandV1","origId":1745794912675697,"guid":"a916b60e-8ccf-417a-8697-ea1516d3cbbb","subtype":"command","commandType":"auto","position":28.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val la = robberiesByMonthLosAngelesDF.collect().toList\ndbTest(\"DF-L7-robberyByMonthLA-counts\", List(Row(1,719), Row(2,675), Row(3,709), Row(4,713), Row(5,790), Row(6,698), Row(7,826), Row(8,765), Row(9,722), Row(10,814), Row(11,764), Row(12,853)), la)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bb86aaef-7892-48a3-a65e-89d9e5ecea79"},{"version":"CommandV1","origId":1745794912675698,"guid":"a5e1a5cb-b857-46f6-a110-e2b2948ebf38","subtype":"command","commandType":"auto","position":29.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3e6d6a6d-52e7-485d-8bdc-a73c503fd057"},{"version":"CommandV1","origId":1745794912675699,"guid":"466b3fd2-e6c6-484c-8728-a6f08d9bac7a","subtype":"command","commandType":"auto","position":30.0,"command":"// TODO\n\nimport org.apache.spark.sql.functions._\n\nval robberiesByMonthPhiladelphiaDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2d7f6a54-c7e7-4669-a89b-b2b2ae40752e"},{"version":"CommandV1","origId":1745794912675700,"guid":"affe5a51-5941-4d0b-8704-ac008cdc7495","subtype":"command","commandType":"auto","position":31.0,"command":"// TEST - Run this cell to test your solution.\n// convert to list so that we get deep compare (Array would be a shallow compare)\nlazy val philadelphia  = robberiesByMonthPhiladelphiaDF.collect().toList\ndbTest(\"DF-L7-robberyByMonthPA-counts\", List(Row(1,520), Row(2,416), Row(3,432), Row(4,466), Row(5,533), Row(6,509), Row(7,537), Row(8,561), Row(9,514), Row(10,572), Row(11,545), Row(12,544)), philadelphia)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f5cc35a8-cfb5-4c4c-b3dc-4d28014aadae"},{"version":"CommandV1","origId":1745794912675701,"guid":"6d53048f-64d3-4b28-9390-00aea39628e0","subtype":"command","commandType":"auto","position":32.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2f6396e8-902a-4eda-8034-077e624c7664"},{"version":"CommandV1","origId":1745794912675702,"guid":"715b9dee-6b32-4dc5-b28a-9d3e3cb917c3","subtype":"command","commandType":"auto","position":33.0,"command":"// TODO\n\nimport org.apache.spark.sql.functions._\n\nval robberiesByMonthDallasDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b4830f71-b56b-4421-9dbd-8d1daaec41a7"},{"version":"CommandV1","origId":1745794912675703,"guid":"399d9b89-a776-463f-bdeb-c6f00fd44da2","subtype":"command","commandType":"auto","position":34.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val dallas  = robberiesByMonthDallasDF.collect().toList\ndbTest(\"DF-L7-robberyByMonthDAL-counts\", List(Row(1, 743), Row(2, 435), Row(3,412), Row(4,594), Row(5,615), Row(6,495), Row(7,535), Row(8,627), Row(9,512), Row(10,603), Row(11,589), Row(12,664)), dallas)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"19b43791-c257-4505-a28c-9a2ba5c9b798"},{"version":"CommandV1","origId":1745794912675704,"guid":"d2929717-5c70-4fea-8990-dfe2755dce79","subtype":"command","commandType":"auto","position":35.0,"command":"%md-sandbox\n\n## Step 4\n\nPlot the robberies per month for each of the three cities, producing a plot similar to the following:\n\n<img src=\"https://files.training.databricks.com/images/eLearning/robberies-by-month.png\" style=\"max-width: 700px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\nWhen you first run the cell, you'll get an HTML table as the result. To configure the plot:\n\n1. Click the graph button.\n2. If the plot doesn't look correct, click the **Plot Options** button.\n3. Configure the plot similar to the following example.\n\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-1.png\" style=\"width: 440px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-2.png\" style=\"width: 268px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-3.png\" style=\"width: 362px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"eb4ce68b-fef1-4271-96ef-3095d8cb34fc"},{"version":"CommandV1","origId":1745794912675705,"guid":"20f53334-787f-4625-9a73-6d01c7c2945d","subtype":"command","commandType":"auto","position":36.0,"command":"%md\n#### Los Angeles","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"af7bd0c9-c1ad-4aa2-b295-45f57802937e"},{"version":"CommandV1","origId":1745794912675706,"guid":"0904300c-1174-48a4-8045-52508e19e672","subtype":"command","commandType":"auto","position":37.0,"command":"// TODO\n\nFILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cb9d445b-7793-4d41-8653-0d4e728cd2bd"},{"version":"CommandV1","origId":1745794912675707,"guid":"1ddb4d62-d042-4e08-9cab-c3b2ca87e965","subtype":"command","commandType":"auto","position":38.0,"command":"%md\n#### Philadelphia","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6227e401-2dce-4100-a388-f013e30a81ef"},{"version":"CommandV1","origId":1745794912675708,"guid":"cf8d077d-999b-4596-93ca-a35a8d98be9e","subtype":"command","commandType":"auto","position":39.0,"command":"// TODO\n\nFILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"13fe93b2-4e61-4719-9bbd-ed7896919804"},{"version":"CommandV1","origId":1745794912675709,"guid":"e471263d-7ab8-4f7d-a8c1-eb6dc3d16f8f","subtype":"command","commandType":"auto","position":40.0,"command":"%md\n#### Dallas","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"66cad138-e695-4b75-8d82-7a7bef6d6713"},{"version":"CommandV1","origId":1745794912675710,"guid":"0591849d-4a0a-435b-87ee-ec9933d2d775","subtype":"command","commandType":"auto","position":41.0,"command":"// TODO\n\nFILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"328a61d2-bb84-403e-9615-7b70875cb73a"},{"version":"CommandV1","origId":1745794912675711,"guid":"2237bdd3-0532-4d74-97b6-aef4a2d421c0","subtype":"command","commandType":"auto","position":42.0,"command":"%md-sandbox\n## Step 5\n\nCreate another DataFrame called `combinedRobberiesByMonthDF`, that combines all three robberies-per-month views into one.\nIn creating this view, add a new column called `city`, that identifies the city associated with each row.\nThe final view will have the following columns:\n\n* `city`: The name of the city associated with the row. (Use the strings \"Los Angeles\", \"Philadelphia\", and \"Dallas\".)\n* `month`: The month number associated with the row.\n* `robbery`: The number of robbery in that month (for that city).\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** You may want to apply the `union()` method in this example to combine the three datasets.\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** It's easy to add new columns in DataFrames. For example, add a new column called `newColumn` to `originalDF` use `withColumn()` method as follows:\n\n```originalDF.withColumn(\"newColumn\")``` ","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fe50c68a-a5ba-4a68-91c2-f8af2f4d1019"},{"version":"CommandV1","origId":1745794912675712,"guid":"1d508ba1-67d8-4209-aecc-379e51cef728","subtype":"command","commandType":"auto","position":43.0,"command":"// TODO\n\nval combinedRobberiesByMonthDF  = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1b2a7098-b8a3-4a4e-b740-a1fdd731ec64"},{"version":"CommandV1","origId":1745794912675713,"guid":"d684e450-6f3b-4c74-a44f-ad670820698f","subtype":"command","commandType":"auto","position":44.0,"command":"// TEST - Run this cell to test your solution.\n\nlazy val results = combinedRobberiesByMonthDF.collect().toSet\n           \ndbTest(\"DF-L7-combinedRobberiesByMonth-counts\", Set(Row(\"Dallas\",11,589), Row(\"Los Angeles\",2,675), Row(\"Dallas\",8,627), Row(\"Los Angeles\",9,722), Row(\"Los Angeles\",1,719), Row(\"Philadelphia\",12,544), Row(\"Dallas\",1,743), Row(\"Dallas\",10,603), Row(\"Dallas\",6,495), Row(\"Los Angeles\",4,713), Row(\"Philadelphia\",2,416), Row(\"Dallas\",4,594), Row(\"Los Angeles\",12,853), Row(\"Dallas\",12,664), Row(\"Dallas\",9,512), Row(\"Los Angeles\",3,709), Row(\"Dallas\",2,435), Row(\"Los Angeles\",7,826), Row(\"Philadelphia\",1,520), Row(\"Los Angeles\",5,790), Row(\"Philadelphia\",7,537), Row(\"Dallas\",5,615), Row(\"Philadelphia\",9,514), Row(\"Los Angeles\",6,698), Row(\"Philadelphia\",8,561), Row(\"Los Angeles\",11,764), Row(\"Philadelphia\",6,509), Row(\"Dallas\",3,412), Row(\"Philadelphia\",5,533), Row(\"Philadelphia\",10,572), Row(\"Los Angeles\",10,814), Row(\"Los Angeles\",8,765), Row(\"Philadelphia\",11,545), Row(\"Dallas\",7,535), Row(\"Philadelphia\",3,432), Row(\"Philadelphia\",4,466)), results)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"374a41af-4f56-4296-802d-53b5ed5e85ad"},{"version":"CommandV1","origId":1745794912675714,"guid":"66d1cb06-8126-412c-8aee-6a066282fd1f","subtype":"command","commandType":"auto","position":45.0,"command":"combinedRobberiesByMonthDF.select($\"city\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bffb7600-2cb7-4083-a6dd-1d1dd68f9607"},{"version":"CommandV1","origId":1745794912675715,"guid":"95d3f5b7-2840-445a-a07b-1d57e1c8cdc3","subtype":"command","commandType":"auto","position":46.0,"command":"%md-sandbox\n## Step 6\n\nGraph the contents of `combinedRobberiesByMonthDF`, producing a graph similar to the following. (The diagram below deliberately\nuses different data.)\n\n<img src=\"https://files.training.databricks.com/images/eLearning/combined-homicides.png\" style=\"width: 800px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\nAdjust the plot options to configure the plot properly, as shown below:\n\n<img src=\"https://files.training.databricks.com/images/eLearning/capstone-plot-4.png\" style=\"width: 362px; margin: 10px; border: 1px solid #aaaaaa; border-radius: 10px 10px 10px 10px\"/>\n\n<img alt=\"Hint\" title=\"Hint\" style=\"vertical-align: text-bottom; position: relative; height:1.75em; top:0.3em\" src=\"https://files.training.databricks.com/static/images/icon-light-bulb.svg\"/>&nbsp;**Hint:** Order your results by `month`, then `city`.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"21422123-88fd-4ced-9340-d2a014660d8c"},{"version":"CommandV1","origId":1745794912675716,"guid":"76a003df-7937-40c7-aee4-6a0e6f7fb151","subtype":"command","commandType":"auto","position":47.0,"command":"// TODO\n\nFILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"aa7cf530-94e7-4f7f-a67b-d25047c10501"},{"version":"CommandV1","origId":1745794912675717,"guid":"d6441057-829b-4805-884e-3c5c6f58eae1","subtype":"command","commandType":"auto","position":48.0,"command":"%md\n## Step 7\n\nWhile the above graph is interesting, it's flawed: it's comparing the raw numbers of robberies, not the per capita robbery rates.\n\nThe DataFrame (already created) called `cityDataDF`  contains, among other data, estimated 2016 population values for all United States cities\nwith populations of at least 100,000. (The data is from [Wikipedia](https://en.wikipedia.org/wiki/List_of_United_States_cities_by_population).)\n\n* Use the population values in that table to normalize the robberies so they represent per-capita values (total robberies divided by population).\n* Save your results in a DataFrame called `robberyRatesByCityDF`.\n* The robbery rate value must be stored in a new column, `robberyRate`.\n\nNext, graph the results, as above.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7cfbe886-5fe0-4e4d-ad03-fc58ca587473"},{"version":"CommandV1","origId":1745794912675718,"guid":"e17db1c1-0745-46d1-90b1-0d66d9a0ad6a","subtype":"command","commandType":"auto","position":49.0,"command":"// TODO\n\n// rename \"city\" column to \"cities\" to avoid having two similarly named cols; also columns are case-blind\nval cityDataDF = spark.read.parquet(\"dbfs:/mnt/training/City-Data.parquet\").withColumnRenamed(\"city\", \"cities\")\n\nval robberyRatesByCityDF = // FILL_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"52144256-7330-4ca3-b0c8-bb74c9b6af02"},{"version":"CommandV1","origId":1745794912675719,"guid":"b4bc5ed5-c7c3-44aa-96a6-89c1b42fb76b","subtype":"command","commandType":"auto","position":50.0,"command":"// TEST - Run this cell to test your solution.\nlazy val results = robberyRatesByCityDF.select($\"city\", $\"month\", $\"robberyRate\").orderBy($\"city\", $\"month\").collect.toList\nlazy val expectedResults = List(\n  Row(\"Dallas\",  1, \"0.000564\"),\n  Row(\"Dallas\",  2, \"0.000330\"),\n  Row(\"Dallas\",  3, \"0.000313\"),\n  Row(\"Dallas\",  4, \"0.000451\"), \n  Row(\"Dallas\",  5, \"0.000467\"),\n  Row(\"Dallas\",  6, \"0.000376\"),\n  Row(\"Dallas\",  7, \"0.000406\"),\n  Row(\"Dallas\",  8, \"0.000476\"),\n  Row(\"Dallas\",  9, \"0.000388\"),\n  Row(\"Dallas\", 10, \"0.000458\"), \n  Row(\"Dallas\", 11, \"0.000447\"),\n  Row(\"Dallas\", 12, \"0.000504\"), \n  Row(\"Los Angeles\",  1, \"0.000181\"),\n  Row(\"Los Angeles\",  2, \"0.000170\"),\n  Row(\"Los Angeles\",  3, \"0.000178\"), \n  Row(\"Los Angeles\",  4, \"0.000179\"), \n  Row(\"Los Angeles\",  5, \"0.000199\"),\n  Row(\"Los Angeles\",  6, \"0.000176\"),\n  Row(\"Los Angeles\",  7, \"0.000208\"),\n  Row(\"Los Angeles\",  8, \"0.000192\"), \n  Row(\"Los Angeles\",  9, \"0.000182\"), \n  Row(\"Los Angeles\", 10, \"0.000205\"),\n  Row(\"Los Angeles\", 11, \"0.000192\"), \n  Row(\"Los Angeles\", 12, \"0.000215\"),\n  Row(\"Philadelphia\",  1, \"0.000332\"),\n  Row(\"Philadelphia\",  2, \"0.000265\"), \n  Row(\"Philadelphia\",  3, \"0.000276\"),\n  Row(\"Philadelphia\",  4, \"0.000297\"), \n  Row(\"Philadelphia\",  5, \"0.000340\"),\n  Row(\"Philadelphia\",  6, \"0.000325\"),\n  Row(\"Philadelphia\",  7, \"0.000343\"),\n  Row(\"Philadelphia\",  8, \"0.000358\"),\n  Row(\"Philadelphia\",  9, \"0.000328\"),\n  Row(\"Philadelphia\", 10, \"0.000365\"),\n  Row(\"Philadelphia\", 11, \"0.000348\"), \n  Row(\"Philadelphia\", 12, \"0.000347\"))\ndbTest(\"DF-L7-roberryRatesByCity-counts\", expectedResults, results)\n\nprintln(\"Tests passed!\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1b4ba72c-539f-4633-99e4-9833a71f56b3"},{"version":"CommandV1","origId":1745794912675720,"guid":"60d32cdd-b5ba-4772-a693-0691d1938fad","subtype":"command","commandType":"auto","position":52.0,"command":"%md\n## References\n\nThe crime data used in this notebook comes from the following locations:\n\n| City          | Original Data \n| ------------- | -------------\n| Boston        | <a href=\"https://data.boston.gov/group/public-safety\" target=\"_blank\">https&#58;//data.boston.gov/group/public-safety</a>\n| Chicago       | <a href=\"https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2\" target=\"_blank\">https&#58;//data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2</a>\n| Dallas        | <a href=\"https://www.dallasopendata.com/Public-Safety/Police-Incidents/tbnj-w5hb/data\" target=\"_blank\">https&#58;//www.dallasopendata.com/Public-Safety/Police-Incidents/tbnj-w5hb/data</a>\n| Los Angeles   | <a href=\"https://data.lacity.org/A-Safe-City/Crime-Data-From-2010-to-Present/y8tr-7khq\" target=\"_blank\">https&#58;//data.lacity.org/A-Safe-City/Crime-Data-From-2010-to-Present/y8tr-7khq</a>\n| New Orleans   | <a href=\"https://data.nola.gov/Public-Safety-and-Preparedness/Electronic-Police-Report-2016/4gc2-25he/data\" target=\"_blank\">https&#58;//data.nola.gov/Public-Safety-and-Preparedness/Electronic-Police-Report-2016/4gc2-25he/data</a>\n| New York      | <a href=\"https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i\" target=\"_blank\">https&#58;//data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i</a>\n| Philadelphia  | <a href=\"https://www.opendataphilly.org/dataset/crime-incidents\" target=\"_blank\">https&#58;//www.opendataphilly.org/dataset/crime-incidents</a>","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2d1a8a7a-bf6b-4c80-a21e-a15b5c09b193"}],"dashboards":[],"guid":"0fc0f9b2-2d96-43d4-ab37-3c7f9f9e4159","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}