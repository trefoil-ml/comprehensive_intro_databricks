{"version":"NotebookV1","origId":1745794912676941,"name":"Table-Creator","language":"python","commands":[{"version":"CommandV1","origId":1745794912676942,"guid":"28d796ea-b1e8-4343-8ce5-0d800809781b","subtype":"command","commandType":"auto","position":1.0,"command":"%python\n# Create Tables\n# This notebook creates tables in Databricks from external files, primarily to make SQL access easier. \n# You can run this notebook yourself, but if you follow the lessons in order, one of the other notebooks will run this notebook for you.\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d2b7a6c3-3119-40c4-b0c2-2b5c0104047b"},{"version":"CommandV1","origId":1745794912676943,"guid":"f7ad3572-58f5-4d3c-81cc-4342524ad384","subtype":"command","commandType":"auto","position":2.0,"command":"%python\n\nfrom pathlib2 import Path\n\nfilePeople = \"/mnt/training/dataframes/people-10m.parquet\"\nfileNames = \"dbfs:/mnt/training/ssn/names.parquet\"\nfileBlog = \"dbfs:/mnt/training/databricks-blog.json\"\nfileCity = \"dbfs:/mnt/training/City-Data.parquet\"\nfilePlane = \"dbfs:/mnt/training/asa/planes/plane-data.csv\"\nfileSmall = \"dbfs:/mnt/training/asa/flights/small.csv\"\nfileGeo = \"dbfs:/mnt/training/ip-geocode.parquet\"\nfileBikes = \"dbfs:/mnt/training/bikeSharing/data-001/day.csv\"\n\ndbutils.fs.ls(filePeople)\ndbutils.fs.ls(fileNames)\ndbutils.fs.ls(fileBlog)\ndbutils.fs.ls(fileCity)\ndbutils.fs.ls(filePlane)\ndbutils.fs.ls(fileSmall)\ndbutils.fs.ls(fileGeo)\ndbutils.fs.ls(fileBikes)\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d6a531f1-75a4-4dd7-bcb5-051e2c4b2a18"},{"version":"CommandV1","origId":1745794912676944,"guid":"15b9af35-bfcb-4435-871a-7a54a71766bd","subtype":"command","commandType":"auto","position":3.0,"command":"%python\n\ndef deleteTables() :\n  try:\n    tables=spark.catalog.listTables(\"Databricks\")\n  except:\n    return\n  for table in tables:\n      spark.sql(\"DROP TABLE {}.{}\".format(\"Databricks\", table.name))\n      \n# deleteTables()\n      \nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d60ad0ca-3c3d-499f-9eae-1d9989d75e70"},{"version":"CommandV1","origId":1745794912676945,"guid":"0461cf64-a949-4f6a-8954-c4442e392778","subtype":"command","commandType":"auto","position":4.0,"command":"%python\n\nspark.sql(\"CREATE DATABASE IF NOT EXISTS Databricks\")\nspark.sql(\"USE Databricks\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fdcb15bb-57c2-4aa2-9011-e8db516301df"},{"version":"CommandV1","origId":1745794912676946,"guid":"e2eac930-7ae4-4e0e-bc71-120c8a746059","subtype":"command","commandType":"auto","position":5.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS People10M\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(filePeople));\n\nspark.sql(\"uncache TABLE People10M\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"18911fd2-9f23-4e92-8191-c339466ae3c3"},{"version":"CommandV1","origId":1745794912676947,"guid":"6f5847d6-a2a2-4f61-ac85-ba8838d66a22","subtype":"command","commandType":"auto","position":6.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS SSANames\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileNames))\n\nspark.sql(\"uncache TABLE SSANames\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9a71781c-52a8-4f26-9393-68878856c79e"},{"version":"CommandV1","origId":1745794912676948,"guid":"cd6016e9-dca8-4bd4-a36d-23bb602a816e","subtype":"command","commandType":"auto","position":7.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS DatabricksBlog\nUSING json\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\"\n)\"\"\".format(fileBlog))\n\nspark.sql(\"uncache TABLE DatabricksBlog\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"79eea790-a7c8-4a68-9a74-43e6a72486c8"},{"version":"CommandV1","origId":1745794912676949,"guid":"ec07fe53-6aa4-4151-a20c-b919b04a022f","subtype":"command","commandType":"auto","position":8.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS CityData\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\"\"\".format(fileCity))\n\nspark.sql(\"uncache TABLE CityData\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"84215142-f84d-49ca-b5a7-3a307a94ae97"},{"version":"CommandV1","origId":1745794912676950,"guid":"29363eb8-d719-4bd3-9739-d93c2d5a4898","subtype":"command","commandType":"auto","position":9.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlinePlane (`tailnum` STRING, `type` STRING, `manufacturer` STRING, `issue_date` STRING, `model` STRING, `status` STRING, `aircraft_type` STRING, `engine_type` STRING, `year` STRING)\nUSING csv \nOPTIONS (\n  header \"true\",\n  delimiter \",\",\n  inferSchema \"false\",\n  path \"{}\"\n)\"\"\".format(filePlane))\n\nspark.sql(\"uncache TABLE AirlinePlane\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"100a21c5-7a32-4a1d-b095-a8de5553eca7"},{"version":"CommandV1","origId":1745794912676951,"guid":"607286f5-3191-4b8d-9134-8f888ec7799a","subtype":"command","commandType":"auto","position":10.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS AirlineFlight (`Year` INT, `Month` INT, `DayofMonth` INT, `DayOfWeek` INT, `DepTime` STRING, `CRSDepTime` INT, `ArrTime` STRING, `CRSArrTime` INT, `UniqueCarrier` STRING, `FlightNum` INT, `TailNum` STRING, `ActualElapsedTime` STRING, `CRSElapsedTime` INT, `AirTime` STRING, `ArrDelay` STRING, `DepDelay` STRING, `Origin` STRING, `Dest` STRING, `Distance` INT, `TaxiIn` INT, `TaxiOut` INT, `Cancelled` INT, `CancellationCode` STRING, `Diverted` INT, `CarrierDelay` STRING, `WeatherDelay` STRING, `NASDelay` STRING, `SecurityDelay` STRING, `LateAircraftDelay` STRING)\nUSING CSV OPTIONS (\n  header=\"true\", \n  delimiter=\",\", \n  inferSchema=\"true\", \n  path=\"{}\")\n\"\"\".format(fileSmall))\n\nspark.sql(\"uncache TABLE AirlineFlight\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ce3904ad-1272-41de-8dbd-6d951eb7f64a"},{"version":"CommandV1","origId":1745794912676952,"guid":"21362290-aa4a-4fa8-8f1c-daf3af640127","subtype":"command","commandType":"auto","position":11.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS IPGeocode (`startingIP` DECIMAL(38,0), `endingIP` DECIMAL(38,0), `countryCode2` STRING, `countryCode3` STRING, `country` STRING, `stateProvince` STRING, `city` STRING, `latitude` DOUBLE, `longitude` DOUBLE)\nUSING parquet\nOPTIONS (\n  path \"{}\"\n)\n\"\"\".format(fileGeo))\n\nspark.sql(\"uncache TABLE IPGeocode\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"31df6042-3104-4bb0-8609-4c56cb0fbae3"},{"version":"CommandV1","origId":1745794912676953,"guid":"6568d30f-6144-477c-91fa-cde611ea3fa9","subtype":"command","commandType":"auto","position":12.0,"command":"%python\n\nspark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS BikeSharingDay\nUSING csv\nOPTIONS (\n  path \"{}\",\n  inferSchema \"true\",\n  header \"true\"\n)\"\"\".format(fileBikes))\n\nspark.sql(\"uncache TABLE BikeSharingDay\")\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"570738a2-7827-4d89-a487-2feb319ed3f1"},{"version":"CommandV1","origId":1745794912676954,"guid":"1299c825-ccc1-46f9-952e-1c13bb94349a","subtype":"command","commandType":"auto","position":13.0,"command":"%python\n\ndisplayHTML(\"Created Database and Tables...\") # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4258953226069350","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"22d1f7f0-7bac-437d-8ba6-43230431258a"}],"dashboards":[],"guid":"817b2e40-d0d5-418e-ad6c-e4746da4d15b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}